<!DOCTYPE html><html lang="en"><head>
        <title>
            DA-100ZH-Analyzing-Data-with-Power-BI
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                DA-100ZH-Analyzing-Data-with-Power-BI
            </a>
            <a href="https://github.com/MicrosoftLearning/DA-100ZH-Analyzing-Data-with-Power-BI" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#实验室故事">实验室故事</a></li><li class="nav-item"><a class="nav-link" href="#任务-1保存-power-bi-desktop-文件">任务 1：保存 Power BI Desktop 文件</a></li><li class="nav-item"><a class="nav-link" href="#任务-2设置-power-bi-desktop-选项">任务 2：设置 Power BI Desktop 选项</a></li><li class="nav-item"><a class="nav-link" href="#任务-3从-sql-server-获取数据">任务 3：从 SQL Server 获取数据</a></li><li class="nav-item"><a class="nav-link" href="#任务-4预览-sql-server-查询">任务 4：预览 SQL Server 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-5从-csv-文件获取数据">任务 5：从 CSV 文件获取数据</a></li><li class="nav-item"><a class="nav-link" href="#任务-6从-csv-文件中获取其他数据">任务 6：从 CSV 文件中获取其他数据</a></li><li class="nav-item"><a class="nav-link" href="#任务-7完成">任务 7：完成</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="在-power-bi-desktop-中准备数据"><strong>在 Power BI Desktop 中准备数据</strong></h1>

<p><strong>完成本实验室预计需要 45 分钟</strong></p>

<p>在本实验室中，你将开始为 Adventure Works 公司开发 Power BI Desktop 解决方案。这涉及连接到源数据、预览数据以及使用数据预览技术来了解源数据的特征和质量。</p>

<p>在本实验室中，你将学习如何：</p>

<ul>
  <li>
    <p>打开 Power BI Desktop</p>
  </li>
  <li>
    <p>设置 Power BI Desktop 选项</p>
  </li>
  <li>
    <p>连接到源数据</p>
  </li>
  <li>
    <p>预览源数据</p>
  </li>
  <li>
    <p>使用数据预览技术更好地了解数据</p>
  </li>
</ul>

<h3 id="实验室故事"><strong>实验室故事</strong></h3>

<p>本实验室是一个实验室系列中的诸多实验室之一，设计为从数据准备到作为报表和仪表板发布的完整故事。可以按任意顺序完成这些实验室。但是，如果你打算完成多个实验室，对于前 10 个实验室，建议你按以下顺序完成：</p>

<ol>
  <li>
    <p><strong>在 Power BI Desktop 中准备数据</strong></p>
  </li>
  <li>
    <p>在 Power BI Desktop 中加载数据</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中对数据建模，第 1 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中对数据建模，第 2 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中创建 DAX 计算，第 1 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中创建 DAX 计算，第 2 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中设计报表，第 1 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中设计报表，第 2 部分</p>
  </li>
  <li>
    <p>创建 Power BI 仪表板</p>
  </li>
  <li>
    <p>创建 Power BI 分页报表</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中执行数据分析</p>
  </li>
  <li>
    <p>强制执行行级别安全性</p>
  </li>
</ol>

<h2 id="练习-1准备数据"><strong>练习 1：准备数据</strong></h2>

<p>在本练习中，你将创建 8 个 Power BI Desktop 查询。其中 6 个查询将从 SQL Server 中获取数据，另外 2 个查询将从 CSV 文件中获取数据。</p>

<h3 id="任务-1保存-power-bi-desktop-文件"><strong>任务 1：保存 Power BI Desktop 文件</strong></h3>

<p>在此任务中，你将首先保存 Power BI Desktop 文件。</p>

<ol>
  <li>要打开 Power BI Desktop，请在任务栏上单击 Microsoft Power BI Desktop 快捷方式。</li>
</ol>

 	<a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image1.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image1.png" alt="图片 2"></a>

<ol>
  <li>要关闭开始窗口，请单击窗口右上角的 <strong>“X”</strong>。</li>
</ol>

 	<a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image2.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image2.png" alt="图片 3"></a>

<ol>
  <li>
    <p>要保存文件，请单击 <strong>“文件”</strong> 功能区选项卡以打开 backstage 视图。</p>
  </li>
  <li>
    <p>选择 <strong>“保存”</strong>。</p>
  </li>
</ol>

 	<a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image3.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image3.png" alt="图片 4"></a>

<ol>
  <li>
    <p>在 <strong>“另存为”</strong> 窗口中，导航到 <strong>“D:\DA100\MySolution”</strong> 文件夹。</p>
  </li>
  <li>
    <p>在里面 <strong>“文档名”</strong> 框，输入 <strong>“Sales Analysis”</strong>。</p>
  </li>
</ol>

 	<a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image4.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image4.png" alt="图片 14"></a>

<ol>
  <li>
    <p>单击 <strong>“保存”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image5.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image5.png" alt="图片 17"></a></p>

    <p>提示：还可以通过单击左上角的 <strong>“保存”</strong> 图标来保存文件。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image6.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image6.png" alt="图片 18"></a></p>
  </li>
</ol>

<h3 id="任务-2设置-power-bi-desktop-选项"><strong>任务 2：设置 Power BI Desktop 选项</strong></h3>

<p>在此任务中，你将设置 Power BI Desktop 选项。</p>

<ol>
  <li>
    <p>在 Power BI Desktop 中，单击 <strong>“文件”</strong> 功能区选项卡以打开 backstage 视图。</p>
  </li>
  <li>
    <p>选择左侧的 <strong>“选项和设置”</strong>，然后选择 <strong>“选项”</strong>。</p>
  </li>
</ol>

 	<a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image7.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image7.png" alt="图片1"></a>

<ol>
  <li>
    <p>在 <strong>“选项”</strong> 窗口左侧的 <strong>“当前文件”</strong> 组中选择 <strong>“数据加载”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image8.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image8.png" alt="图片 5"></a></p>

    <p>通过当前文件的 <strong>“数据加载”</strong> 设置，可以设置选项来确定建模时的默认行为。</p>
  </li>
  <li>
    <p>在 <strong>“关系”</strong> 组中，取消选中已选中的两个选项。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image9.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image9.png" alt="图片 7"></a></p>

    <p>虽然在开发数据模型时启用这两个选项可能会有所帮助，但你之前禁用了它们来支持实验室体验。在 <strong>“在 Power BI Desktop 中加载数据”</strong> 实验室中创建关系时，你将了解为什么要添加每个关系。</p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image10.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image10.png" alt="图片 9"></a></p>
  </li>
  <li>
    <p>保存 Power BI Desktop 文件。</p>
  </li>
</ol>

<h3 id="任务-3从-sql-server-获取数据"><strong>任务 3：从 SQL Server 获取数据</strong></h3>

<p>在此任务中，你将基于 SQL Server 表创建查询。</p>

<ol>
  <li>
    <p>在 <strong>“主页”</strong> 功能区选项卡上的 <strong>“数据”</strong> 组中，单击 <strong>“SQL Server”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image11.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image11.png" alt="图片 19"></a></p>
  </li>
  <li>
    <p>在 <strong>“SQL Server 数据库”</strong> 窗口的 <strong>“服务器”</strong> 框中，输入 <strong>“localhost”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image12.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image12.png" alt="图片 21"></a></p>

    <p>在本实验室中，你将使用 <strong>“localhost”</strong> 连接到 SQL Server 数据库。但在创建自己的解决方案时，不建议这样做。这是因为网关数据源无法解析 <strong>localhost</strong>。</p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image13.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image13.png" alt="图片 22"></a></p>
  </li>
  <li>
    <p>在 <strong>“导航器”</strong> 窗口左侧，展开 <strong>“AdventureWorksDW2020”</strong> 数据库。</p>

    <p><strong>AdventureWorksDW2020</strong> 数据库基于 <strong>AdventureWorksDW2017</strong> 示例数据库。已对其进行修改，以支持课程实验室的学习目标。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image17.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image17.png" alt="图片 28"></a></p>
  </li>
  <li>
    <p>选择 <strong>“DimEmployee”</strong> 表，但不选中它。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image18.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image18.png" alt="图片 29"></a></p>
  </li>
  <li>
    <p>请注意右侧窗格中表数据的预览。</p>

    <p>可以通过预览数据来确定列和行示例。</p>
  </li>
  <li>
    <p>若要创建查询，请选中下面 6 个表旁边的复选框：</p>

    <ul>
      <li>
        <p>DimEmployee</p>
      </li>
      <li>
        <p>DimEmployeeSalesTerritory</p>
      </li>
      <li>
        <p>DimProduct</p>
      </li>
      <li>
        <p>DimReseller</p>
      </li>
      <li>
        <p>DimSalesTerritory</p>
      </li>
      <li>
        <p>FactResellerSales</p>
      </li>
    </ul>
  </li>
  <li>
    <p>要将转换应用于所选表的数据，请单击 <strong>“转换数据”</strong>。</p>

    <p>在本实验室中，你将不会转换数据。本实验室的目标是在 <strong>“Power Query 编辑器”</strong> 窗口探索和分析数据。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image19.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image19.png" alt="图片 30"></a></p>
  </li>
</ol>

<h3 id="任务-4预览-sql-server-查询"><strong>任务 4：预览 SQL Server 查询</strong></h3>

<p>在此任务中，你将预览 SQL Server 查询的数据。首先，你将了解数据的相关信息。你还将使用列质量、列分布和列分析工具来了解数据并评估数据质量。</p>

<ol>
  <li>
    <p>在 <strong>“Power Query 编辑器”</strong> 窗口左侧，请注意 <strong>“查询”</strong> 窗格。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image20.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image20.png" alt="图片 31"></a></p>

    <p><strong>“查询”</strong> 窗格包含一个针对每个所选表的查询。</p>
  </li>
  <li>
    <p>选择第一个查询 <strong>“DimEmployee”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image21.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image21.png" alt="图片 33"></a></p>

    <p>在 SQL Server 数据库中的 <strong>“DimEmployee”</strong> 表中，每个员工占用一行。行的子集表示销售人员，这与你将开发的模型相关。</p>
  </li>
  <li>
    <p>注意左下角状态栏的表统计信息 - 该表有 33 列和 296 行。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image22.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image22.png" alt="图片 36"></a></p>
  </li>
  <li>
    <p>在“数据预览”窗格中，水平滚动以查看所有列。</p>
  </li>
  <li>
    <p>请注意，最后五列包含<strong>表</strong>或<strong>值</strong>链接。</p>

    <p>这五个列表示与数据库中其他表之间的关系。它们可用于将表联接在一起。你将在 <strong>“在 Power BI Desktop 中加载数据”</strong> 实验室中联接表。</p>
  </li>
  <li>
    <p>要评估列质量，请在 <strong>“视图”</strong> 功能区选项卡的 <strong>“数据预览”</strong> 组中，勾选 <strong>“列质量”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image23.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image23.png" alt="图片 35"></a></p>

    <p>通过列质量功能，可以轻松确定列中的有效值、错误值或空值的百分比。</p>
  </li>
  <li>
    <p>对于 <strong>“位置”</strong> 列（倒数第六列），请注意 94% 的行为空 (NULL)。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image24.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image24.png" alt="图片 38"></a></p>
  </li>
  <li>
    <p>要评估列分布情况，请在 <strong>“视图”</strong> 功能区选项卡的 <strong>“数据预览”</strong> 组中，勾选 <strong>“列分布”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image25.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image25.png" alt="图片 40"></a></p>
  </li>
  <li>
    <p>再次查看 <strong>“位置”</strong> 列，请注意有四个非重复值和一个唯一值。</p>
  </li>
  <li>
    <p>在 <strong>“EmployeeKey”</strong> （第一）列查看列分布 - 有 296 个不同的值和 296 个唯一值。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image26.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image26.png" alt="图片 43"></a></p>

    <p>当非重复值和唯一值的计数相同时，这表示列包含唯一值。在建模时，某些表必须具有唯一的列。这些唯一的列可用于创建一对多关系，你将在 <strong>“在 Power BI Desktop 中对数据建模，第 1 部分”</strong> 实验室中进行此操作。</p>
  </li>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，选择 <strong>“DimEmployeeSalesTerritory”</strong> 查询。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image27.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image27.png" alt="图片 44"></a></p>

    <p><strong>“DimEmployeeSalesTerritory”</strong> 表中每个员工及其管理的销售区域分别占用一行。该表支持将多个区域与单个员工相关联。一些员工管理一个、两个或可能更多的区域。对数据建模时，需要定义多对多关系，你将在 <strong>“在 Power BI Desktop 中对数据建模，第 2 部分”</strong> 实验室中进行此操作。</p>
  </li>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，选择 <strong>“DimProduct”</strong> 查询。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image28.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image28.png" alt="图片 46"></a></p>

    <p><strong>“DimProduct”</strong> 表中公司已销售的每种产品各占一行。</p>
  </li>
  <li>
    <p>水平滚动以显示最后几列。</p>
  </li>
  <li>
    <p>注意 <strong>“DimProductSubcategory”</strong> 列。</p>

    <p>在 <strong>“在 Power BI Desktop 中加载数据”</strong> 实验室中向此查询添加转换时，将使用 <strong>“DimProductSubcategory”</strong> 列来联接表。</p>
  </li>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，选择 <strong>“DimReseller”</strong> 查询。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image29.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image29.png" alt="图片 49"></a></p>

    <p>在 <strong>“DimReseller”</strong> 表中，每个经销商对应一行。经销商对 Adventure Works 的产品进行销售、分销或增值。</p>
  </li>
  <li>
    <p>要查看列值，请在 <strong>“视图”</strong> 功能区选项卡的 <strong>“数据预览”</strong> 组中，勾选 <strong>“列分析”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image30.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image30.png" alt="图片 41"></a></p>
  </li>
  <li>
    <p>选择 <strong>“BusinessType”</strong> 列标题。</p>
  </li>
  <li>
    <p>注意“数据预览”窗格下面的新窗格。</p>
  </li>
  <li>
    <p>在“数据预览”窗格中查看列统计信息和值分布情况。</p>
  </li>
  <li>
    <p>请注意数据质量问题：仓库有两个标签（<strong>“Warehouse”</strong> 以及拼写错误的 <strong>“Ware House”</strong>）。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image31.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image31.png" alt="图片 51"></a></p>
  </li>
  <li>
    <p>将光标悬停在 <strong>“Ware House”</strong> 栏，请注意，有五个行包含此值。</p>

    <p>在 <strong>“在 Power BI Desktop 中加载数据”</strong> 实验室中，你将应用转换以重新标记这五行。</p>
  </li>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，选择 <strong>“DimSalesTerritory”</strong> 查询。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image32.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image32.png" alt="图片 52"></a></p>

    <p>在 <strong>“DimSalesTerritory”</strong> 表中，每个销售区域占一行，包括 <strong>“Corporate HQ”</strong> （总部）。区域分配给国家/地区，国家/地区分配给组。在 <strong>“在 Power BI Desktop 中对数据建模，第 1 部分”</strong> 实验室中，你将创建一个层次结构以支持区域、国家/地区或组级别的分析。</p>
  </li>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，选择 <strong>“FactResellerSales”</strong> 查询。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image33.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image33.png" alt="图片 54"></a></p>

    <p><strong>“FactResellerSales”</strong> 表中每个销售订单行包含一行 - 一个销售订单包含一个或多个行项。</p>
  </li>
  <li>
    <p>查看 <strong>“TotalProductCost”</strong> 列的列质量，请注意 8％ 的行为空。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image34.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image34.png" alt="图片 63"></a></p>

    <p>缺少 <strong>“TotalProductCost”</strong> 列值是数据质量问题。为解决该问题，在“在 Power BI Desktop 中加载数据”实验室中，你将通过使用产品标准成本（存储在相关的 <strong>“DimProduct”</strong> 表中）来应用转换以填充缺少的值。</p>
  </li>
</ol>

<h3 id="任务-5从-csv-文件获取数据"><strong>任务 5：从 CSV 文件获取数据</strong></h3>

<p>在此任务中，你将基于 CSV 文件创建查询。</p>

<ol>
  <li>
    <p>要添加新查询，请在 <strong>“Power Query 编辑器”</strong> 窗口的 <strong>“主页”</strong> 功能区选项卡上，在 <strong>“新查询”</strong> 组中，单击 <strong>“新源”</strong> 向下箭头，然后选择 <strong>“文本/CSV”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image35.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image35.png" alt="图片 70"></a></p>
  </li>
  <li>
    <p>在 <strong>“打开”</strong> 窗口中，导航到 <strong>“D:\DA100\Resources”</strong> 文件夹，然后选择 <strong>“ResellerSalesTargets.csv”</strong> 文件。</p>
  </li>
  <li>
    <p>单击 <strong>“打开”</strong>。</p>
  </li>
  <li>
    <p>在 <strong>“ResellerSalesTargets.csv”</strong> 窗口中，查看预览数据。</p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image36.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image36.png" alt="图片 71"></a></p>
  </li>
</ol>

<p>‎</p>

<ol>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，注意添加了 <strong>“ResellerSalesTargets”</strong> 查询。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image37.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image37.png" alt="图片 72"></a></p>

    <p>在 <strong>“ResellerSalesTargets”</strong> CSV 文件中，每年的每个销售员占一行。每行记录 12 个月度销售目标（以千为单位表示）。请注意，Adventure Works 公司的营业年度从 7 月 1 日开始。</p>
  </li>
  <li>
    <p>请注意，没有列包含空值。</p>

    <p>如果没有月度销售目标，则改为存储一个连字符。</p>
  </li>
  <li>
    <p>查看列名左侧每个列标题中的图标。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image38.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image38.png" alt="图片 74"></a></p>

    <p>这些图标代表列数据类型。 <strong>“123”</strong> 代表整数， <strong>“ABC”</strong> 代表文本。</p>

    <p>你将应用许多转换以实现仅由三列组成的不同形状的结果： <strong>“在 Power BI Desktop 中加载数据”</strong> 实验室中的 <strong>“Date”</strong>、 <strong>“EmployeeKey”</strong> 和 <strong>“TargetAmount”</strong>。</p>
  </li>
</ol>

<h3 id="任务-6从-csv-文件中获取其他数据"><strong>任务 6：从 CSV 文件中获取其他数据</strong></h3>

<p>在此任务中，你将基于其他 CSV 文件创建其他查询。</p>

<ol>
  <li>
    <p>使用上一个任务中的步骤基于 <strong>“D:\DA100\Resources\ColorFormats.csv”</strong> 文件创建查询。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image39.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image39.png" alt="图片 75"></a></p>

    <p>在 <strong>“ColorFormats”</strong> CSV 文件中，一行对应一种产品颜色。每行记录十六进制代码以格式化背景和字体颜色。在 <strong>“在 Power BI Desktop 中加载数据”</strong> 实验室中，你将此数据与 <strong>DimProduct</strong> 查询数据集成在一起。</p>
  </li>
</ol>

<h3 id="任务-7完成"><strong>任务 7：完成</strong></h3>

<p>在此任务中，你将完成实验室。</p>

<ol>
  <li>
    <p>在 <strong>“视图”</strong> 功能区选项卡上，从 <strong>“数据预览”</strong> 组中，取消选中此实验室中先前启用的三个数据预览选项：</p>

    <ul>
      <li>
        <p>列质量</p>
      </li>
      <li>
        <p>列分布</p>
      </li>
      <li>
        <p>列分析</p>
      </li>
    </ul>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image40.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image40.png" alt="图片 76"></a></p>
  </li>
  <li>
    <p>要保存 <strong>Power BI Desktop</strong> 文件，请在“Power Query 编辑器”窗口的 <strong>“文件”</strong> backstage 视图中，选择 <strong>“保存”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image41.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image41.png" alt="图片 77"></a></p>
  </li>
  <li>
    <p>当系统提示应用查询时，单击 <strong>“稍后应用”</strong>。</p>

    <p><a href="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image42.png" target="_blank"><img src="Linked_image_Files/01-prepare-data-with-power-query-in-power-bi-desktop_image42.png" alt="图片 86"></a></p>

    <p>应用查询会将其数据加载到数据模型。你尚未准备好执行该操作，因为必须先应用许多转换。</p>
  </li>
  <li>
    <p>如果你打算开始下一个实验室，请让 Power BI Desktop 保持打开状态。</p>

    <p>在 <strong>“在 Power BI Desktop 中加载数据”</strong> 实验室中，你将对查询应用各种转换，然后应用查询将其加载到数据模型。</p>
  </li>
</ol>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/DA-100ZH-Analyzing-Data-with-Power-BI" target="_blank" class="ml-2">
                    MicrosoftLearning/DA-100ZH-Analyzing-Data-with-Power-BI
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D.js"></script>



</body></html>