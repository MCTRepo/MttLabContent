<!DOCTYPE html><html lang="en"><head>
        <title>
            DA-100ZH-Analyzing-Data-with-Power-BI
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                DA-100ZH-Analyzing-Data-with-Power-BI
            </a>
            <a href="https://github.com/MicrosoftLearning/DA-100ZH-Analyzing-Data-with-Power-BI" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#实验室故事">实验室故事</a></li><li class="nav-item"><a class="nav-link" href="#任务-1入门">任务 1：入门</a></li><li class="nav-item"><a class="nav-link active" href="#任务-2配置-salesperson-查询">任务 2：配置 Salesperson 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-3配置-salespersonregion-查询">任务 3：配置 SalespersonRegion 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-4配置-product-查询">任务 4：配置 Product 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-5配置-reseller-查询">任务 5：配置 Reseller 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-6配置-region-查询">任务 6：配置 Region 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-7配置-sales-查询">任务 7：配置 Sales 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-8配置-targets-查询">任务 8：配置 Targets 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-9配置-colorformats-查询">任务 9：配置 ColorFormats 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-10更新-product-查询">任务 10：更新 Product 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-11更新-colorformats-查询">任务 11：更新 ColorFormats 查询</a></li><li class="nav-item"><a class="nav-link" href="#任务-12完成">任务 12：完成</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="在-power-bi-desktop-中加载数据"><strong>在 Power BI Desktop 中加载数据</strong></h1>

<p><strong>完成本实验室预计需要 45 分钟</strong></p>

<p>在本实验室中，你将开始对上一个实验室中创建的每个查询应用转换。然后，你将应用查询，以将每个查询作为表加载到数据模型。</p>

<p>在本实验室中，你将学习如何：</p>

<ul>
  <li>
    <p>应用各种转换</p>
  </li>
  <li>
    <p>应用查询以将其加载到数据模型</p>
  </li>
</ul>

<h3 id="实验室故事"><strong>实验室故事</strong></h3>

<p>本实验室是一个实验室系列中的诸多实验室之一，设计为从数据准备到作为报表和仪表板发布的完整故事。可以按任意顺序完成这些实验室。但是，如果你打算完成多个实验室，对于前 10 个实验室，建议你按以下顺序完成：</p>

<ol>
  <li>
    <p>在 Power BI Desktop 中准备数据</p>
  </li>
  <li>
    <p><strong>在 Power BI Desktop 中加载数据</strong></p>
  </li>
  <li>
    <p>在 Power BI Desktop 中对数据建模，第 1 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中对数据建模，第 2 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中创建 DAX 计算，第 1 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中创建 DAX 计算，第 2 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中设计报表，第 1 部分</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中设计报表，第 2 部分</p>
  </li>
  <li>
    <p>创建 Power BI 仪表板</p>
  </li>
  <li>
    <p>创建 Power BI 分页报表</p>
  </li>
  <li>
    <p>在 Power BI Desktop 中执行数据分析</p>
  </li>
  <li>
    <p>强制执行行级别安全性</p>
  </li>
</ol>

<h2 id="练习-1加载数据"><strong>练习 1：加载数据</strong></h2>

<p>在本练习中，你将对上一个实验室中创建的每个查询应用转换。</p>

<h3 id="任务-1入门"><strong>任务 1：入门</strong></h3>

<p>在此任务中，你将设置实验室环境。</p>

<p><em>重要说明：如果你从上一个实验室继续操作（并且已成功完成该实验室），则无需完成此任务；而是继续执行下一个任务。</em></p>

<ol>
  <li>
    <p>要打开 Power BI Desktop，请在任务栏上单击 Microsoft Power BI Desktop 快捷方式。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image1.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image1.png" alt="图片 8"></a></p>
  </li>
  <li>
    <p>要关闭开始窗口，请单击窗口左上角的 <strong>“X”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image2.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image2.png" alt="图片 7"></a></p>
  </li>
  <li>
    <p>要打开入门 Power BI Desktop 文件，请单击 <strong>“文件”</strong> 功能区选项卡以打开 Backstage 视图。</p>
  </li>
  <li>
    <p>选择 <strong>“打开报表”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image3.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image3.png" alt="图片 10"></a></p>
  </li>
  <li>
    <p>单击 <strong>“浏览报表”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image4.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image4.png" alt="图片 11"></a></p>
  </li>
  <li>
    <p>在“打开”窗口，导航到 <strong>“D:\DA100\Labs\02-load-data-with-power-query-in-power-bi-desktop\Starter”</strong> 文件夹。</p>
  </li>
  <li>
    <p>选择 <strong>“Sales Analysis”</strong> 文件。</p>
  </li>
  <li>
    <p>单击 <strong>“打开”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image5.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image5.png" alt="图片 12"></a></p>
  </li>
  <li>
    <p>关闭可能打开的所有信息窗口。</p>
  </li>
  <li>
    <p>请注意功能区下方的黄色警告消息。</p>

    <p><em>该消息会提醒你尚未应用查询来加载为模型表。你稍后将在本实验室中应用查询。</em></p>
  </li>
  <li>
    <p>要关闭警告消息，请在黄色警告消息的左侧单击 <strong>“X”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image6.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image6.png" alt="图片 13"></a></p>
  </li>
  <li>
    <p>要创建该文件的副本，请单击 <strong>“文件”</strong> 功能区选项卡以打开 backstage 视图。</p>
  </li>
  <li>
    <p>选择 <strong>“另存为”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image7.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image7.png" alt="图片 18"></a></p>
  </li>
  <li>
    <p>如果提示应用更改，请单击 <strong>“稍后应用”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image8.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image8.png" alt="图片 22"></a></p>
  </li>
  <li>
    <p>在 <strong>“另存为”</strong> 窗口中，导航到 <strong>“D:\DA100\MySolution”</strong> 文件夹。</p>
  </li>
  <li>
    <p>单击 <strong>“保存”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image9.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image9.png" alt="图片 15"></a></p>
  </li>
  <li>
    <p>若要打开 <strong>“Power Query 编辑器”</strong> 窗口，请在“主页”功能区选项卡上的 <strong>“查询”</strong> 组内，单击 <strong>“转换数据”</strong> 图标。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image10.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image10.png" alt="图片 20"></a></p>
  </li>
</ol>

<h3 id="任务-2配置-salesperson-查询"><strong>任务 2：配置 Salesperson 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“Salesperson”</strong> 查询。</p>

<ol>
  <li>
    <p>在 <strong>“Power Query 编辑器”</strong> 窗口的 <strong>“查询”</strong> 窗格中，选择 <strong>“DimEmployee”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image11.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image11.png" alt="图片 1"></a></p>
  </li>
  <li>
    <p>若要重命名查询，请在 <strong>“查询设置”</strong> 窗格（位于右侧）的 <strong>“名称”</strong> 框中将文本替换为 <strong>“Salesperson”</strong>，然后按 <strong>Enter</strong>。</p>

    <p><em>查询名称将确定模型表名称。建议定义简明且容易记住的名称。</em></p>
  </li>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，确认查询名称已更新。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image12.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image12.png" alt="图片 87"></a></p>

    <p><em>现在，你将筛选查询行以仅检索职位是销售员的员工。</em></p>
  </li>
  <li>
    <p>要找到特定的列，请在 <strong>“主页”</strong> 功能区选项卡上的 <strong>“管理列”</strong> 组中，单击 <strong>“选择列”</strong> 向下箭头，然后选择 <strong>“转到列”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image13.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image13.png" alt="图片 88"></a></p>

    <p><em>提示：当查询包含许多列时，此方法很有用。如果列数不多，只需水平滚动即可找到感兴趣的列。</em></p>
  </li>
  <li>
    <p>在 <strong>“转到列”</strong> 窗口中，要按列名对列表进行排序，请单击 <strong>AZ</strong> 排序按钮，然后选择 <strong>“名称”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image14.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image14.png" alt="图片 94"></a></p>
  </li>
  <li>
    <p>选择 <strong>“SalesPersonFlag”</strong> 列，然后单击 <strong>“确定”</strong>。</p>
  </li>
  <li>
    <p>要筛选查询，请在 <strong>“SalesPersonFlag”</strong> 列标题中单击向下箭头，然后取消选中 <strong>“False”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image15.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image15.png" alt="图片 95"></a></p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image16.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image16.png" alt="图片 96"></a></p>
  </li>
  <li>
    <p>在 <strong>“查询设置”</strong> 窗格中的 <strong>“应用的步骤”</strong> 列表中，请注意添加了 <strong>“筛选的行”</strong> 步骤。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image17.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image17.png" alt="图片 98"></a></p>

    <p><em>你创建的每个转换都会生成其他步骤逻辑。可以编辑或删除步骤。在查询转换阶段，还可以选择一个步骤来预览查询结果。</em></p>
  </li>
  <li>
    <p>要删除列，在 <strong>“主页”</strong> 功能区选项卡中的 <strong>“管理列”</strong> 组中，单击 <strong>“选择列”</strong> 图标。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image18.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image18.png" alt="图片 99"></a></p>
  </li>
  <li>
    <p>在 <strong>“选择列”</strong> 窗口中，要取消选中所有列，请取消选中 <strong>“(选择所有列)”</strong> 项。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image19.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image19.png" alt="图片 102"></a></p>
  </li>
  <li>
    <p>要包括列，请选中以下六列：</p>

    <ul>
      <li>
        <p>EmployeeKey</p>
      </li>
      <li>
        <p>EmployeeNationalIDAlternateKey</p>
      </li>
      <li>
        <p>FirstName</p>
      </li>
      <li>
        <p>LastName</p>
      </li>
      <li>
        <p>Title</p>
      </li>
      <li>
        <p>EmailAddress</p>
      </li>
    </ul>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image20.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image20.png" alt="图片 104"></a></p>
  </li>
  <li>
    <p>在 <strong>“应用的步骤”</strong> 列表中，请注意添加了另一个查询步骤。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image21.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image21.png" alt="图片 112"></a></p>
  </li>
  <li>
    <p>要创建单个名称列，请首先选择 <strong>“FirstName”</strong> 列标题。</p>
  </li>
  <li>
    <p>按下 <strong>Ctrl</strong> 键的同时，选择 <strong>“LastName”</strong> 列。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image22.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image22.png" alt="图片 116"></a></p>
  </li>
  <li>
    <p>右键单击任一所选列标题，然后在上下文菜单中选择 <strong>“合并列”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image23.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image23.png" alt="图片 117"></a></p>

    <p><em>可以通过以下方式应用许多常见的转换：右键单击列标题，然后从上下文菜单中进行选择。但是请注意，功能区中还有更多转换可用。</em></p>
  </li>
  <li>
    <p>在 <strong>“合并列”</strong> 窗口中的 <strong>“分隔符”</strong> 下拉列表中，选择 <strong>“空格”</strong>。</p>
  </li>
  <li>
    <p>在 <strong>“新列名”</strong> 框中，将文本替换为 <strong>“Salesperson”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image24.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image24.png" alt="图片 119"></a></p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image25.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image25.png" alt="图片 5636"></a></p>
  </li>
  <li>
    <p>若要重命名 <strong>“EmployeeNationalIDAlternateKey”</strong> 列，双击 <strong>“EmployeeNationalIDAlternateKey”</strong> 列标题。</p>
  </li>
  <li>
    <p>将文本替换为 <strong>“EmployeeID”</strong>，然后按 <strong>Enter</strong>。</p>

    <p><em>重要说明：当收到指示对列进行重命名时，请务必完全按照指示对其进行重命名。</em></p>
  </li>
  <li>
    <p>使用前面的步骤将 <strong>“EmailAddress”</strong> 列重命名为 <strong>“UPN”</strong>。</p>

    <p><em>UPN 是用户主体名称的缩写。在 <strong>“在 Power BI Desktop 中对数据建模，第 2 部分”</strong> 实验室中配置行级别安全性时，将使用此列中的值。</em></p>
  </li>
  <li>
    <p>在状态栏的左下角，验证查询是否具有 5 列和 18 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image26.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image26.png" alt="图片 5638"></a></p>

    <p><em>重要说明：如果查询未生成正确的结果，请不要继续，否则无法完成后面的实验室，这一点很重要。如果查询的列或行不匹配，请参考此任务中的步骤解决所有问题。</em></p>
  </li>
</ol>

<h3 id="任务-3配置-salespersonregion-查询"><strong>任务 3：配置 SalespersonRegion 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“SalespersonRegion”</strong> 查询。</p>

<ol>
  <li>
    <p>在 <strong>“查询”</strong> 窗格中，选择 <strong>“DimEmployeeSalesTerritory”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image27.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image27.png" alt="图片 5639"></a></p>
  </li>
  <li>
    <p>在 <strong>“查询设置”</strong> 窗格中，将查询重命名为 <strong>“SalespersonRegion”</strong>。</p>
  </li>
  <li>
    <p>要删除最后两列，请先选择 <strong>“DimEmployee”</strong> 列标题。</p>
  </li>
  <li>
    <p>在按下 <strong>Ctrl</strong> 键的同时，选择 <strong>“DimSalesTerritory”</strong> 列标题。</p>
  </li>
  <li>
    <p>右键单击任一选择列标题，然后在上下文菜单中选择 <strong>“删除列”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image28.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image28.png" alt="图片 5640"></a></p>
  </li>
  <li>
    <p>在状态栏中，验证查询是否具有 2 列和 39 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image29.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image29.png" alt="图片 5641"></a></p>
  </li>
</ol>

<h3 id="任务-4配置-product-查询"><strong>任务 4：配置 Product 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“Product”</strong> 查询。</p>

<p><em>重要说明：由于已提供了详细说明，因此，实验室步骤现将提供更简洁的说明。如果需要详细说明，可以参考前面任务的步骤。</em></p>

<ol>
  <li>
    <p>选择 <strong>“DimProduct”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image30.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image30.png" alt="图片 5643"></a></p>
  </li>
  <li>
    <p>将该查询重命名为 <strong>“Product”</strong>。</p>
  </li>
  <li>
    <p>找到 <strong>“FinishedGoodsFlag”</strong> 列，然后筛选该列以检索制成品的产品（即 TRUE）。</p>
  </li>
  <li>
    <p>删除所有列，以下列除外：</p>

    <ul>
      <li>
        <p>ProductKey</p>
      </li>
      <li>
        <p>EnglishProductName</p>
      </li>
      <li>
        <p>StandardCost</p>
      </li>
      <li>
        <p>Color</p>
      </li>
      <li>
        <p>DimProductSubcategory</p>
      </li>
    </ul>
  </li>
  <li>
    <p>请注意 <strong>“DimProductSubcategory”</strong> 列代表相关表（它包含 <strong>“值”</strong> 链接）。</p>
  </li>
  <li>
    <p>在 <strong>“DimProductSubcategory”</strong> 列标题中，在列名称右侧，单击展开按钮。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image31.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image31.png" alt="图片 5644"></a></p>
  </li>
  <li>
    <p>要取消选中所有列，请取消选中 <strong>“(选择所有列)”</strong> 项。</p>
  </li>
  <li>
    <p>选中 <strong>“EnglishProductSubcategoryName”</strong> 和 <strong>“DimProductCategory”</strong> 列。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image32.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image32.png" alt="图片 5646"></a></p>

    <p><em>通过选择这两列，将应用转换以联接到 <strong>“DimProductSubcategory”</strong> 表，然后包含这些列。 <strong>“DimProductCategory”</strong> 列实际上是数据源中的另一个相关表。</em></p>
  </li>
  <li>
    <p>取消选中 <strong>“使用原始列名作为前缀”</strong> 复选框。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image33.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image33.png" alt="图片 5647"></a></p>

    <p><em>查询列名必须始终是唯一的。选中后，此复选框将为每个列添加扩展列名作为前缀（在本例中为 <strong>“DimProductSubcategory”</strong>）。因为已知所选列名不会与 <strong>“Product”</strong> 查询中的列名冲突，可以取消选择此选项。</em></p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image34.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image34.png" alt="图片 5648"></a></p>
  </li>
  <li>
    <p>请注意，转换导致添加了两列，并且 <strong>“DimProductSubcategory”</strong> 列已被删除。</p>
  </li>
  <li>
    <p>展开 <strong>“DimProductCategory”</strong> 列，然后仅引入 <strong>“EnglishProductCategoryName”</strong> 列。</p>
  </li>
  <li>
    <p>重命名以下四列：</p>

    <ul>
      <li>
        <p>将 <strong>“EnglishProductName”</strong> 重命名为 <strong>“Product”</strong></p>
      </li>
      <li>
        <p>将 <strong>“StandardCost”</strong> 重命名为 <strong>“Standard Cost”</strong> （含空格）</p>
      </li>
      <li>
        <p>将 <strong>“EnglishProductSubcategoryName”</strong> 重命名为 <strong>“Subcategory”</strong></p>
      </li>
      <li>
        <p>将 <strong>“EnglishProductCategoryName”</strong> 重命名为 <strong>“Category”</strong></p>
      </li>
    </ul>
  </li>
  <li>
    <p>在状态栏中，验证查询是否具有 6 列和 397 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image35.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image35.png" alt="图片 5651"></a></p>
  </li>
</ol>

<h3 id="任务-5配置-reseller-查询"><strong>任务 5：配置 Reseller 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“Reseller”</strong> 查询。</p>

<ol>
  <li>
    <p>选择 <strong>“DimReseller”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image36.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image36.png" alt="图片 5653"></a></p>
  </li>
  <li>
    <p>将查询重命名为 <strong>“Reseller”</strong>。</p>
  </li>
  <li>
    <p>删除所有列，以下列除外：</p>

    <ul>
      <li>
        <p>ResellerKey</p>
      </li>
      <li>
        <p>BusinessType</p>
      </li>
      <li>
        <p>ResellerName</p>
      </li>
      <li>
        <p>DimGeography</p>
      </li>
    </ul>
  </li>
  <li>
    <p>展开 <strong>“DimGeography”</strong> 列，以便仅包括以下三列：</p>

    <ul>
      <li>
        <p>City</p>
      </li>
      <li>
        <p>StateProvinceName</p>
      </li>
      <li>
        <p>EnglishCountryRegionName</p>
      </li>
    </ul>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image37.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image37.png" alt="图片 5656"></a></p>
  </li>
  <li>
    <p>在 <strong>“Business Type”</strong> 列标题中，单击向下箭头，然后查看各个列的值，并注意 warehouse 是否存在拼写错误。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image38.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image38.png" alt="图片 2"></a></p>
  </li>
</ol>

<p>‎</p>

<ol>
  <li>
    <p>右键单击 <strong>“Business Type”</strong> 列标题，然后选择 <strong>“替换值”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image39.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image39.png" alt="图片 4"></a></p>
  </li>
  <li>
    <p>在 <strong>“替换值”</strong> 窗口，配置以下值：</p>

    <ul>
      <li>
        <p>在 <strong>“要查找的值”</strong> 框中，输入 <strong>“Ware House”</strong></p>
      </li>
      <li>
        <p>在 <strong>“替换对象”</strong> 框，输入 <strong>“Warehouse”</strong></p>
      </li>
    </ul>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image40.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image40.png" alt="图片 5"></a></p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image41.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image41.png" alt="图片 6"></a></p>
  </li>
  <li>
    <p>重命名以下四列：</p>

    <ul>
      <li>
        <p>将 <strong>“BusinessType”</strong> 重命名为 <strong>“Business Type”</strong> （含空格）</p>
      </li>
      <li>
        <p>将 <strong>“ResellerName”</strong> 重命名为 <strong>“Reseller”</strong></p>
      </li>
      <li>
        <p>将 <strong>“StateProvinceName”</strong> 重命名为 <strong>“State-Province”</strong></p>
      </li>
      <li>
        <p>将 <strong>“EnglishCountryRegionName”</strong> 重命名为 <strong>“Country-Region”</strong></p>
      </li>
    </ul>
  </li>
  <li>
    <p>在状态栏中，确认查询具有 6 列和 701 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image42.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image42.png" alt="图片 5657"></a></p>
  </li>
</ol>

<h3 id="任务-6配置-region-查询"><strong>任务 6：配置 Region 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“Region”</strong> 查询。</p>

<ol>
  <li>
    <p>选择 <strong>“DimSalesTerritory”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image43.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image43.png" alt="图片 5659"></a></p>
  </li>
  <li>
    <p>将查询重命名为 <strong>“Region”</strong>。</p>
  </li>
  <li>
    <p>向 <strong>“SalesTerritoryAlternateKey”</strong> 列应用筛选器以删除值 0（零）。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image44.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image44.png" alt="图片 5660"></a></p>
  </li>
  <li>
    <p>删除所有列，以下列除外：</p>

    <ul>
      <li>
        <p>SalesTerritoryKey</p>
      </li>
      <li>
        <p>SalesTerritoryRegion</p>
      </li>
      <li>
        <p>SalesTerritoryCountry</p>
      </li>
      <li>
        <p>SalesTerritoryGroup</p>
      </li>
    </ul>
  </li>
  <li>
    <p>重命名以下三列：</p>

    <ul>
      <li>
        <p>将 <strong>“SalesTerritoryRegion”</strong> 重命名为 <strong>“Region”</strong></p>
      </li>
      <li>
        <p>将 <strong>“SalesTerritoryCountry”</strong> 重命名为 <strong>“Country”</strong></p>
      </li>
      <li>
        <p>将 <strong>“SalesTerritoryGroup”</strong> 重命名为 <strong>“Group”</strong></p>
      </li>
    </ul>
  </li>
  <li>
    <p>在状态栏中，验证查询是否具有 4 列和 10 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image45.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image45.png" alt="图片 5661"></a></p>
  </li>
</ol>

<h3 id="任务-7配置-sales-查询"><strong>任务 7：配置 Sales 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“Sales”</strong> 查询。</p>

<ol>
  <li>
    <p>选择 <strong>“FactResellerSales”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image46.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image46.png" alt="图片 5663"></a></p>
  </li>
  <li>
    <p>将查询重命名为 <strong>“Sales”</strong>。</p>
  </li>
  <li>
    <p>删除所有列，以下列除外：</p>

    <ul>
      <li>
        <p>SalesOrderNumber</p>
      </li>
      <li>
        <p>OrderDate</p>
      </li>
      <li>
        <p>ProductKey</p>
      </li>
      <li>
        <p>ResellerKey</p>
      </li>
      <li>
        <p>EmployeeKey</p>
      </li>
      <li>
        <p>SalesTerritoryKey</p>
      </li>
      <li>
        <p>OrderQuantity</p>
      </li>
      <li>
        <p>UnitPrice</p>
      </li>
      <li>
        <p>TotalProductCost</p>
      </li>
      <li>
        <p>SalesAmount</p>
      </li>
      <li>
        <p>DimProduct</p>
      </li>
    </ul>

    <p><em>回想一下，在 <strong>“在 Power BI Desktop 中准备数据”</strong> 实验室中，有一小部分 <strong>“FactResellerSales”</strong> 行缺少 <strong>“TotalProductCost”</strong> 值。为了修复缺少的值，已将 <strong>“DimProduct”</strong> 列包含在内，用于检索产品标准成本。</em></p>
  </li>
  <li>
    <p>展开 <strong>“DimProduct”</strong> 列，取消选中所有列，然后仅包括 <strong>“StandardCost”</strong> 列。</p>
  </li>
  <li>
    <p>要创建自定义列，请在 <strong>“添加列”</strong> 功能区选项卡上的 <strong>“常规”</strong> 组中，单击 <strong>“自定义列”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image47.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image47.png" alt="图片 5664"></a></p>
  </li>
  <li>
    <p>在 <strong>“自定义列”</strong> 窗口的 <strong>“新列名”</strong> 框中，将文本替换为 <strong>“Cost”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image48.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image48.png" alt="图片 5665"></a></p>
  </li>
  <li>
    <p>在 <strong>“自定义列公式”</strong> 框中，输入以下表达式（等号后面的文本）：</p>
  </li>
  <li>
    <p>为了方便使用，你可以从 <strong>D:\DA100\Labs\02-load-data-with-power-query-in-power-bi-desktop\Assets\Snippets.txt</strong> 文件中复制表达式。</p>

    <p><strong>Power Query</strong></p>
    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock0" class="mt-0"><code class="hljs coffeescript"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [TotalProductCost] = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> [OrderQuantity] * [StandardCost] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> [TotalProductCost]
</code></pre>
  </li>
</ol>

<p><em>此表达式用于测试 <strong>“TotalProductCost”</strong> 值是否缺失。如果缺失，则通过将 <strong>“OrderQuantity”</strong> 值乘以 <strong>“StandardCost”</strong> 值来生成一个值；否则，它使用现有的 <strong>“TotalProductCost”</strong> 值。</em></p>

<ol>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image49.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image49.png" alt="图片 5666"></a></p>
  </li>
  <li>
    <p>删除以下两列：</p>

    <ul>
      <li>
        <p>TotalProductCost</p>
      </li>
      <li>
        <p>StandardCost</p>
      </li>
    </ul>
  </li>
  <li>
    <p>重命名以下三列：</p>

    <ul>
      <li>
        <p>将 <strong>“OrderQuantity”</strong> 重命名为 <strong>“Quantity”</strong></p>
      </li>
      <li>
        <p>将 <strong>“UnitPrice”</strong> 重命名为 <strong>“Unit Price”</strong> （含空格）</p>
      </li>
      <li>
        <p>将 <strong>“SalesAmount”</strong> 重命名为 <strong>“Sales”</strong></p>
      </li>
    </ul>
  </li>
  <li>
    <p>要修改列数据类型，请在 <strong>“Quantity”</strong> 列标题（位于列名称的左侧）中单击 <strong>“1.2”</strong> 图标，然后选择 <strong>“整数”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image50.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image50.png" alt="图片 5667"></a></p>

    <p><em>必须配置正确的数据类型。当列中包含数值时，如果想进行数学计算，也必须选择正确的类型。</em></p>
  </li>
  <li>
    <p>将以下三列数据类型修改为 <strong>“定点十进制数”</strong>。</p>

    <ul>
      <li>
        <p>Unit Price</p>
      </li>
      <li>
        <p>Sales</p>
      </li>
      <li>
        <p>Cost</p>
      </li>
    </ul>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image51.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image51.png" alt="图片 5668"></a></p>

    <p><em>定点十进制数数据类型以完整精度存储值，因此需要比十进制数更多的存储空间。务必为财务值或费率（例如汇率）使用定点十进制数类型。</em></p>
  </li>
  <li>
    <p>在状态栏中，确认查询具有 10 列和超过 999 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image52.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image52.png" alt="图片 5669"></a></p>

    <p><em>每个查询最多可加载 1000 行作为预览数据。</em></p>
  </li>
</ol>

<h3 id="任务-8配置-targets-查询"><strong>任务 8：配置 Targets 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“Targets”</strong> 查询。</p>

<ol>
  <li>
    <p>选择 <strong>“ResellerSalesTargets”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image53.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image53.png" alt="图片 5672"></a></p>
  </li>
  <li>
    <p>将查询重命名为 <strong>“Targets”</strong>。</p>
  </li>
  <li>
    <p>若要逆透视 12 个月的列 (<strong>“M01”</strong>- <strong>“M12”</strong>)，请先多重选择 <strong>“Year”</strong> 和 <strong>“EmployeeID”</strong> 列标题。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image54.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image54.png" alt="图片 5673"></a></p>
  </li>
  <li>
    <p>右键单击任一选择列标题，然后在上下文菜单中选择 <strong>“逆透视其他列”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image55.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image55.png" alt="图片 5674"></a></p>
  </li>
  <li>
    <p>请注意，列名称现在显示在 <strong>“Attribute”</strong> 列中，并且值显示在 <strong>“Value”</strong> 列中。</p>
  </li>
  <li>
    <p>将筛选器应用于 <strong>“Value”</strong> 列以删除连字符 (-) 值。</p>

    <p><em>回想一下，在源 CSV 文件中使用连字符表示零 (0)。</em></p>
  </li>
  <li>
    <p>重命名以下两列：</p>

    <ul>
      <li>
        <p>将 <strong>“Attribute”</strong> 重命名为 <strong>“MonthNumber”</strong> （两个词之间没有空格，稍后会将其删除）</p>
      </li>
      <li>
        <p>将 <strong>“Value”</strong> 重命名为 <strong>“Target”</strong></p>
      </li>
    </ul>

    <p><em>现在，你将应用转换来生成一个日期列。日期将从 <strong>“Year”</strong> 和 <strong>“MonthNumber”</strong> 列中得出。你将使用 <strong>“示例中的列”</strong> 功能来创建列。</em></p>
  </li>
  <li>
    <p>要准备 <strong>“MonthNumber”</strong> 列值，请右键单击 <strong>“MonthNumber”</strong> 列标题，然后选择 <strong>“替换值”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image56.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image56.png" alt="图片 5676"></a></p>
  </li>
  <li>
    <p>在 <strong>“替换值”</strong> 窗口的 <strong>“要查找的值”</strong> 框中，输入 <strong>“M”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image57.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image57.png" alt="图片 5677"></a></p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>
  </li>
  <li>
    <p>将 <strong>“MonthNumber”</strong> 列数据类型修改为 <strong>“整数”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image58.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image58.png" alt="图片 5678"></a></p>
  </li>
  <li>
    <p>在 <strong>“添加列”</strong> 功能区选项卡上，从 <strong>“常规”</strong> 组内，单击 <strong>“示例中的列”</strong> 图标。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image59.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image59.png" alt="图片 5675"></a></p>
  </li>
  <li>
    <p>请注意，第一行对应年份 <strong>“2017”</strong> 和月份 <strong>“7”</strong>。</p>
  </li>
  <li>
    <p>在 <strong>“Column1”</strong> 列的第一个网格单元中，开始输入 <strong>“7/1/2017”</strong>，然后按 <strong>Enter</strong>。</p>

    <p><em>由于虚拟机使用美国区域设置，因此此日期实际上将显示为 2020 年 7 月 1 日。</em></p>
  </li>
  <li>
    <p>请注意，网格单元格会使用预测值进行更新。</p>

    <p><em>该功能已准确预测你正在合并 <strong>“Year”</strong> 和 <strong>“MonthNumber”</strong> 列中的值。</em></p>
  </li>
  <li>
    <p>还要注意查询网格上方显示的公式。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image60.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image60.png" alt="图片 5679"></a></p>
  </li>
  <li>
    <p>要重命名新列，请双击 <strong>“已合并”</strong> 列标题。</p>
  </li>
  <li>
    <p>将列重命名为 <strong>“TargetMonth”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image61.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image61.png" alt="图片 5680"></a></p>
  </li>
  <li>
    <p>若要添加新列，请单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image62.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image62.png" alt="图片 5681"></a></p>
  </li>
  <li>
    <p>删除以下列：</p>

    <ul>
      <li>
        <p>Year</p>
      </li>
      <li>
        <p>MonthNumber</p>
      </li>
    </ul>
  </li>
  <li>
    <p>修改以下列的数据类型：</p>

    <ul>
      <li>
        <p>将 <strong>“Target”</strong> 修改为定点十进制数</p>
      </li>
      <li>
        <p>将 <strong>“TargetMonth”</strong> 修改为日期</p>
      </li>
    </ul>
  </li>
  <li>
    <p>要将 <strong>“Target”</strong> 值乘以 1000，请选择 <strong>“Target”</strong> 列标题，然后在 <strong>“转换”</strong> 功能区选项卡上的 <strong>“数字列”</strong> 组内，单击 <strong>“标准”</strong>，然后选择 <strong>“相乘”</strong>。</p>

    <p><em>回想一下，已存储了数千个目标值。</em></p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image63.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image63.png" alt="图片 5682"></a></p>
  </li>
  <li>
    <p>在 <strong>“相乘”</strong> 窗口的 <strong>“值”</strong> 框中，输入 <strong>“1000”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image64.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image64.png" alt="图片 5683"></a></p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image65.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image65.png" alt="图片 5684"></a></p>
  </li>
  <li>
    <p>在状态栏中，确认查询具有 3 列和 809 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image66.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image66.png" alt="图片 5685"></a></p>
  </li>
</ol>

<h3 id="任务-9配置-colorformats-查询"><strong>任务 9：配置 ColorFormats 查询</strong></h3>

<p>在此任务中，你将配置 <strong>“ColorFormats”</strong> 查询。</p>

<ol>
  <li>
    <p>选择 <strong>“ColorFormats”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image67.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image67.png" alt="图片 5687"></a></p>
  </li>
  <li>
    <p>请注意，第一行包含列名。</p>
  </li>
  <li>
    <p>在 <strong>“主页”</strong> 功能区选项卡中，单击 <strong>“转换”</strong> 组内的 <strong>“将第一行用作标题”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image68.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image68.png" alt="图片 5688"></a></p>
  </li>
  <li>
    <p>在状态栏中，确认查询具有 3 列和 10 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image69.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image69.png" alt="图片 5689"></a></p>
  </li>
</ol>

<h3 id="任务-10更新-product-查询"><strong>任务 10：更新 Product 查询</strong></h3>

<p>在此任务中，你将通过合并 <strong>“ColorFormats”</strong> 查询来更新 <strong>“Product”</strong> 查询。</p>

<ol>
  <li>
    <p>选择 <strong>“Product”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image70.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image70.png" alt="图片 5690"></a></p>
  </li>
  <li>
    <p>要合并 <strong>“ColorFormats”</strong> 查询，请在 <strong>“主页”</strong> 功能区选项卡上的 <strong>“组合”</strong> 组内，单击 <strong>“合并查询”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image71.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image71.png" alt="图片 5654"></a></p>

    <p><em>合并查询能够实现集成数据，在本例中，这些数据来自不同的数据源（SQL Server 和 CSV 文件）。</em></p>
  </li>
  <li>
    <p>在 <strong>“合并”</strong> 窗口的 <strong>“Product”</strong> 查询网格中，选择 <strong>“Color”</strong> 列标题。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image72.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image72.png" alt="图片 5655"></a></p>
  </li>
  <li>
    <p>在 <strong>“Product”</strong> 查询网格下方的下拉列表中，选择 <strong>“ColorFormats”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image73.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image73.png" alt="图片 21"></a></p>
  </li>
  <li>
    <p>在 <strong>“ColorFormats”</strong> 查询网格中，选择 <strong>“Color”</strong> 列标题。</p>
  </li>
  <li>
    <p>当 <strong>“私有级别”</strong> 窗口打开时，对于两个数据源中的每一个，在相应的下拉列表中，选择 <strong>“组织”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image74.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image74.png" alt="图片 5691"></a></p>

    <p><em>可以为数据源配置隐私级别来确定数据是否可以在源之间共享。将每个数据源设置为 <strong>“组织”</strong> 允许它们共享数据（如有必要）。请注意，私有数据源永远不能与其他数据源共享。这并不意味着不能共享专用数据，这只是表示 Power Query 引擎无法在源之间共享数据。</em></p>
  </li>
  <li>
    <p>单击 <strong>“保存”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image75.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image75.png" alt="图片 5692"></a></p>
  </li>
  <li>
    <p>在 <strong>“合并”</strong> 窗口中，使用默认的联接类型 - 保持左外选择，然后单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image76.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image76.png" alt="图片 5693"></a></p>
  </li>
  <li>
    <p>展开 <strong>“ColorFormats”</strong> 列以包括以下两列：</p>

    <ul>
      <li>
        <p>Background Color Format</p>
      </li>
      <li>
        <p>Font Color Format</p>
      </li>
    </ul>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image77.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image77.png" alt="图片 5694"></a></p>
  </li>
  <li>
    <p>在状态栏中，确认查询现在具有 8 列和 397 行。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image78.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image78.png" alt="图片 5695"></a></p>
  </li>
</ol>

<h3 id="任务-11更新-colorformats-查询"><strong>任务 11：更新 ColorFormats 查询</strong></h3>

<p>在此任务中，你将更新 <strong>“ColorFormats”</strong> 以禁用其负载。</p>

<ol>
  <li>
    <p>选择 <strong>“ColorFormats”</strong> 查询。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image79.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image79.png" alt="图片 321"></a></p>
  </li>
  <li>
    <p>在 <strong>“查询设置”</strong> 窗格中，单击 <strong>“所有属性”</strong> 链接。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image80.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image80.png" alt="图片 322"></a></p>
  </li>
  <li>
    <p>在 <strong>“查询属性”</strong> 窗口中，取消选中 <strong>“启用加载到报表”</strong> 复选框。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image81.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image81.png" alt="图片 323"></a></p>

    <p>禁用加载意味着它将不会作为表加载到数据模型。这样做是因为查询已经与已启用的 <strong>“Product”</strong> 查询合并，以便加载到数据模型。</p>
  </li>
  <li>
    <p>单击 <strong>“确定”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image82.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image82.png" alt="图片 324"></a></p>
  </li>
</ol>

<h3 id="任务-12完成"><strong>任务 12：完成</strong></h3>

<p>在此任务中，你将完成实验室。</p>

<ol>
  <li>
    <p>验证你是否有 8 个按照如下命名的查询：</p>

    <ul>
      <li>
        <p>Salesperson</p>
      </li>
      <li>
        <p>SalespersonRegion</p>
      </li>
      <li>
        <p>Product</p>
      </li>
      <li>
        <p>Reseller</p>
      </li>
      <li>
        <p>Region</p>
      </li>
      <li>
        <p>Sales</p>
      </li>
      <li>
        <p>Targets</p>
      </li>
      <li>
        <p>ColorFormats（不会加载到数据模型中）</p>
      </li>
    </ul>
  </li>
  <li>
    <p>要加载数据模型，请在 <strong>“文件”</strong> backstage 视图，选择 <strong>“关闭并应用”</strong>。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image83.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image83.png" alt="图片 326"></a></p>

    <p><em>所有已启用加载的查询现已加载到数据模型。</em></p>
  </li>
  <li>
    <p>在 <strong>“字段”</strong> 窗格（位于右侧）中，请注意已加载到数据模型的七个表。</p>

    <p><a href="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image84.png" target="_blank"><img src="Linked_image_Files/02-load-data-with-power-query-in-power-bi-desktop_image84.png" alt="图片 3"></a></p>
  </li>
  <li>
    <p>保存 Power BI Desktop 文件。</p>
  </li>
  <li>
    <p>如果你打算开始下一个实验室，请让 Power BI Desktop 保持打开状态。</p>

    <p><em>在 <strong>“在 Power BI Desktop 中对数据建模，第 1 部分”</strong> 实验室中，你将配置数据模型表和关系。</em></p>
  </li>
</ol>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/DA-100ZH-Analyzing-Data-with-Power-BI" target="_blank" class="ml-2">
                    MicrosoftLearning/DA-100ZH-Analyzing-Data-with-Power-BI
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D.js"></script>



</body></html>