<!DOCTYPE html><html lang="en"><head>
        <title>
            PL-200-Power-Platform-Functional-Consultant
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D052d4faec0274a5ce0802fc07e6fc2ae0bd6de9b.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                PL-200-Power-Platform-Functional-Consultant
            </a>
            <a href="https://github.com/MicrosoftLearning/PL-200-Power-Platform-Functional-Consultant" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#important-notice-effective-november-2020">Important Notice (Effective November 2020):</a></li><li class="nav-item"><a class="nav-link" href="#task-1--filter-knowledge-assessments">Task 1 – Filter Knowledge Assessments</a></li><li class="nav-item"><a class="nav-link" href="#task-2--get-current-user">Task 2 – Get Current User</a></li><li class="nav-item"><a class="nav-link" href="#task-3--save-total-points">Task 3 – Save Total Points</a></li><li class="nav-item"><a class="nav-link active" href="#task-4--add-feedback-screen">Task 4 – Add Feedback Screen</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="module-4-make-canvas-apps-with-power-apps">Module 4: Make canvas apps with Power Apps</h1>

<h2 id="lab-42-practice-lab--work-with-data-and-services">Lab 4.2: Practice Lab – Work with data and services</h2>

<h3 id="important-notice-effective-november-2020">Important Notice (Effective November 2020):</h3>
<p>Common Data Service has been renamed to Microsoft Dataverse. Some terminology in Microsoft Dataverse has been updated. For example, entity is now table and field is now column.</p>

<p>While the application is in the process of updating its user experience, some references to terminology like the Common Data Service (now <strong>Dataverse</strong>), entity (now <strong>table</strong>), field (now <strong>column</strong>), and record (now <strong>row</strong>) may be out of date. Please keep this in mind as you work through the labs. We expect to have our content fully up to date very soon.</p>

<p>For more information and for a complete list of affected terms, please visit <a href="https://docs.microsoft.com/en-us/powerapps/maker/common-data-service/data-platform-intro#terminology-updates">What is Microsoft Dataverse?</a></p>

<h2 id="scenario">Scenario</h2>

<p>You are a functional consultant for your organization Contoso. You are assigned
to work on a project for your client Fabrikam. You have been assigned to
continue work on the Fabrikam Knowledge canvas app that we started creating in
the prior module. In this practice you will be working with the Microsoft
Dataverse connector to filter the list, save the results of the assessment in
Microsoft Dataverse and add support for submitting feedback using the Edit Form.</p>

<h2 id="exercise-1--filtering-data">Exercise 1 – Filtering Data</h2>

<h3 id="task-1--filter-knowledge-assessments">Task 1 – Filter Knowledge Assessments</h3>

<p>In this task, you will filter the Knowledge Assessment to show only Active rows
that have Start Date in the past and End Date is in the future.</p>

<ol>
  <li>
    <p>Navigate to <a href="https://make.powerapps.com">https://make.powerapps.com</a>.</p>
  </li>
  <li>
    <p>Make sure you are in your <strong>Practice</strong> environment.</p>
  </li>
  <li>
    <p>Select <strong>Solutions</strong>.</p>
  </li>
  <li>
    <p>Select <strong>Common Data Service Default Solution</strong>.</p>
  </li>
  <li>
    <p>Select the <strong>Fabrikam Assessment</strong> Canvas application.</p>
  </li>
  <li>
    <p>Click on the <strong>Edit</strong> button located on the command bar.</p>
  </li>
  <li>
    <p>Wait for the app designer to load.</p>
  </li>
  <li>
    <p>Select the <strong>Knowledge Assessment List</strong> gallery and click the <strong>Advanced</strong>
tab in the Properties pane.</p>
  </li>
  <li>
    <p>Set the <strong>Items</strong> Property to the snippet below. This snippet will filter
the Knowledge Assessment rows and the list will show only the active rows
with Start Date in the past and End Date in the future. <em>Note:</em> if you type
this instead of pasting it, you will see how the editor helps you build
expressions.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock0" class="mt-0"><code class="hljs sql">    Filter('Knowledge Assessments', (Status = 'Status (Knowledge Assessments)'.Active &amp;&amp; '<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span><span class="hljs-string"><span class="hljs-string">' &lt;= Today() &amp;&amp; '</span></span><span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span><span class="hljs-string"><span class="hljs-string">' &gt;= Today()))
</span></span></code></pre>

<ol>
  <li>
    <p>Click <strong>File</strong> and <strong>Save</strong> your changes.</p>
  </li>
  <li>
    <p>Click on the <strong>Back</strong> button.</p>
  </li>
  <li>
    <p>Do not close the app designer.</p>
  </li>
</ol>

<h3 id="task-2--get-current-user">Task 2 – Get Current User</h3>

<p>In this task, you will get the current User and save it in a global variable. We
are doing this during OnStart so that it only happens once, and the data is
available for use elsewhere in the app. We will be using this to retrieve a
filtered list of test results submitted by this user.</p>

<ol>
  <li>
    <p>In the tree view, select the <strong>App.</strong></p>
  </li>
  <li>
    <p>Select the <strong>OnStart</strong> property and set it to snippet below. This snippet
will create a global variable <strong>UserPrimaryEmail</strong> that will hold the
current user’s email.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock1" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock1" class="mt-0"><code class="hljs sql">    <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>(UserPrimaryEmail, <span class="hljs-keyword"><span class="hljs-keyword">User</span></span>().Email)
</code></pre>

<ol>
  <li>Add the snippet below to the <strong>OnStart</strong> property, after the snippet already there. This snippet will first
terminate the first function with semicolon, get the current User and save
it in a global variable name <strong>CurrentUser</strong>.</li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock2" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock2" class="mt-0"><code class="hljs sql">    ;<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>(CurrentUser, LookUp(<span class="hljs-keyword"><span class="hljs-keyword">Users</span></span>, <span class="hljs-string"><span class="hljs-string">'Primary Email'</span></span> = UserPrimaryEmail))
</code></pre>

<ol>
  <li>Add the snippet below to the <strong>OnStart</strong> property, after the snippets already there. Add the following function to work around an existing bug that does not
properly load the metadata for related properties. In the future this
workaround will not be required.</li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock3" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock3" class="mt-0"><code class="hljs sql">    ;<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>(FirstKABugWorkaround,<span class="hljs-keyword"><span class="hljs-keyword">First</span></span>(<span class="hljs-string"><span class="hljs-string">'Knowledge Test Results'</span></span>).<span class="hljs-string"><span class="hljs-string">'Knowledge Assessment'</span></span>)
</code></pre>

<ol>
  <li>
    <p>Your <strong>OnStart</strong> property should now have the above three snippets. Click <strong>File</strong> and <strong>Save</strong>.</p>
  </li>
  <li>
    <p>Select the <strong>back</strong> button to navigate back to the <strong>Fabrikam
Assessment</strong> app designer.</p>
  </li>
</ol>

<h3 id="task-3--save-total-points">Task 3 – Save Total Points</h3>

<p>In this task, you will create a Patch that will create a Knowledge Test Result
row. Using the Patch function allows us to on demand create a row with just
specific properties being passed. In this case, we will be using the sum
function to get a total of our points that are stored in our in-memory
collection based on the answers the user provided.</p>

<ol>
  <li>
    <p>Expand the <strong>Take Assessment Screen</strong>.</p>
  </li>
  <li>
    <p>Locate the button and rename it <strong>Score Button</strong>.</p>
  </li>
  <li>
    <p>While you still have the <strong>Score Button</strong> selected, select the <strong>Advanced</strong>
tab of the Properties pane. Set the <strong>OnSelect</strong> property to snippet below.
This snippet will create a new Knowledge Test Result row. <strong>Note:</strong> For long
formulas, you can expand the <strong>fx</strong> bar to format your formula in a larger
view.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock4" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock4" class="mt-0"><code class="hljs bash">    Patch(<span class="hljs-string"><span class="hljs-string">'Knowledge Test Results'</span></span>,Defaults(<span class="hljs-string"><span class="hljs-string">'Knowledge Test Results'</span></span>),{<span class="hljs-string"><span class="hljs-string">'Knowledge Assessment'</span></span>:<span class="hljs-string"><span class="hljs-string">'Knowledge Assessment List'</span></span>.Selected,Name:<span class="hljs-string"><span class="hljs-string">'Knowledge Assessment List'</span></span>.Selected.Title, <span class="hljs-string"><span class="hljs-string">'Total Points'</span></span>: Sum(UserAnswers.Points,Points)});
</code></pre>

<h3 id="task-4--add-feedback-screen">Task 4 – Add Feedback Screen</h3>

<p>In this task, you will add a new screen to the applications. This screen will
let the user submit feedback. This tasks demonstrates how to use the EditForm to
create a new row.</p>

<ol>
  <li>
    <p>Click on the ellipses button of the <strong>Take Assessment Screen</strong> and click
<strong>Duplicate Screen</strong>. We are creating a duplicate screen because we want all
our screens to look the same and we don’t want to recreate the header every
time we add a new screen.</p>
  </li>
  <li>
    <p>Rename the duplicate screen <strong>Add Feedback Screen</strong>.</p>
  </li>
  <li>
    <p>Rename the Button on the <strong>Add Feedback Screen</strong> to <strong>Submit Feedback
Button</strong>.</p>
  </li>
  <li>
    <p>Change the <strong>Text</strong> property of the <strong>Submit Feedback Button</strong> to <strong>“Submit
Feedback”</strong>.</p>
  </li>
  <li>
    <p>Click on the ellipses button of the <strong>Assessment Question List</strong> inside the
<strong>Add Feedback Screen</strong> and click <strong>Delete</strong>.</p>
  </li>
  <li>
    <p>Select the <strong>Add Feedback Screen</strong>.</p>
  </li>
  <li>
    <p>From the <strong>Insert</strong> tab, click <strong>Forms</strong> and then click <strong>Edit.</strong></p>
  </li>
  <li>
    <p>In the Property panel on the right, select <strong>Feedback</strong> for <strong>Data Source</strong>.
(If you are already on the Advanced tab, you will need to switch to the
Properties tab.)</p>
  </li>
  <li>
    <p>Go to the tree view and rename the form <strong>Feedback Form</strong>.</p>
  </li>
  <li>
    <p>Resize and reposition the <strong>Feedback Form</strong> to your liking.</p>
  </li>
  <li>
    <p>From the tree view, expand the <strong>Feedback Form</strong>.</p>
  </li>
  <li>
    <p>Select the <strong>Title</strong> column. In the <strong>Advanced</strong> pane, select <strong>unlock</strong> and
go to the <strong>Data</strong> section.</p>
  </li>
  <li>
    <p>Set the <strong>Default</strong> property to the <strong>Title</strong> of the selected <strong>Knowledge
assessment</strong>.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock5" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock5" class="mt-0"><code class="hljs bash">    <span class="hljs-string"><span class="hljs-string">'Knowledge Assessment List'</span></span>.Selected.Title
</code></pre>

<ol>
  <li>With the <strong>Title</strong> data card still selected, select the <strong>Properties</strong> tab.
    Locate the <strong>DisplayMode</strong> property and set it to <strong>View</strong>.</li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock6" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock6" class="mt-0"><code class="hljs css">   <span class="hljs-selector-tag"><span class="hljs-selector-tag">DisplayMode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.View</span></span>
</code></pre>

<ol>
  <li>
    <p>Rename the <strong>Comments_DataCard</strong> to <strong>User Comments</strong>. (You may need to
    click <strong>Unlock</strong> first.)</p>
  </li>
  <li>
    <p>Expand the <strong>User Comments</strong> data card and rename the <strong>DataCardValue</strong> to
    <strong>User Comments Text</strong>.</p>
  </li>
  <li>
    <p>Select the <strong>Submit Feedback Button</strong>.</p>
  </li>
  <li>
    <p>Replace the <strong>OnSelect</strong> property value with the snippet below. This snippet
    will submit the form, reset the form, and navigate back to the previous
    page.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock7" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock7" class="mt-0"><code class="hljs python">   SubmitForm(<span class="hljs-string"><span class="hljs-string">'Feedback Form'</span></span>);ResetForm(<span class="hljs-string"><span class="hljs-string">'Feedback Form'</span></span>);Back(ScreenTransition.<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>)
</code></pre>

<ol>
  <li>
    <p>With the <strong>Submit Feedback Button</strong> still selected, return to the
    <strong>Properties</strong> tab and select the <strong>DisplayMode</strong> property (click on the words <strong>Display mode</strong>).</p>
  </li>
  <li>
    <p>Replace the <strong>DisplayMode</strong> property value with snippet below. This snippet
    will enable the button if the comments filed has value and disable it if the
    comments field is blank.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock8" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock8" class="mt-0"><code class="hljs php">   <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(IsBlank(<span class="hljs-string"><span class="hljs-string">'User Comments Text'</span></span>), DisplayMode.Disabled, DisplayMode.Edit)
</code></pre>

<ol>
  <li>
    <p>Select the <strong>Take Assessment Screen</strong>.</p>
  </li>
  <li>
    <p>Go to the <strong>Insert</strong> tab, navigate to <strong>Icons</strong> in the top menu, and select
    <strong>Left.</strong></p>
  </li>
  <li>
    <p>Resize and place the icon on the left side of the header.</p>
  </li>
  <li>
    <p>Set the <strong>Color</strong> property of the icon to <strong>White</strong>.</p>
  </li>
  <li>
    <p>Set the <strong>OnSelect</strong> property of the icon to the snippet below. This snippet
    will navigate back to the previous page.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock9" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock9" class="mt-0"><code class="hljs">   Back()
</code></pre>

<ol>
  <li>
    <p>Select the <strong>Take Assessment Screen</strong>.</p>
  </li>
  <li>
    <p>Click <strong>Insert</strong>, navigate to <strong>Icons</strong> in the top menu, and select the
    <strong>Emoji - Smile</strong> icon.</p>
  </li>
  <li>
    <p>Place the icon in the right side of the header and next to <strong>username.</strong></p>
  </li>
  <li>
    <p>Set the <strong>Color</strong> property of the icon to <strong>White</strong>.</p>
  </li>
  <li>
    <p>Set the <strong>OnSelect</strong> property of the Emoji icon to the snippet
    below.</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock10" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock10" class="mt-0"><code class="hljs python">   NewForm(<span class="hljs-string"><span class="hljs-string">'Feedback Form'</span></span>);Navigate(<span class="hljs-string"><span class="hljs-string">'Add Feedback Screen'</span></span>, ScreenTransition.<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>)
</code></pre>

<ol>
  <li>Click <strong>File</strong> and <strong>Save</strong> to save your application.</li>
</ol>


            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/PL-200-Power-Platform-Functional-Consultant" target="_blank" class="ml-2">
                    MicrosoftLearning/PL-200-Power-Platform-Functional-Consultant
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D052d4faec0274a5ce0802fc07e6fc2ae0bd6de9b.js"></script>



</body></html>