<!DOCTYPE html><html lang="en"><head>
        <title>
            PL-100-Microsoft-Power-Platform-App-Maker
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3Df93a2316b6e929d24f0bbd7ddb49fc2f34cd2c0e.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                PL-100-Microsoft-Power-Platform-App-Maker
            </a>
            <a href="https://github.com/MicrosoftLearning/PL-100-Microsoft-Power-Platform-App-Maker" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#exercise-1-create-business-process-flow">Exercise 1: Create business process flow</a></li><li class="nav-item"><a class="nav-link" href="#exercise-2-create-business-rule">Exercise 2: Create business rule</a></li><li class="nav-item"><a class="nav-link" href="#exercise-3-test-processes">Exercise 3: Test processes</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <blockquote>
  <p>[!NOTE]
Effective November 2020:</p>
  <ul>
    <li>Common Data Service has been renamed to Microsoft Dataverse. <a href="https://aka.ms/PAuAppBlog">Learn more</a></li>
    <li>Some terminology in Microsoft Dataverse has been updated. For example, <em>entity</em> is now <em>table</em> and <em>field</em> is now <em>column</em>. <a href="https://go.microsoft.com/fwlink/?linkid=2147247">Learn more</a></li>
  </ul>

</blockquote>

<h1 id="lab-022-business-process-flows-and-business-rules">Lab 02.2: Business Process Flows and Business Rules</h1>

<p>In this lab you will enhance the data model and improve the app behavior by adding a business process flow and a business rule.</p>

<h2 id="what-you-will-learn">What you will learn</h2>

<ul>
  <li>
    <p>How to identify stages in a Business Process Flow (BPF)</p>
  </li>
  <li>
    <p>How to create and use a BPF</p>
  </li>
  <li>
    <p>How to use a business rule to implement logic</p>
  </li>
</ul>

<h2 id="high-level-lab-steps">High-level lab steps</h2>

<ul>
  <li>
    <p>Exercise 1 – Create&nbsp;BPF lifecycle of problem&nbsp;report</p>

    <ul>
      <li>
        <p>Route&nbsp;</p>
      </li>
      <li>
        <p>Fix&nbsp;</p>
      </li>
      <li>
        <p>Resolved&nbsp;</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Exercise&nbsp;2&nbsp;– Business&nbsp;rule to not allow close without resolution</p>
  </li>
</ul>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>Must have completed <strong>Lab 02.1: Data model and model-driven app</strong></li>
</ul>

<h2 id="detailed-steps">Detailed steps</h2>

<h3 id="exercise-1-create-business-process-flow">Exercise 1: Create business process flow</h3>

<p>In this exercise, you will create a business process flow for the problem report table.</p>

<h4 id="task-1-customize-table">Task 1: Customize Table</h4>

<p>In this task, you will add a lookup Column to the problem report table.</p>

<ol>
  <li>
    <p>Navigate to the <a href="https://make.powerapps.com/">Power Apps maker portal</a> page and make sure you are in the correct environment.</p>
  </li>
  <li>
    <p>Select <strong>Solutions</strong> and click to open the <strong>Company 311</strong> solution.</p>
  </li>
  <li>
    <p>Locate and click to open the <strong>Problem Report</strong> Table.</p>
  </li>
  <li>
    <p>Make sure you have the <strong>Columns</strong> tab and click <strong>+ Add Column</strong>.</p>
  </li>
  <li>
    <p>Enter <strong>Assign to</strong> for <strong>Display name</strong>, select <strong>Lookup</strong> for <strong>Data type</strong>, select <strong>User</strong> for <strong>Related table</strong>, and click <strong>Done</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image1.png" target="_blank"><img src="02-2/media/image1.png" alt="A screenshot of the assign to panel with all relevant values in each field"></a></p>

<ol>
  <li>
    <p>Click <strong>Save Table</strong>.</p>
  </li>
  <li>
    <p>Go back to the solution by clicking on the solution name.</p>
  </li>
</ol>

<p><a href="02-2/media/image2.png" target="_blank"><img src="02-2/media/image2.png" alt="A Screenshot with an arrow pointing to the solution name"></a></p>

<ol>
  <li>Click <strong>Publish all customizations</strong> and wait for the publishing to complete.</li>
</ol>

<h4 id="task-2-create-business-process-flow">Task 2: Create business process flow</h4>

<p>In this task, you will create a business process flow for the problem report Table.</p>

<ol>
  <li>
    <p>Navigate to the <a href="https://make.powerapps.com/">Power Apps maker portal</a> page and make sure you are in the correct environment.</p>
  </li>
  <li>
    <p>Select <strong>Flows</strong>.</p>
  </li>
  <li>
    <p>Select the <strong>Business process flows</strong> tab and click <strong>+ New</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image3.png" target="_blank"><img src="02-2/media/image3.png" alt="A Screenshot with an arrow pointing to the new button"></a></p>

<ol>
  <li>
    <p>Enter <strong>Problem resolution process</strong> for <strong>Flow Name</strong>, select <strong>Problem Report</strong> for <strong>Table</strong>, and click <strong>Create</strong>.</p>
  </li>
  <li>
    <p>Select the <strong>New stage</strong>, go to the <strong>Properties</strong> pane, change the <strong>Display Name</strong> to <strong>Route</strong>, and click <strong>Apply</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image4.png" target="_blank"><img src="02-2/media/image4.png" alt="A screenshot of the new stage and properties pane"></a></p>

<ol>
  <li>Expand <strong>Details</strong> of the <strong>Route</strong> stage.</li>
</ol>

<p><a href="02-2/media/image5.png" target="_blank"><img src="02-2/media/image5.png" alt="A Screenshot with an arrow pointing to the details button"></a></p>

<ol>
  <li>Select <strong>Data Step #1</strong>, go to the <strong>Properties</strong> pane, select <strong>Building</strong> for <strong>Data Field</strong>, and click <strong>Apply</strong>.</li>
</ol>

<p><a href="02-2/media/image6.png" target="_blank"><img src="02-2/media/image6.png" alt="A screenshot of the new stage with data step one selected and the properties pane open"></a></p>

<ol>
  <li>Click <strong>+ Add</strong> and select <strong>Add Data Step</strong>.</li>
</ol>

<p><a href="02-2/media/image7.png" target="_blank"><img src="02-2/media/image7.png" alt="A Screenshot with an arrow pointing to the add button and a border around add data step button"></a></p>

<ol>
  <li>
    <p>Select the <strong>+</strong> option to add the data step below the <strong>Building</strong> data step.</p>

    <p><a href="02-2/media/image27.png" target="_blank"><img src="02-2/media/image27.png" alt="A screenshot of a data step being about to be added to the process stage"></a></p>
  </li>
  <li>
    <p>Select the new data step, go to the <strong>Properties</strong> pane, select <strong>Location</strong> for <strong>Data Field</strong>, and click <strong>Apply</strong>.</p>
  </li>
  <li>
    <p>Click <strong>+ Add</strong> again and select <strong>Add Data Step</strong>.</p>
  </li>
  <li>
    <p>Select the new data step, go to the <strong>Properties</strong> pane, select <strong>Department</strong> for <strong>Data Field</strong>, and click <strong>Apply</strong>.</p>
  </li>
  <li>
    <p>The <strong>Route</strong> stage should now look like the image below.</p>
  </li>
</ol>

<p><a href="02-2/media/image8.png" target="_blank"><img src="02-2/media/image8.png" alt="A screenshot of the completed route stage with three data steps: building, location, and department"></a></p>

<ol>
  <li>
    <p>Click <strong>+ Add</strong> and select <strong>Add Stage</strong>.</p>
  </li>
  <li>
    <p>Add the new stage after the <strong>Route</strong> stage.</p>
  </li>
  <li>
    <p>Select the stage, go to the <strong>Properties</strong> pane, enter <strong>Fix</strong> for <strong>Display Name</strong>, and click <strong>Apply</strong>.</p>
  </li>
  <li>
    <p>Expand <strong>Details</strong> of the <strong>Fix</strong> stage.</p>
  </li>
  <li>
    <p>Select <strong>Data Step #1</strong> of the <strong>Fix</strong> stage.</p>
  </li>
  <li>
    <p>Go to the <strong>Properties</strong> pane, select <strong>Assign to</strong> for <strong>Data Field</strong> and click <strong>Apply</strong>.</p>
  </li>
  <li>
    <p>Click <strong>+ Add</strong> and select <strong>Add Stage</strong>.</p>
  </li>
  <li>
    <p>Add the new stage after the <strong>Fix</strong> stage.</p>
  </li>
  <li>
    <p>Select the new stage, go to the <strong>Properties</strong> pane, enter <strong>Resolve</strong> for <strong>Display Name</strong> and click <strong>Apply</strong>.</p>
  </li>
  <li>
    <p>Expand <strong>Details</strong> of the <strong>Resolve</strong> stage.</p>
  </li>
  <li>
    <p>Select <strong>Data Step #1</strong> of the <strong>Resolve</strong> stage.</p>
  </li>
  <li>
    <p>Go to the <strong>Properties</strong> pane, select <strong>Resolution</strong> for <strong>Data Field</strong> and click <strong>Apply</strong>.</p>
  </li>
  <li>
    <p>Click <strong>+ Add</strong> and select <strong>Add Data Step</strong>.</p>
  </li>
  <li>
    <p>Add the new data step below the <strong>Resolution</strong> data step.</p>
  </li>
  <li>
    <p>Select the new data step, go to the <strong>Properties</strong> pane, select <strong>Resolved on</strong> for <strong>Date Field</strong> and click <strong>Apply</strong>.</p>
  </li>
  <li>
    <p>The Business process flow should now look like the image below. Click <strong>Save</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image9.png" target="_blank"><img src="02-2/media/image9.png" alt="A Screenshot of a Business Process Designer with an arrow pointing to the save button"></a></p>

<ol>
  <li>
    <p>Click <strong>Activate</strong>.</p>
  </li>
  <li>
    <p>Click <strong>Activate</strong> again on the pop-up.</p>
  </li>
  <li>
    <p>Confirm that <strong>Status: Active</strong> on the bottom-left side of the screen.</p>

    <p><a href="02-2/media/image28.png" target="_blank"><img src="02-2/media/image28.png" alt="A screeshot of a high-level overview of a business process with the words &quot;Status: Active&quot; highlighted in the left bottom corner"></a></p>
  </li>
  <li>
    <p>Close the process editor browser window or tab.</p>
  </li>
</ol>

<h4 id="task-3-add-business-process-flow-to-solution">Task 3: Add business process flow to solution</h4>

<p>In this task, you will add the business process flow you created to the Company 311 solution.</p>

<ol>
  <li>
    <p>Navigate to the <a href="https://make.powerapps.com/">Power Apps maker portal</a> page and make sure you are in the correct environment.</p>
  </li>
  <li>
    <p>Select <strong>Solutions</strong> and click to open the <strong>Company 311</strong> solution.</p>
  </li>
  <li>
    <p>Click <strong>+ Add existing</strong> and select <strong>Process</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image10.png" target="_blank"><img src="02-2/media/image10.png" alt="A Screenshot with an arrow pointing to the drop down icon next to the add existing button and a border around the process button"></a></p>

<ol>
  <li>Search for problem, select <strong>Problem resolution process</strong>, and click <strong>Add</strong>.</li>
</ol>

<p><a href="02-2/media/image11.png" target="_blank"><img src="02-2/media/image11.png" alt="A screenshot of the add existing processes window with problem resolution process selected"></a></p>

<ol>
  <li>Click <strong>Publish all customizations</strong> and wait for the publishing to complete.</li>
</ol>

<h3 id="exercise-2-create-business-rule">Exercise 2: Create business rule</h3>

<p>In this exercise, you will create a business rule that will block completion of problems without resolution.</p>

<h4 id="task-1-create-business-rule">Task 1: Create business rule</h4>

<ol>
  <li>
    <p>Navigate to the <a href="https://make.powerapps.com/">Power Apps maker portal</a> page and make sure you are in the correct environment.</p>
  </li>
  <li>
    <p>Select <strong>Solutions</strong> and click to open the <strong>Company 311</strong> solution.</p>
  </li>
  <li>
    <p>Locate and click to open the <strong>Problem Report</strong> Table.</p>
  </li>
  <li>
    <p>Select the <strong>Business rules</strong> tab and click <strong>Add business rule</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image12.png" target="_blank"><img src="02-2/media/image12.png" alt="A screenshot of the business rules tab"></a></p>

<ol>
  <li>Make sure the <strong>Scope</strong> is set to <strong>Entity</strong> and click <strong>Show details</strong> chevron.</li>
</ol>

<p><a href="02-2/media/image13.png" target="_blank"><img src="02-2/media/image13.png" alt="A Screenshot with an arrow pointing to the drop down icon next to the text problem report: new business rule and a border around the scope set to entity on the right hand side of the page"></a></p>

<ol>
  <li>Change <strong>Business rule name</strong> to <strong>Completion rule</strong> and click <strong>Hide details</strong> chev</li>
</ol>

<p><a href="02-2/media/image29.png" target="_blank"><img src="02-2/media/image29.png" alt="A screenshot of a business rules property pane with an arrow pointing to the shevron that collapses the entire property pane"></a></p>

<ol>
  <li>
    <p>Select the <strong>Condition</strong>.</p>
  </li>
  <li>
    <p>Go to the <strong>Properties</strong> pane and change the <strong>Display name</strong> to <strong>Resolution required</strong>.</p>
  </li>
  <li>
    <p>Scroll down to <strong>Rule 1</strong>, select <strong>Status Reason</strong> for <strong>Field</strong>, select <strong>Equals</strong> for <strong>Operator</strong>, select <strong>Value</strong> for <strong>Type</strong>, select <strong>Completed</strong> for <strong>Value</strong>, and click <strong>Apply</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image14.png" target="_blank"><img src="02-2/media/image14.png" alt="A screenshot of the rules panel"></a></p>

<ol>
  <li>Click <strong>+ New</strong>.</li>
</ol>

<p><a href="02-2/media/image15.png" target="_blank"><img src="02-2/media/image15.png" alt="A Screenshot with an arrow pointing to the new button"></a></p>

<ol>
  <li>Scroll down to <strong>Rule 2</strong>, select <strong>Resolution</strong> for <strong>Field</strong>, select <strong>Does not contain data</strong> for <strong>Operator</strong>, make sure <strong>And</strong> is selected for <strong>Rule Logic</strong>, and click <strong>Apply</strong>.</li>
</ol>

<p><a href="02-2/media/image16.png" target="_blank"><img src="02-2/media/image16.png" alt="A screenshot of the rules panel if you scroll further down with the relevant text in each field"></a></p>

<ol>
  <li>Click <strong>+ Add</strong>.</li>
</ol>

<p><a href="02-2/media/image17.png" target="_blank"><img src="02-2/media/image17.png" alt="A Screenshot with an arrow pointing to the add button"></a></p>

<ol>
  <li>
    <p>Select <strong>Add show error message</strong>.</p>
  </li>
  <li>
    <p>Add the action on the <strong>true</strong> path of the condition.</p>
  </li>
</ol>

<p><a href="02-2/media/image18.png" target="_blank"><img src="02-2/media/image18.png" alt="A Screenshot with an arrow pointing to the add button on the true path of the condition"></a></p>

<ol>
  <li>Select the new action, go to the <strong>Properties</strong> pane, enter <strong>Show message</strong> for <strong>Display Name</strong>, select <strong>Status Reason</strong> for <strong>Field</strong>, enter <strong>The Problem must have a resolution before it can be closed</strong> for <strong>Message</strong>, and click <strong>Apply</strong>.</li>
</ol>

<p><a href="02-2/media/image19.png" target="_blank"><img src="02-2/media/image19.png" alt="A screenshot of the properties panel with the relevant text in the fields"></a></p>

<ol>
  <li>The business rule should now look like the image below. Click <strong>Save</strong>.</li>
</ol>

<p><a href="02-2/media/image20.png" target="_blank"><img src="02-2/media/image20.png" alt="A Screenshot with an arrow pointing to the save button"></a></p>

<ol>
  <li>Click <strong>Activate</strong>.</li>
  <li>Click <strong>Activate</strong> again on the pop-up.</li>
  <li>Confirm activation.</li>
  <li>Close the process editor browser window or tab.</li>
  <li>Click <strong>Done</strong>.</li>
</ol>

<h3 id="exercise-3-test-processes">Exercise 3: Test processes</h3>

<p>In this exercise, you will test the business process flow and the business rule you created.</p>

<h4 id="task-1-test-processes">Task 1: Test processes</h4>

<ol>
  <li>
    <p>Navigate to the <a href="https://make.powerapps.com/">Power Apps maker portal</a> page and make sure you are in the correct environment.</p>
  </li>
  <li>
    <p>Select <strong>Apps</strong> and click to open the <strong>Company 311 Admin</strong> application.</p>
  </li>
</ol>

<p><a href="02-2/media/image21.png" target="_blank"><img src="02-2/media/image21.png" alt="A Screenshot with an arrow pointing to the company 311 admin option in apps"></a></p>

<ol>
  <li>
    <p>Select <strong>Problem Reports</strong> and click <strong>+ New</strong>.</p>
  </li>
  <li>
    <p>You should see the business process flow stages. Enter <strong>Dark parking lot</strong> for <strong>Title</strong>, select <strong>London Paddington</strong> for <strong>Building</strong>, enter <strong>There are no lights at the north end of the parking lot</strong> for <strong>Details</strong>, and click <strong>Save</strong>.</p>
  </li>
</ol>

<p><a href="02-2/media/image22.png" target="_blank"><img src="02-2/media/image22.png" alt="A screenshot of the new problem report"></a></p>

<ol>
  <li>Click on the <strong>Route</strong> stage.</li>
</ol>

<p><a href="02-2/media/image23.png" target="_blank"><img src="02-2/media/image23.png" alt="A Screenshot with an arrow pointing to the route stage at the top of the page"></a></p>

<ol>
  <li>
    <p>Enter <strong>North-end</strong> for <strong>Location</strong>, select <strong>Facility Maintenance</strong> for <strong>Department</strong> and select the <strong>Next stage</strong> stage.</p>

    <blockquote>
      <p>[!NOTE]</p>

      <p>If the Next Stage option is not visible, then refresh the page.</p>
    </blockquote>

    <p><a href="02-2/media/image24.png" target="_blank"><img src="02-2/media/image24.png" alt="A screenshot of the drop down from the route stage with the relevant options selected and typed in"></a></p>
  </li>
  <li>
    <p>Select a user for <strong>Assign to</strong> and click <strong>Next stage</strong>.</p>
  </li>
  <li>
    <p>Select date and time for the <strong>Resolved on</strong> and leave the <strong>Resolution</strong> value empty.</p>
  </li>
  <li>
    <p>Scroll down to the resolution details section and select <strong>Completed</strong> for <strong>Status Reason</strong>. You should see the business rule error message.</p>
  </li>
</ol>

<p><a href="02-2/media/image25.png" target="_blank"><img src="02-2/media/image25.png" alt="A screenshot of the error message under status reason"></a></p>

<ol>
  <li>Provide <strong>Resolution</strong>. The error message should go away.</li>
</ol>

<p><a href="02-2/media/image26.png" target="_blank"><img src="02-2/media/image26.png" alt="A screenshot of the form without the error message after resolution"></a></p>

<ol>
  <li><strong>Save</strong> the Row.</li>
</ol>

<p>Click <strong>Next</strong> to advance to the next lab.</p>


            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/PL-100-Microsoft-Power-Platform-App-Maker" target="_blank" class="ml-2">
                    MicrosoftLearning/PL-100-Microsoft-Power-Platform-App-Maker
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3Df93a2316b6e929d24f0bbd7ddb49fc2f34cd2c0e.js"></script>



</body></html>