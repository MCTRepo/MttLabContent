<!DOCTYPE html><html lang="en"><head>
        <title>
            DA-100-Analyzing-Data-with-Power-BI
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                DA-100-Analyzing-Data-with-Power-BI
            </a>
            <a href="https://github.com/MicrosoftLearning/DA-100-Analyzing-Data-with-Power-BI" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#lab-story">Lab story</a></li><li class="nav-item"><a class="nav-link" href="#task-1-get-started">Task 1: Get started</a></li><li class="nav-item"><a class="nav-link" href="#task-2-enforce-row-level-security">Task 2: Enforce row-level security</a></li><li class="nav-item"><a class="nav-link" href="#task-2-finish-up">Task 2: Finish up</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="enforce-row-level-security"><strong>Enforce Row-Level Security</strong></h1>

<p><strong>The estimated time to complete the lab is 45 minutes</strong></p>

<p>In this lab you will create a many-to-many relationship between the <strong>Salesperson</strong> table and the <strong>Sales</strong> table. You will also enforce row-level security to ensure that a salesperson can only analyze sales data for their assigned region(s).</p>

<p>In this lab you learn how to:</p>

<ul>
  <li>
    <p>Configure many-to-many relationships</p>
  </li>
  <li>
    <p>Enforce row-level security</p>
  </li>
</ul>

<h3 id="lab-story"><strong>Lab story</strong></h3>

<p>This lab is one of many in a series of labs that was designed as a complete story from data preparation to publication as reports and dashboards. You can complete the labs in any order. However, if you intend to work through multiple labs, for the first 10 labs, we suggest you do them in the following order:</p>

<ol>
  <li>
    <p>Prepare Data in Power BI Desktop</p>
  </li>
  <li>
    <p>Load Data in Power BI Desktop</p>
  </li>
  <li>
    <p>Model Data in Power BI Desktop, Part 1</p>
  </li>
  <li>
    <p>Model Data in Power BI Desktop, Part 2</p>
  </li>
  <li>
    <p>Create DAX Calculations in Power BI Desktop, Part 1</p>
  </li>
  <li>
    <p>Create DAX Calculations in Power BI Desktop, Part 2</p>
  </li>
  <li>
    <p>Design a Report in Power BI Desktop, Part 1</p>
  </li>
  <li>
    <p>Design a Report in Power BI Desktop, Part 2</p>
  </li>
  <li>
    <p>Create a Power BI Dashboard</p>
  </li>
  <li>
    <p>Perform Data Analysis in Power BI Desktop</p>
  </li>
  <li>
    <p>Create a Power BI Paginated Report</p>
  </li>
  <li>
    <p><strong>Enforce Row-Level Security</strong></p>
  </li>
</ol>

<h2 id="exercise-1-enforce-row-level-security"><strong>Exercise 1: Enforce row-level security</strong></h2>

<p>In this exercise you will enforce row-level security to ensure a salesperson can only ever see sales made in their assigned region(s).</p>

<h3 id="task-1-get-started"><strong>Task 1: Get started</strong></h3>

<p>In this task you will setup the environment for the lab.</p>

<p><em>Important: If you are continuing on from the previous lab (and you completed that lab successfully), do not complete this task; instead, continue from the next task.</em></p>

<ol>
  <li>
    <p>To open the Power BI Desktop, on the taskbar, click the Microsoft Power BI Desktop shortcut.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image1.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image1.png" alt="Picture 8"></a></p>
  </li>
  <li>
    <p>To close the getting started window, at the top-left of the window, click <strong>X</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image2.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image2.png" alt="Picture 7"></a></p>
  </li>
  <li>
    <p>To open the starter Power BI Desktop file, click the <strong>File</strong> ribbon tab to open the backstage view.</p>
  </li>
  <li>
    <p>Select <strong>Open Report</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image3.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image3.png" alt="Picture 6"></a></p>
  </li>
  <li>
    <p>Click <strong>Browse Reports</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image4.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image4.png" alt="Picture 5"></a></p>
  </li>
  <li>
    <p>In the <strong>Open</strong> window, navigate to the <strong>D:\DA100\Labs\12-row-level-security\Starter</strong> folder.</p>
  </li>
  <li>
    <p>Select the <strong>Sales Analysis</strong> file.</p>
  </li>
  <li>
    <p>Click <strong>Open</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image5.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image5.png" alt="Picture 4"></a></p>
  </li>
  <li>
    <p>Close any informational windows that may open.</p>
  </li>
  <li>
    <p>To create a copy of the file, click the <strong>File</strong> ribbon tab to open the backstage view.</p>
  </li>
  <li>
    <p>Select <strong>Save As</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image6.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image6.png" alt="Picture 3"></a></p>
  </li>
  <li>
    <p>If prompted to apply changes, click <strong>Apply</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image7.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image7.png" alt="Picture 15"></a></p>
  </li>
  <li>
    <p>In the <strong>Save As</strong> window, navigate to the <strong>D:\DA100\MySolution</strong> folder.</p>
  </li>
  <li>
    <p>Click <strong>Save</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image8.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image8.png" alt="Picture 2"></a></p>
  </li>
</ol>

<h3 id="task-2-enforce-row-level-security"><strong>Task 2: Enforce row-level security</strong></h3>

<p>In this task you will enforce row-level security to ensure a salesperson can only see sales made in their assigned region(s).</p>

<ol>
  <li>
    <p>Switch to Data view.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image20.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image20.png" alt="Picture 5701"></a></p>
  </li>
  <li>
    <p>In the <strong>Fields</strong> pane, select the <strong>Salesperson (Performance)</strong> table.</p>
  </li>
  <li>
    <p>Review the data, noticing that Michael Blythe (EmployeeKey 281) has a UPN value of: <strong>michael-blythe@adventureworks.com</strong></p>

    <p><em>Recall that Michael Blythe is assigned to three sales regions: US Northeast, US Central, and US Southeast.</em></p>
  </li>
  <li>
    <p>Switch to Report view.</p>
  </li>
  <li>
    <p>On the <strong>Modeling</strong> ribbon tab, from inside the <strong>Security</strong> group, click <strong>Manage Roles</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image21.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image21.png" alt="Picture 5700"></a></p>
  </li>
  <li>
    <p>In the <strong>Manage Roles</strong> window, click <strong>Create</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image22.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image22.png" alt="Picture 5702"></a></p>
  </li>
  <li>
    <p>In the box, replace the selected text with the name of the role: <strong>Salespeople</strong>, and then press <strong>Enter</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image23.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image23.png" alt="Picture 5703"></a></p>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>To assign a filter, for the <strong>Salesperson (Performance)</strong> table, click the ellipsis (…) character, and then select **Add Filter</td>
          <td>[UPN]**.</td>
        </tr>
      </tbody>
    </table>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image24.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image24.png" alt="Picture 5704"></a></p>
  </li>
  <li>
    <p>In the <strong>Table Filter DAX Expression</strong> box, modify the expression by replacing <strong>“Value”</strong> with <strong>USERPRINCIPALNAME()</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image25.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image25.png" alt="Picture 11"></a></p>

    <p><em>USERPRINCIPALNAME() is a Data Analysis Expressions (DAX) function that returns the name of the authenticated user. It means that the <strong>Salesperson (Performance)</strong> table will filter by the User Principal Name (UPN) of the user querying the model.</em></p>
  </li>
  <li>
    <p>Click <strong>Save</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image26.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image26.png" alt="Picture 5706"></a></p>
  </li>
  <li>
    <p>To test the security role, on the <strong>Modeling</strong> ribbon tab, from inside the <strong>Security</strong> group, click <strong>View As</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image27.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image27.png" alt="Picture 5708"></a></p>
  </li>
  <li>
    <p>In the <strong>View as Roles</strong> window, check the <strong>Other User</strong> item, and then in the corresponding box, enter: <strong>michael-blythe@adventureworks.com</strong></p>
  </li>
  <li>
    <p>Check the <strong>Salespeople</strong> role.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image28.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image28.png" alt="Picture 5709"></a></p>

    <p><em>This configuration results in using the <strong>Salespeople</strong> role and impersonating the user with your Michael Blythe’s name.</em></p>
  </li>
  <li>
    <p>Click <strong>OK</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image29.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image29.png" alt="Picture 5710"></a></p>
  </li>
  <li>
    <p>Notice the yellow banner above the report page, describing the test security context.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image30.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image30.png" alt="Picture 13"></a></p>
  </li>
  <li>
    <p>In the table visual, notice that only the salesperson <strong>Michael Blythe</strong> is listed.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image31.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image31.png" alt="Picture 5713"></a></p>
  </li>
  <li>
    <p>To stop testing, at the right side of the yellow banner, click <strong>Stop Viewing</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image32.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image32.png" alt="Picture 5712"></a></p>

    <p><em>When the Power BI Desktop file is published to the Power BI service, you’ll need to complete a post-publication task to map security principals to the <strong>Salespeople</strong> role. You won’t do that in this lab.</em></p>
  </li>
  <li>
    <p>To delete the role, on the <strong>Modeling</strong> ribbon tab, from inside the <strong>Security</strong> group, click <strong>Manage Roles</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image33.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image33.png" alt="Picture 16"></a></p>
  </li>
  <li>
    <p>In the <strong>Manage Roles</strong> window, click <strong>Delete</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image34.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image34.png" alt="Picture 17"></a></p>
  </li>
  <li>
    <p>When prompted to confirm the deletion, click <strong>Yes, Delete</strong>.</p>
  </li>
  <li>
    <p>Click <strong>Save</strong>.</p>

    <p><a href="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image35.png" target="_blank"><img src="Linked_image_Files/04-configure-data-model-in-power-bi-desktop-advanced_image35.png" alt="Picture 18"></a></p>
  </li>
</ol>

<h3 id="task-2-finish-up"><strong>Task 2: Finish up</strong></h3>

<p>In this task you will complete the lab.</p>

<ol>
  <li>Save the Power BI Desktop file.</li>
</ol>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/DA-100-Analyzing-Data-with-Power-BI" target="_blank" class="ml-2">
                    MicrosoftLearning/DA-100-Analyzing-Data-with-Power-BI
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D.js"></script>



</body></html>