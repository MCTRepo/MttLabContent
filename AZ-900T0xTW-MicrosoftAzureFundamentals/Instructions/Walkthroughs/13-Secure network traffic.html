<!DOCTYPE html><html lang="en"><head>
        <title>
            AZ-900T0xTW-MicrosoftAzureFundamentals
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                AZ-900T0xTW-MicrosoftAzureFundamentals
            </a>
            <a href="https://github.com/MicrosoftLearning/AZ-900T0xTW-MicrosoftAzureFundamentals" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    </ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="13---保護網路流量-10-分鐘">13 - 保護網路流量 (10 分鐘)</h1>

<p>在這個逐步解說中，我們將設定一個網路安全性群組。</p>

<h1 id="工作-1建立虛擬機器">工作 1：建立虛擬機器</h1>

<p>在這個工作中，我們將建立一個 Windows Server 2019 資料中心虛擬機器。</p>

<ol>
  <li>
    <p>登入到 <a href="https://portal.azure.com">Azure 入口網站</a>。</p>
  </li>
  <li>
    <p>從 [<strong>所有服務</strong>] 刀鋒視窗，搜尋並選取 [<strong>虛擬機器</strong>]，然後按一下 [<strong>+ 新增、+ 建立、+ 新建</strong>] 虛擬機器。</p>
  </li>
  <li>
    <p>在 [<strong>基本</strong>] 索引標籤中，填充下列資訊 (其他內容保留預設值)：</p>

    <table>
      <thead>
        <tr>
          <th>設定</th>
          <th>值</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>訂用帳戶</td>
          <td><strong>使用提供的預設值</strong></td>
        </tr>
        <tr>
          <td>資源群組</td>
          <td><strong>建立新資源群組</strong></td>
        </tr>
        <tr>
          <td>虛擬機器名稱</td>
          <td><strong>SimpleWinVM</strong></td>
        </tr>
        <tr>
          <td>區域</td>
          <td><strong>美國東部</strong></td>
        </tr>
        <tr>
          <td>映像</td>
          <td><strong>Windows Server 2019 資料中心 Gen 2</strong></td>
        </tr>
        <tr>
          <td>大小</td>
          <td><strong>標準 D2s v3</strong></td>
        </tr>
        <tr>
          <td>管理員帳戶使用者名稱</td>
          <td><strong>azureuser</strong></td>
        </tr>
        <tr>
          <td>管理員帳戶密碼</td>
          <td><strong>Pa$$w0rd1234</strong></td>
        </tr>
        <tr>
          <td>輸入連接埠規則</td>
          <td><strong>無</strong></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>切換到 [<strong>網路</strong>] 索引標籤，並設定下列設定：</p>

    <table>
      <thead>
        <tr>
          <th>設定</th>
          <th>值</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>NIC 網路安全性群組</td>
          <td><strong>無</strong></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>切換到 [<strong>管理</strong>] 索引標籤，並在其 [<strong>監視</strong>] 區段中選取以下設定：</p>

    <table>
      <thead>
        <tr>
          <th>設定</th>
          <th>值</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>啟動診斷</td>
          <td><strong>停用</strong></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>保留其餘的預設值，然後按一下頁面底部的 [<strong>檢閱 + 建立</strong>] 按鈕。</p>
  </li>
  <li>
    <p>驗證通過後，按一下 [<strong>建立</strong>] 按鈕。部署虛擬機器可能需要 5 分鐘的時間。</p>
  </li>
  <li>
    <p>監視部署。建立資源群組和虛擬機器可能需要幾分鐘的時間。</p>
  </li>
  <li>
    <p>從 [部署] 刀鋒視窗或 [通知] 區域，按一下 [<strong>前往資源</strong>]。</p>
  </li>
  <li>
    <p>在 <strong>SimpleWinVM</strong> 虛擬機器刀鋒視窗中，按一下 [<strong>網路</strong>]，檢閱 [<strong>輸入連接埠規則</strong>] 索引標籤，並注意沒有與虛擬機器的網路介面或網路介面所連結的子網路關聯的網路安全性群組。</p>

    <p><strong>注意</strong>：識別網路介面的名稱。您將在下一個工作中需要它。</p>
  </li>
</ol>

<h1 id="工作-2建立網路安全性群組">工作 2：建立網路安全性群組</h1>

<p>在這個工作中，我們將建立一個網路安全性群組並將其與網路介面相關聯。</p>

<ol>
  <li>
    <p>從 [<strong>所有服務</strong>] 刀鋒視窗，搜尋並選取 [<strong>網路安全性群組</strong>]，然後按一下 [<strong>+ 新增、+ 建立、+ 新建</strong>]</p>
  </li>
  <li>
    <p>在 [<strong>建立網路安全性群組</strong>] 刀鋒視窗的 [<strong>基本</strong>] 索引標籤上，指定下列設定。</p>

    <table>
      <thead>
        <tr>
          <th>設定</th>
          <th>值</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>訂用帳戶</td>
          <td><strong>使用預設訂用帳戶</strong></td>
        </tr>
        <tr>
          <td>資源群組</td>
          <td><strong>從下拉式功能表中選取預設值</strong></td>
        </tr>
        <tr>
          <td>名稱</td>
          <td><strong>myNSGSecure</strong></td>
        </tr>
        <tr>
          <td>區域</td>
          <td><strong>美國東部</strong></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>按一下 [<strong>檢閱 + 建立</strong>]，然後在驗證後按一下 [<strong>建立</strong>]。</p>
  </li>
  <li>
    <p>在建立 NSG 後，按一下 [<strong>前往資源</strong>]。</p>
  </li>
  <li>
    <p>在 [<strong>設定</strong>] 下，按一下 [<strong>網路介面</strong>]，接著按一下 [<strong>關聯</strong>]。</p>
  </li>
  <li>
    <p>選取在上一個工作中識別的網路介面。</p>
  </li>
</ol>

<h1 id="工作-3設定輸入安全性連接埠規則以允許-rdp">工作 3：設定輸入安全性連接埠規則以允許 RDP</h1>

<p>在這個工作中，我們將透過設定輸入安全性連接埠規則來允許虛擬機器的 RDP 流量。</p>

<ol>
  <li>
    <p>在 Azure 入口網站中，導覽回 <strong>SimpleWinVM</strong> 虛擬機器的刀鋒視窗。</p>
  </li>
  <li>
    <p>在 [<strong>概觀</strong>] 窗格中，按一下 [<strong>連線</strong>]。</p>
  </li>
  <li>
    <p>透過選取 RDP 並下載執行 RDP 檔案，嘗試連線到虛擬機器。依預設，網路安全性群組不允許 RDP。關閉錯誤視窗。</p>

    <p><a href="../images/1201.png" target="_blank"><img src="../images/1201.png" alt="虛擬機器連線失敗的錯誤訊息的螢幕擷取畫面。"></a></p>
  </li>
  <li>
    <p>在虛擬機器刀鋒視窗上，向下滾動到 [<strong>設定</strong>] 部分，按一下 [<strong>網路</strong>]，注意 <strong>myNSGSecure (連結到網路介面：myVMNic)</strong> 網路安全性群組的輸入規則會拒絕所有輸入流量，虛擬網路和負載平衡器探測中的流量除外。</p>
  </li>
  <li>
    <p>在 [<strong>輸入連接埠規則</strong>] 索引標籤，按一下 [<strong>新增輸入連接埠規則</strong>]。完成後，按一下 [<strong>新增</strong>]。</p>

    <table>
      <thead>
        <tr>
          <th>設定</th>
          <th>值</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>源</td>
          <td><strong>任意</strong></td>
        </tr>
        <tr>
          <td>來源連接埠範圍</td>
          <td><strong>*</strong></td>
        </tr>
        <tr>
          <td>目的地</td>
          <td><strong>任意</strong></td>
        </tr>
        <tr>
          <td>目的地連接埠範圍</td>
          <td><strong>3389</strong></td>
        </tr>
        <tr>
          <td>協定</td>
          <td><strong>TCP</strong></td>
        </tr>
        <tr>
          <td>動作</td>
          <td><strong>允許</strong></td>
        </tr>
        <tr>
          <td>優先順序</td>
          <td><strong>300</strong></td>
        </tr>
        <tr>
          <td>名稱</td>
          <td><strong>AllowRDP</strong></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>選取 [<strong>新增</strong>] 並等待佈建規則，然後透過返回 [<strong>連線</strong>] 再次嘗試將 RDP 新增到虛擬機器中。這次您應該能成功。記住，使用者是 <strong>azureuser</strong>，密碼是 <strong>Pa$$w0rd1234</strong>。</p>
  </li>
</ol>

<h1 id="工作-4設定輸出安全性連接埠規則以拒絕網際網路存取">工作 4：設定輸出安全性連接埠規則以拒絕網際網路存取</h1>

<p>在這個工作中，我們將建立一個 NSG 輸出連接埠規則，該規則將拒絕網際網路存取，然後進行測試以確保該規則正常工作。</p>

<ol>
  <li>
    <p>在虛擬機器 RDP 工作階段中繼續。</p>
  </li>
  <li>
    <p>機器啟動後，開啟 <strong>Internet Explorer</strong> 瀏覽器。</p>
  </li>
  <li>
    <p>驗證您可以存取 <strong>https://www.bing.com</strong> ， 然後關閉 Internet Explorer。您需要透過 IE 增强安全性快顯視窗工作。</p>

    <p><strong>注意</strong>： 我們現在將設定一個規則來拒絕輸出網際網路存取。</p>
  </li>
  <li>
    <p>返回到 Azure 入口網站中，導覽回 <strong>SimpleWinVM</strong> 虛擬機器的刀鋒視窗。</p>
  </li>
  <li>
    <p>在 [<strong>設定</strong>] 下，按一下 [<strong>網路</strong>]，接著按一下 [<strong>輸出連接埠規則</strong>]。</p>
  </li>
  <li>
    <p>注意有一條規則 <strong>AllowInternetOutbound</strong>。這是預設規則，不能被刪除。</p>
  </li>
  <li>
    <p>按一下 <strong>myNSGSecure (連結到網路介面：myVMNic)</strong> 右側的 [<strong>新增輸出連接埠規則</strong>] 網路安全群組，並設定一個新的具有更高優先順序的輸出安全性規則，該規則將拒絕網際網路通訊。完成後，按一下 [<strong>新增</strong>]。</p>

    <table>
      <thead>
        <tr>
          <th>設定</th>
          <th>值</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>源</td>
          <td><strong>任意</strong></td>
        </tr>
        <tr>
          <td>來源連接埠範圍</td>
          <td><strong>*</strong></td>
        </tr>
        <tr>
          <td>目的地</td>
          <td><strong>服務標籤</strong></td>
        </tr>
        <tr>
          <td>目的地服務標籤</td>
          <td><strong>網際網路</strong></td>
        </tr>
        <tr>
          <td>目的地連接埠範圍</td>
          <td><strong>*</strong></td>
        </tr>
        <tr>
          <td>協定</td>
          <td><strong>TCP</strong></td>
        </tr>
        <tr>
          <td>動作</td>
          <td><strong>拒絕</strong></td>
        </tr>
        <tr>
          <td>優先順序</td>
          <td><strong>4000</strong></td>
        </tr>
        <tr>
          <td>名稱</td>
          <td><strong>DenyInternet</strong></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>按一下 [<strong>新增</strong>]，返回到您的 RDP 所在的 VM。</p>
  </li>
  <li>
    <p>瀏覽到 <strong>https://www.microsoft.com</strong> 。 該頁面不應顯示。您可能需要透過額外的 IE 增强安全性快顯視窗工作。</p>
  </li>
</ol>

<p><strong>注意</strong>：為了避免額外的成本，您可以删除此資源群組。搜尋資源群組，按一下您的資源群組，然後按一下 [<strong>删除資源群組</strong>]。驗證資源群組的名稱，然後按一下 [<strong>删除</strong>]。監視 [<strong>通知</strong>] 以驗證删除的狀態。</p>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/AZ-900T0xTW-MicrosoftAzureFundamentals" target="_blank" class="ml-2">
                    MicrosoftLearning/AZ-900T0xTW-MicrosoftAzureFundamentals
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D.js"></script>



</body></html>