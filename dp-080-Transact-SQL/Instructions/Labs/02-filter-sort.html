<!DOCTYPE html><html lang="en"><head>
        <title>
            dp-080-Transact-SQL
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D2df2a36a02d76b7c7d5687e30ec4acf097392490.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                dp-080-Transact-SQL
            </a>
            <a href="https://github.com/MicrosoftLearning/dp-080-Transact-SQL" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#challenge-1-retrieve-data-for-transportation-reports">Challenge 1: Retrieve data for transportation reports</a></li><li class="nav-item"><a class="nav-link" href="#challenge-2-retrieve-product-data">Challenge 2: Retrieve product data</a></li><li class="nav-item"><a class="nav-link" href="#challenge-1">Challenge 1</a></li><li class="nav-item"><a class="nav-link" href="#challenge-2">Challenge 2</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="sort-and-filter-query-results">Sort and Filter Query Results</h1>

<p>In this lab, you’ll use the Transact-SQL <strong>SELECT</strong> statement to query and filter data in the <strong>adventureworks</strong> database. For your reference, the following diagram shows the tables in the database (you may need to resize the pane to see them clearly).</p>

<p><a href="images/adventureworks-erd.png" target="_blank"><img src="images/adventureworks-erd.png" alt="An entity relationship diagram of the adventureworks database"></a></p>

<blockquote>
  <p><strong>Note</strong>: If you’re familiar with the standard <strong>AdventureWorks</strong> sample database, you may notice that in this lab we are using a simplified version that makes it easier to focus on learning Transact-SQL syntax.</p>
</blockquote>

<h2 id="sort-results-using-the-order-by-clause">Sort results using the ORDER BY clause</h2>

<p>It’s often useful to sort query results into a particular order.</p>

<ol>
  <li>
    <p>Modify the existing query to return the <strong>Name</strong> and <strong>ListPrice</strong> of all products:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock0" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product;
</code></pre>
  </li>
  <li>Run the query and note that the results are presented in no particular order.</li>
  <li>
    <p>Modify the query to add an <strong>ORDER BY</strong> clause that sorts the results by <strong>Name</strong>, as shown here:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock1" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock1" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>;
</code></pre>
  </li>
  <li>Run the query and review the results. This time the products are listed in alphabetical order by <strong>Name</strong>.</li>
  <li>
    <p>Modify the query as shown below to sort the results by <strong>ListPrice</strong>.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock2" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock2" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ListPrice;
</code></pre>
  </li>
  <li>Run the query and note that the results are listed in ascending order of <strong>ListPrice</strong>. By default, the <strong>ORDER BY</strong> clause applies an ascending sort order to the specified field.</li>
  <li>
    <p>Modify the query as shown below to sort the results into descending order of <strong>ListPrice</strong>.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock3" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock3" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ListPrice <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;
</code></pre>
  </li>
  <li>Run the query and note that the results now show the most expensive items first.</li>
  <li>
    <p>Modify the query as shown below to sort the results into descending order of <strong>ListPrice</strong>, and then into ascending order of <strong>Name</strong>.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock4" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock4" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ListPrice <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span>;
</code></pre>
  </li>
  <li>Run the query and review the results. Note that they are sorted into descending order of <strong>ListPrice</strong>, and each set of products with the same price is sorted in ascending order of <strong>Name</strong>.</li>
</ol>

<h2 id="restrict-results-using-top">Restrict results using TOP</h2>

<p>Sometimes you only want to return a specific number of rows. For example, you might want to find the twenty most expensive products.</p>

<ol>
  <li>
    <p>Modify the existing query to return the <strong>Name</strong> and <strong>ListPrice</strong> of all products:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock5" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock5" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TOP <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ListPrice <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;
</code></pre>
  </li>
  <li>Run the query and note that the results contain the first twenty products in descending order of <strong>ListPrice</strong>. Typically, you include an <strong>ORDER BY</strong> clause when using the <strong>TOP</strong> parameter; otherwise the query just returns the first specified number of rows in an arbitrary order.</li>
  <li>
    <p>Modify the query to add the <strong>WITH TIES</strong> parameter as shown here, and re-run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock6" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock6" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TOP <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TIES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ListPrice <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;
</code></pre>
  </li>
  <li>This time, there are 21 rows in the results, because there are multiple products that share the same price, one of which wasn’t included when ties were ignored by the previous query.</li>
  <li>
    <p>Modify the query to add the <strong>PERCENT</strong> parameter as shown here, and re-run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock7" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock7" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TOP <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TIES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ListPrice <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;
</code></pre>
  </li>
  <li>Note that this time the results contain the 20% most expensive products.</li>
</ol>

<h2 id="retrieve-pages-of-results-with-offset-and-fetch">Retrieve pages of results with OFFSET and FETCH</h2>

<p>User interfaces and reports often present large volumes of data as pages, you make them easier to navigate on a screen.</p>

<ol>
  <li>
    <p>Modify the existing query to return product <strong>Name</strong> and <strong>ListPrice</strong> values:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock8" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock8" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OFFSET</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEXT</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ONLY</span></span>;
</code></pre>
  </li>
  <li>Run the query and note the effect of the <strong>OFFSET</strong> and <strong>FETCH</strong> parameters of the <strong>ORDER BY</strong> clause. The results start at the 0 position (the beginning of the result set) and include only the next 10 rows, essentially defining the first page of results with 10 rows per page.</li>
  <li>
    <p>Modify the query as shown here, and run it to retrieve the next page of results.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock9" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock9" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OFFSET</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEXT</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ONLY</span></span>;
</code></pre>
  </li>
</ol>

<h2 id="use-the-all-and-distinct-options">Use the ALL and DISTINCT options</h2>

<p>Often, multiple rows in a table may contain the same values for a given subset of fields. For example, a table of products might contain a <strong>Color</strong> field that identifies the color of a given product. It’s not unreasonable to assume that there may be multiple products of the same color. Similarly, the table might contain a <strong>Size</strong> field; and again it’s not unreasonable to assume that there may be multiple products of the same size; or even multiple products with the same combination of size and color.</p>

<ol>
  <li>Start Azure Data Studio, and create a new query (you can do this from the <strong>File</strong> menu or on the <em>welcome</em> page).</li>
  <li>In the new <strong>SQLQuery_…</strong> pane, use the <strong>Connect</strong> button to connect the query to the <strong>AdventureWorks</strong> saved connection.</li>
  <li>
    <p>In the query editor, enter the following code:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock10" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock10" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> Color
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product;
</code></pre>
  </li>
  <li>
    <p>Use the <strong>⏵Run</strong> button to run the query, and and after a few seconds, review the results, which includes the color of each product in the table.</p>
  </li>
  <li>
    <p>Modify the query as follows, and re-run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock11" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock11" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ALL Color
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product;
</code></pre>

    <p>The results should be the same as before. The <strong>ALL</strong> parameter is the default behavior, and is applied implicitly to return a row for every record that meets the query criteria.</p>
  </li>
  <li>
    <p>Modify the query to replace <strong>ALL</strong> with <strong>DISTINCT</strong>, as shown here:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock12" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock12" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> Color
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product;
</code></pre>
  </li>
  <li>
    <p>Run the modified query and note that the results include one row for each unique <strong>Color</strong> value. This ability to remove duplicates from the results can often be useful - for example to retrieve values in order to populate a drop-down list of color options in a user interface.</p>
  </li>
  <li>
    <p>Modify the query to add the <strong>Size</strong> field as shown here:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock13" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock13" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> Color, <span class="hljs-keyword"><span class="hljs-keyword">Size</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product;
</code></pre>
  </li>
  <li>Run the modified query and note that it returns each unique combination of color and size.</li>
</ol>

<h2 id="filter-results-with-the-where-clause">Filter results with the WHERE clause</h2>

<p>Most queries for application development or reporting involve filtering the data to match specified criteria. You typically apply filtering criteria as a predicate in a <strong>WHERE</strong> clause of a query.</p>

<ol>
  <li>
    <p>In Azure Data Studio, replace the existing query with the following code:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock14" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock14" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, Color, <span class="hljs-keyword"><span class="hljs-keyword">Size</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ProductModelID = <span class="hljs-number"><span class="hljs-number">6</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>;
</code></pre>
  </li>
  <li>Run the query and review the results, which contain the <strong>Name</strong>, <strong>Color</strong>, and <strong>Size</strong> for each product with a <strong>ProductModelID</strong> value of <em>6</em> (this is the ID for the <em>HL Road Frame</em> product model, of which there are multiple variants).</li>
  <li>
    <p>Replace the query with the following code, which uses the <em>not equal</em> (&lt;&gt;) operator, and run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock15" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock15" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, Color, <span class="hljs-keyword"><span class="hljs-keyword">Size</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ProductModelID &lt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>;
</code></pre>
  </li>
  <li>Review the results, noting that they contain all products with a <strong>ProductModelID</strong> other than <strong>6</strong>.</li>
  <li>
    <p>Replace the query with the following code, and run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock16" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock16" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ListPrice &gt; <span class="hljs-number"><span class="hljs-number">1000.00</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ListPrice;
</code></pre>
  </li>
  <li>Review the results, noting that they contain all products with a <strong>ListPrice</strong> greater than 1000.00.</li>
  <li>
    <p>Modify the query as follows, and run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock17" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock17" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'HL Road Frame %'</span></span>;
</code></pre>
  </li>
  <li>
    <p>Review the results, noting that the <strong>LIKE</strong> operator enables you to match string patterns. The <strong>%</strong> character in the predicate is a wildcard for one or more characters, so the query returns all rows where the <strong>Name</strong> is <em>HL Road Frame</em> followed by any string.</p>

    <p>The <strong>LIKE</strong> operator can be used to define complex pattern matches based on regular expressions, which can be useful when dealing with string data that follows a predictable pattern.</p>
  </li>
  <li>
    <p>Modify the query as follows, and run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock18" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock18" class="mt-0"><code class="hljs markdown"> SELECT Name, ListPrice
 FROM SalesLT.Product
 WHERE ProductNumber LIKE 'FR-<span class="hljs-emphasis"><span class="hljs-emphasis">_[0-9][0-9]_</span></span>-[<span class="hljs-string"><span class="hljs-string">0-9</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0-9</span></span>]';
</code></pre>
  </li>
  <li>
    <p>Review the results. This time the results include products with a <strong>ProductNumber</strong> that matches patterns similar to FR-<em>xNNx</em>-<em>NN</em> (in which <em>x</em> is a letter and <em>N</em> is a numeral).</p>

    <p><strong>Tip</strong>: To learn more about pattern-matching with the <strong>LIKE</strong> operator, see the <a href="https://docs.microsoft.com/sql/t-sql/language-elements/like-transact-sql">Transact-SQL documentation</a>.</p>
  </li>
  <li>
    <p>Modify the query as follows, and run it.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock19" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock19" class="mt-0"><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
<span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
<span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> SellEndDate <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;
</code></pre>
  </li>
  <li>Note that to filter based on <em>NULL</em> values you must use <strong>IS NULL</strong> (or <strong>IS NOT NULL</strong>) you cannot compare a <em>NULL</em> value using the <strong>=</strong> operator.</li>
  <li>
    <p>Now try the following query, which uses the <strong>BETWEEN</strong> operator to define a filter based on values within a defined range.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock20" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock20" class="mt-0"><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
<span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> SellEndDate <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-string"><span class="hljs-string">'2006/1/1'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-string"><span class="hljs-string">'2006/12/31'</span></span>;
</code></pre>
  </li>
  <li>
    <p>Review the results, which contain products that the company stopped selling in 2006.</p>
  </li>
  <li>
    <p>Run the following query, which retrieves products with a <strong>ProductCategoryID</strong> value that is in a specified list.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock21" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock21" class="mt-0"><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ProductCategoryID, <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
<span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
<span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ProductCategoryID <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>);
</code></pre>
  </li>
  <li>
    <p>Now try the following query, which uses the <strong>AND</strong> operator to combine two criteria.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock22" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock22" class="mt-0"><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ProductCategoryID, <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice, SellEndDate
<span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
<span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ProductCategoryID <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> SellEndDate <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;
</code></pre>
  </li>
  <li>
    <p>Try the following query, which filters the results to include rows that match one (or both) of two criteria.</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock23" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock23" class="mt-0"><code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ProductCategoryID, ProductNumber
<span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
<span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ProductNumber <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'FR%'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> ProductCategoryID <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>);
</code></pre>
  </li>
</ol>

<h2 id="challenges">Challenges</h2>

<p>Now that you’ve seen some examples of filtering and sorting data, it’s your chance to put what you’ve learned into practice.</p>

<blockquote>
  <p><strong>Tip</strong>: Try to determine the appropriate queries for yourself. If you get stuck, suggested answers are provided at the end of this lab.</p>
</blockquote>

<h3 id="challenge-1-retrieve-data-for-transportation-reports">Challenge 1: Retrieve data for transportation reports</h3>

<p>The logistics manager at Adventure Works has asked you to generate some reports containing details of the company’s customers to help to reduce transportation costs.</p>

<ol>
  <li>Retrieve a list of cities
    <ul>
      <li>Initially, you need to produce a list of all of you customers’ locations. Write a Transact-SQL query that queries the <strong>SalesLT.Address</strong> table and retrieves the values for <strong>City</strong> and <strong>StateProvince</strong>, removing duplicates and sorted in ascending order of city.</li>
    </ul>
  </li>
  <li>Retrieve the heaviest products
    <ul>
      <li>Transportation costs are increasing and you need to identify the heaviest products. Retrieve the names of the top ten percent of products by weight.</li>
    </ul>
  </li>
</ol>

<h3 id="challenge-2-retrieve-product-data">Challenge 2: Retrieve product data</h3>

<p>The Production Manager at Adventure Works would like you to create some reports listing details of the products that you sell.</p>

<ol>
  <li>Retrieve product details for product model 1
    <ul>
      <li>Initially, you need to find the names, colors, and sizes of the products with a product model ID 1.</li>
    </ul>
  </li>
  <li>Filter products by color and size
    <ul>
      <li>Retrieve the product number and name of the products that have a color of <em>black</em>, <em>red</em>, or <em>white</em> and a size of <em>S</em> or <em>M</em>.</li>
    </ul>
  </li>
  <li>Filter products by product number
    <ul>
      <li>Retrieve the product number, name, and list price of products whose product number begins <em>BK-</em></li>
    </ul>
  </li>
  <li>Retrieve specific products by product number
    <ul>
      <li>Modify your previous query to retrieve the product number, name, and list price of products whose product number begins <em>BK-</em> followed by any character other than <em>R</em>, and ends with a <em>-</em> followed by any two numerals.</li>
    </ul>
  </li>
</ol>

<h2 id="challenge-solutions">Challenge Solutions</h2>

<p>This section contains suggested solutions for the challenge queries.</p>

<h3 id="challenge-1">Challenge 1</h3>

<ol>
  <li>
    <p>Retrieve a list of cities:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock24" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock24" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> City, StateProvince
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Address
 ORDFER <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> City
</code></pre>
  </li>
  <li>
    <p>Retrieve the heaviest products:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock25" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock25" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TOP <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TIES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> Weight <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;
</code></pre>
  </li>
</ol>

<h3 id="challenge-2">Challenge 2</h3>

<ol>
  <li>
    <p>Retrieve product details for product model 1:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock26" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock26" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, Color, <span class="hljs-keyword"><span class="hljs-keyword">Size</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ProductModelID = <span class="hljs-number"><span class="hljs-number">1</span></span>;
</code></pre>
  </li>
  <li>
    <p>Filter products by color and size:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock27" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock27" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ProductNumber, <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> Color <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'Black'</span></span>,<span class="hljs-string"><span class="hljs-string">'Red'</span></span>,<span class="hljs-string"><span class="hljs-string">'White'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Size</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'S'</span></span>,<span class="hljs-string"><span class="hljs-string">'M'</span></span>);
</code></pre>
  </li>
  <li>
    <p>Filter products by product number:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock28" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock28" class="mt-0"><code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ProductNumber, <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, ListPrice
 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SalesLT.Product
 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ProductNumber <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'BK-%'</span></span>;
</code></pre>
  </li>
  <li>
    <p>Retrieve specific products by product number:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock29" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock29" class="mt-0"><code class="hljs markdown"> SELECT ProductNumber, Name, ListPrice
 FROM SalesLT.Product
 WHERE ProductNumber LIKE 'BK-[<span class="hljs-string"><span class="hljs-string">^R</span></span>]%-[<span class="hljs-string"><span class="hljs-string">0-9</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0-9</span></span>]';
</code></pre>
  </li>
</ol>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/dp-080-Transact-SQL" target="_blank" class="ml-2">
                    MicrosoftLearning/dp-080-Transact-SQL
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D2df2a36a02d76b7c7d5687e30ec4acf097392490.js"></script>



</body></html>