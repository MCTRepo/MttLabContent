<!DOCTYPE html><html lang="en"><head>
        <title>
            PL-900ZH-Microsoft-Power-Platform-Fundamentals
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                PL-900ZH-Microsoft-Power-Platform-Fundamentals
            </a>
            <a href="https://github.com/MicrosoftLearning/PL-900ZH-Microsoft-Power-Platform-Fundamentals" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    </ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="模块-5power-bi-入门">模块 5：Power BI 入门</h1>
<h2 id="实验室如何生成简单仪表板">实验室：如何生成简单仪表板</h2>

<h1 id="应用场景">应用场景</h1>

<p>Bellows College 是一所教育机构，校园内有多座建筑。当前，校园访客被记录在纸质日记中。无法始终如一地捕获信息，也无法收集和分析有关整个校园的访问数据。</p>

<p>校园管理部门希望对其访客登记系统进行现代化改造。在该系统中，由安全人员控制对建筑物的访问，所有访问都必须由主办人预先登记和记录。</p>

<p>在整个课程中，你将生成应用程序并执行自动化，以使 Bellows College 的管理和安全人员可以管理和控制校园建筑的出入情况。</p>

<p>在本实验室中，你将构建一个 Power BI 仪表板，以可视化方式显示有关校园访问的数据。</p>

<h1 id="概要实验室步骤">概要实验室步骤</h1>

<p>我们将按照以下步骤设计和创建 Power BI 仪表板：</p>

<ul>
  <li>连接到 Dataverse</li>
  <li>转换数据以包括对相关行（查找）的用户友好描述</li>
  <li>创建并发布包含各种校园访问信息可视化效果的报表</li>
  <li>利用用户自然语言查询来生成额外的可视化效果</li>
  <li>生成 Power BI 仪表板的移动视图</li>
</ul>

<h2 id="前提条件">前提条件</h2>

<ul>
  <li>完成 <strong>“模块 0 实验室 0 - 验证实验室环境”</strong></li>
  <li>完成 <strong>“模块 2 实验室 1 - Microsoft Dataverse 简介”</strong></li>
</ul>

<h2 id="开始前要考虑的事项">开始前要考虑的事项</h2>

<ul>
  <li>报告的目标受众是谁？</li>
  <li>受众将如何使用报告？典型的设备？位置？</li>
  <li>你是否有足够的数据进行可视化？</li>
  <li>可以使用哪些可能的特征来分析访问数据？</li>
</ul>

<h1 id="练习-1创建-power-bi-报告">练习 #1：创建 Power BI 报告</h1>

<p><strong>目标：</strong> 在本练习中，你将基于 Dataverse 数据库中的数据创建 Power BI 报表。</p>

<h2 id="任务-1安装-power-bi-desktop准备-power-bi-服务">任务 #1：安装 Power BI Desktop/准备 Power BI 服务</h2>

<ol>
  <li>
    <p>请按照以下说明设置 Power BI：</p>

    <ul>
      <li>
        <p>如果 <strong>Power BI Desktop</strong> 已安装，请跳至<a href="#task-2-prepare-data">任务 #2</a>。</p>
      </li>
      <li>
        <p>如果尚未安装 Power BI Desktop，请完成<strong>步骤 #2</strong>。</p>
      </li>
      <li>
        <p>如果你没有必需的权限或在运行 Power BI Desktop 时遇到问题，请继续 <strong>步骤 #4</strong>。</p>
      </li>
    </ul>
  </li>
  <li>
    <p>导航到 <a href="https://aka.ms/pbidesktopstore">https://aka.ms/pbidesktopstore</a> 下载并安装 Power BI Desktop。</p>

    <blockquote>
      <p>[!重要事项]
如果在使用 Microsoft Store 安装 Power BI Desktop 时遇到问题，请尝试从 <a href="https://aka.ms/pbiSingleInstaller">https://aka.ms/pbiSingleInstaller</a> 下载的独立安装程序。</p>
    </blockquote>
  </li>
  <li>
    <p>如果成功安装了 Power BI Desktop，现在可以跳至<a href="#task-2-prepare-data">任务 #2</a>；否则，请继续下一步。</p>

    <blockquote>
      <p>如果你没有安装桌面应用程序所需的权限，或者在运行或配置 Power BI Desktop 时遇到困难，请完成以下任务步骤。</p>
    </blockquote>
  </li>
  <li>
    <p>在计算机上下载并保存 <a href="../../Allfiles/visits.pbix">visits.pbix</a>。</p>
  </li>
  <li>
    <p>导航到 <a href="https://app.powerbi.com/">https://app.powerbi.com/</a> 并单击 <strong>“登录”</strong>。</p>
  </li>
  <li>
    <p>单击 <strong>“我的工作区”</strong>。</p>
  </li>
  <li>
    <p>如果显示 <strong>“获取数据”</strong> 页面，请单击 <strong>“跳过”</strong>。</p>
  </li>
  <li>
    <p>展开 <strong>“+新建”</strong> 并选择 <strong>“上传文件”</strong>。</p>

    <blockquote>
      <p>[!重要事项]
如果看不到 <strong>“+ 新建”</strong>，你可能需要激活 Power BI 的新外观。确保将屏幕顶部的 <strong>“新外观”</strong> 切换至 <strong>“开”</strong>。</p>
    </blockquote>
  </li>
  <li>
    <p>选择 <strong>“本地文件”</strong>。</p>
  </li>
  <li>
    <p>找到并选择你之前下载的 <strong>visits.pbix</strong> 文件。</p>
  </li>
  <li>
    <p>数据加载完成后，选择 <strong>“visits”</strong> 报表（请注意，“类型”设置为 <strong>“报表”</strong>。</p>
  </li>
  <li>
    <p>单击 <strong>“编辑”</strong>。如果 <strong>“编辑”</strong> 菜单项不可见，请单击 <strong>“…”</strong>，然后选择 <strong>“编辑”</strong>。</p>
  </li>
  <li>
    <p>现在，你已经设置了 Power BI 服务以用于你的实验室。继续<a href="#task-3-create-chart-and-time-visualizations">任务 #3</a>，但可以在整个实验室中使用联机 Power BI 服务 (<a href="https://app.powerbi.com">https://app.powerbi.com</a>)，而不是 Power BI Desktop。</p>
  </li>
</ol>

<h2 id="任务-2准备数据">任务 #2：准备数据</h2>

<ol>
  <li>
    <p>找到贵组织 URL</p>

    <ul>
      <li>
        <p>在新选项卡中，导航到 Power Platform 管理中心，网址为 <a href="https://admin.powerplatform.com">https://admin.powerplatform.com</a></p>
      </li>
      <li>
        <p>在左侧导航页中，选择“环境”，然后打开“练习”环境。</p>
      </li>
      <li>
        <p>右键单击在 <strong>“详细信息”</strong> 面板上的 <strong>“环境 URL”</strong>，然后选择 <strong>“复制链接地址”</strong>。</p>
      </li>
    </ul>
  </li>
  <li>
    <p>打开 Power BI Desktop，如果出现提示，请使用提供给你的凭据登录。</p>
  </li>
  <li>
    <p>选择“<strong>获取数据</strong>”，然后选择“<strong>更多…</strong>”。</p>
  </li>
  <li>
    <p>选择左侧的“<strong>Power Platform</strong>”，然后选择“<strong>Common Data Service (旧版)</strong>”，最后按“<strong>连接</strong>”。如果出现提示，请使用提供的凭据登录并单击“<strong>连接</strong>”。</p>
  </li>
  <li>
    <p>将你先前复制的环境 URL 粘贴到 <strong>“服务器 URL”</strong> 字段，按 <strong>“确定”</strong>。</p>
  </li>
  <li>
    <p>展开 <strong>“实体”</strong> 节点，选择 <strong>“bc_Building”</strong> 和 <strong>“bc_Visit”</strong> 实体，然后单击 <strong>“加载”</strong>。</p>
  </li>
  <li>
    <p>单击左侧垂直工具栏上的 <strong>“模型”</strong> 图标。</p>
  </li>
  <li>
    <p>拖动 <strong>bc_Building</strong> 表中的 <strong>bc_buildingid</strong> 列并将其放置到 <strong>bc_Visit</strong> 表中的 <strong>bc_building</strong> 列中 。这将在两个表之间创建关系，Power BI 将使用这两个表来显示相关数据。</p>
  </li>
  <li>
    <p>选择左侧工具栏上的 <strong>“报表”</strong> 图标。</p>
  </li>
  <li>
    <p>展开 <strong>“字段”</strong> 面板中的 <strong>bc_Visit</strong> 节点。</p>
  </li>
  <li>
    <p>单击 <strong>bc_Visit</strong> 旁边的 <strong>“…”</strong>，然后选择 <strong>“新建列”</strong>。</p>
  </li>
  <li>
    <p>按如下方式完成公式：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock0" class="mt-0"><code class="hljs ini"><span class="hljs-attr"><span class="hljs-attr">Column</span></span> = RELATED(bc_Building[bc_name])
</code></pre>

    <p>然后按 Enter。这会将带有建筑名称的新字段添加到访问数据中。</p>
  </li>
  <li>
    <p>单击你刚刚创建的 <strong>“列”</strong> 字段旁边的 <strong>“…”</strong>，并选择 <strong>“重命名”</strong>。输入 <strong>“建筑”</strong> 作为字段名称。</p>
  </li>
  <li>
    <p>单击 <strong>bc_visitid</strong> 字段旁边的 <strong>“…”</strong>，并选择 <strong>“重命名”</strong>。输入 <strong>“访问”</strong> 作为字段名称。</p>
  </li>
  <li>
    <p>单击 <strong>bc_scheduledstart</strong> 字段旁边的 <strong>“…”</strong>，并选择 <strong>“重命名”</strong>。输入 <strong>“开始”</strong> 作为字段名称。</p>
  </li>
  <li>
    <p>要保存正在进行的工作，请按下 <strong>“文件 | “保存”</strong> 并输入你选择的文件名。</p>
  </li>
</ol>

<h2 id="任务-3创建图表和时间可视化">任务 #3：创建图表和时间可视化</h2>

<ol>
  <li>
    <p>按 <strong>“可视化效果”</strong> 面板中的饼图图标，以插入图表。</p>
  </li>
  <li>
    <p>拖动 <strong>“建筑”</strong> 字段并将其放入 <strong>“图例”</strong> 框。</p>
  </li>
  <li>
    <p>拖动 <strong>“访问”</strong> 字段并将其放入 <strong>“值”</strong> 目标框。</p>
  </li>
  <li>
    <p>使用角柄调整饼图的大小，以便所有图表组件均可见。</p>
  </li>
  <li>
    <p>单击饼图外的报表以取消选择它，然后选择 <strong>“可视化效果”</strong> 窗格中的堆积柱形图。</p>
  </li>
  <li>
    <p>拖动 <strong>“访问”</strong> 字段并将其放入 <strong>“值”</strong> 目标框。</p>
  </li>
  <li>
    <p>拖动 <strong>“开始”</strong> 字段并将其放入 <strong>“轴”</strong> 目标框。</p>
  </li>
  <li>
    <p>在“可视化效果”窗格中，单击 <strong>“天”</strong> 和 <strong>“季度”</strong> 旁边的 <strong>“x”</strong>，只为 <strong>“轴”</strong> 留下 <strong>“年”</strong> 和 <strong>“月”</strong> 总计。</p>
  </li>
  <li>
    <p>根据需要使用角柄调整图表大小。</p>
  </li>
  <li>
    <p>测试报告交互性：</p>

    <ul>
      <li>
        <p>在饼图上选择各种建筑切片，并观察时间报告上的变化。</p>
      </li>
      <li>
        <p>单击柱形图。按向下箭头开启 <strong>“向下钻取”</strong> 模式，然后按该列以向下钻取到下一个级别（月）。另一种方法是单击功能区上的 <strong>“数据/钻取 | 展开下一级别”</strong>。</p>
      </li>
      <li>
        <p>向上和向下钻取，选择时间柱形图上的各种条形，以观察饼图报告中的变化。</p>
      </li>
    </ul>
  </li>
  <li>
    <p>要保存正在进行的工作，请按下 <strong>“文件 | “保存”</strong>。</p>
  </li>
</ol>

<h1 id="练习-2创建-power-bi-仪表板">练习 2：创建 Power BI 仪表板</h1>

<h2 id="任务-1发布-power-bi-报告">任务 #1：发布 Power BI 报告</h2>

<ol>
  <li>
    <p>按功能区“主页”选项卡上的 <strong>“发布”</strong> 按钮。</p>
  </li>
  <li>
    <p>选择 <strong>“我的工作区”</strong> 作为目的地，然后按 <strong>“选择”</strong>。</p>
  </li>
  <li>
    <p>等待发布完成，然后单击 <strong>“在 Power BI 中打开 &lt;name of your report&gt;.pbix”</strong>。</p>
  </li>
</ol>

<h2 id="任务-2创建-power-bi-仪表板">任务 #2：创建 Power BI 仪表板</h2>

<ol>
  <li>
    <p>打开上一个任务中生成的报表。</p>
  </li>
  <li>
    <p>在菜单上选择 <strong>“固定到仪表板”</strong>。根据布局，你可能需要按 <strong>“…”</strong> 以显示其他菜单项。</p>
  </li>
  <li>
    <p>在 <strong>“固定到仪表板”</strong> 提示上选择 <strong>“新建仪表板”</strong>。</p>
  </li>
  <li>
    <p>输入 <strong>“[你的姓氏] 校园管理”</strong> 作为 <strong>“仪表板名称”</strong>，然后按 <strong>“固定活动页”</strong>。</p>
  </li>
  <li>
    <p>依次选择顶部的 <strong>“我的工作区”</strong>、 <strong>“[你的姓氏] 校园管理”</strong> 仪表板。</p>
  </li>
  <li>
    <p>测试显示的饼图和条形图的交互性。</p>
  </li>
</ol>

<h2 id="任务-3使用自然语言添加可视化">任务 #3：使用自然语言添加可视化</h2>

<ol>
  <li>
    <p>在 <strong>“校园管理”</strong> 仪表板内，选择顶部的 <strong>“提出与数据有关的问题”</strong> 栏。</p>
  </li>
  <li>
    <p>输入问答区域中 <strong>“按访问次数划分的建筑”</strong>。将显示条形图。</p>
  </li>
  <li>
    <p>选择 <strong>“固定视觉对象”</strong>。</p>
  </li>
  <li>
    <p>依次选择 <strong>“现有仪表板”</strong>、 <strong>“[你的姓氏] 校园管理”</strong> 仪表板，然后按 <strong>“固定”</strong>。</p>
  </li>
  <li>
    <p>单击 <strong>“退出问答”</strong>。</p>
  </li>
</ol>

<p>将显示 <strong>“[你的姓氏] 校园管理”</strong> 仪表板。可能需要向下滚动才能看到新的“问答”视觉对象。</p>

<p>你的仪表板应类似如下所示：</p>

<p><a href="media/5-powerbi-result.png" target="_blank"><img src="media/5-powerbi-result.png" alt="Power BI 仪表板"></a></p>

<h2 id="任务-4生成手机视图并通过-qr-码共享报表">任务 #4：生成手机视图并通过 QR 码共享报表</h2>

<ol>
  <li>
    <p>在仪表板中，选择 <strong>“编辑 | 移动视图”</strong>。</p>
  </li>
  <li>
    <p>根据需要重新排列图块。</p>
  </li>
  <li>
    <p>单击右上角的 <strong>“手机视图”</strong>，并将“视图”更改为 <strong>“Web 视图”</strong>。</p>
  </li>
  <li>
    <p>选择顶部的 <strong>“我的工作区”</strong>，然后选择 <strong>“报表”</strong>。</p>
  </li>
  <li>
    <p>选择 <strong>“编辑”</strong>，然后选择 <strong>“…| 生成 QR 码”</strong>。</p>
  </li>
  <li>
    <p><em>可选：</em> 如果你拥有移动设备，请使用 iOS 和 Android 平台上均可用的 QR 扫描仪应用来扫描 QR 码，如果手机支持，也可使用相机应用扫描 QR 码。如果出现提示，请登录帐户。在移动设备上导航和浏览报表。</p>
  </li>
</ol>

<h1 id="挑战">挑战</h1>

<ul>
  <li>仪表板和报表，包括校园和建筑平面图</li>
  <li>报告并分析访问模式和趋势</li>
  <li>逾期可视化</li>
  <li>流式 Power BI，用于大型校园的近实时处理</li>
</ul>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/PL-900ZH-Microsoft-Power-Platform-Fundamentals" target="_blank" class="ml-2">
                    MicrosoftLearning/PL-900ZH-Microsoft-Power-Platform-Fundamentals
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D.js"></script>



</body></html>