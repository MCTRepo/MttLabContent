<!DOCTYPE html><html lang="en"><head>
        <title>
            DP-300T00-Administering-Relational-Databases-on-Azure
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D525e69932921e8ce30e81ee0f98ad4a87cda64ea.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                DP-300T00-Administering-Relational-Databases-on-Azure
            </a>
            <a href="https://github.com/MicrosoftLearning/DP-300T00-Administering-Relational-Databases-on-Azure" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    </ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="lab-2--deploying-paas-databases">Lab 2 – Deploying PaaS databases</h1>

<p><strong>Estimated Completion Time:</strong> 35-40 minutes</p>

<p><strong>Pre-requisites:</strong> None</p>

<p><strong>Lab files:</strong> None</p>

<h1 id="lab-overview">Lab Overview</h1>

<p>The student will configure basic resources needed to deploy an Azure SQL Database with a Virtual Network Endpoint. Connectivity to the SQL Database will be validated using Azure Data Studio from the lab VM. Finally, an Azure Database for PostgreSQL will be created.</p>

<h1 id="lab-objectives">Lab Objectives</h1>

<p>The students will:</p>

<ol>
  <li>
    <p>Configure basic resources</p>
  </li>
  <li>
    <p>Deploy an Azure SQL Database</p>
  </li>
  <li>
    <p>Connect to Azure SQL Database with Azure Data Studio</p>
  </li>
  <li>
    <p>Deploy an Azure Database for PostgreSQL</p>
  </li>
</ol>

<h1 id="scenario">Scenario</h1>

<p>As a database administrator for AdventureWorks, you will set up a new SQL Database, including a Virtual Network Endpoint to increase and simplify the security of the deployment. Azure Data Studio will be used to evaluate the use of a SQL Notebook for data querying and results retention.</p>

<p>Finally, an Azure Database for PostgreSQL will be deployed to support additional data system needs.</p>

<h1 id="exercise-1-configure-basic-resources">Exercise 1: Configure Basic Resources</h1>

<h2 id="task-1-create-a-resource-group">Task 1: Create a Resource Group</h2>

<ol>
  <li>
    <p>Start a browser, and open the Azure Portal at <a href="https://portal.azure.com/">https://portal.azure.com</a>, logging in with the appropriate credentials</p>
  </li>
  <li>
    <p>From the Home screen, click on the <strong>Resource Groups</strong> button</p>

    <p><a href="../images/dp-3300-module-22-lab-01.png" target="_blank"><img src="../images/dp-3300-module-22-lab-01.png" alt="Picture 1"></a></p>
  </li>
  <li>
    <p>Review your existing Resource Groups and then click on the <strong>Create</strong> button to create a new Resource Group.</p>

    <p><a href="../images/dp-3300-module-22-lab-02.png" target="_blank"><img src="../images/dp-3300-module-22-lab-02.png" alt="Picture 7"></a></p>
  </li>
  <li>
    <p>Complete the Create a Resource Group wizard with the required information to create the RG.</p>

    <ul>
      <li>
        <p>Ensure Subscription is set to the desired subscription</p>
      </li>
      <li>
        <p>Enter <strong>DP-300-Lab02</strong> for the name of the Resource Group</p>
      </li>
      <li>
        <p>For the purposes of this lab, select the Region nearest to your physical location</p>
      </li>
      <li>
        <p>Click the <strong>Review + create</strong> button</p>
      </li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-03.png" target="_blank"><img src="../images/dp-3300-module-22-lab-03.png" alt="Picture 4"></a></p>

    <ul>
      <li>Click the <strong>Create</strong> button</li>
    </ul>
  </li>
</ol>

<h2 id="task-2-create-a-virtual-network">Task 2: Create a Virtual Network</h2>

<ol>
  <li>
    <p>In the left navigation pane, click <strong>Virtual Networks</strong></p>

    <p><a href="../images/dp-3300-module-22-lab-04.png" target="_blank"><img src="../images/dp-3300-module-22-lab-04.png" alt="Picture 6"></a></p>
  </li>
  <li>
    <p>Click <strong>+ Create</strong> to open the <strong>Create Virtual Network</strong> page. On the <strong>Basics</strong> tab, complete the following information:</p>

    <ul>
      <li>
        <p>Subscription: <strong>Select the lab subscription</strong></p>
      </li>
      <li>
        <p>Resource Group: Select the <strong>DP-300-Lab02</strong> Resource Group</p>
      </li>
      <li>
        <p>Name: <strong>Lab02-vnet</strong></p>
      </li>
      <li>
        <p>Region: Select the same region where the Resource Group was created (the region nearest to your location)</p>
      </li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-05.png" target="_blank"><img src="../images/dp-3300-module-22-lab-05.png" alt="Picture 9"></a></p>

    <ul>
      <li>Click the <strong>Next: IP Addresses</strong> button</li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-06.png" target="_blank"><img src="../images/dp-3300-module-22-lab-06.png" alt="Picture 10"></a></p>
  </li>
  <li>
    <p>Configure the virtual network’s IP range for the Azure SQL database endpoint</p>

    <ul>
      <li>
        <p>On the IP Addresses page, leave the defaults for the IPv4 address space.</p>
      </li>
      <li>
        <p>Click on the <strong>default</strong> subnet. (Note that the Subnet address range you see might be different.)</p>
      </li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-07.png" target="_blank"><img src="../images/dp-3300-module-22-lab-07.png" alt="Picture 12"></a></p>

    <ul>
      <li>In the Edit subnet flyout on the right, expand the Services drop-down, and tick <strong>Microsoft.Sql</strong></li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-08.png" target="_blank"><img src="../images/dp-3300-module-22-lab-08.png" alt="Picture 13"></a></p>

    <ul>
      <li>
        <p>Click <strong>Save</strong></p>
      </li>
      <li>
        <p>Click the <strong>Review + Create</strong> button, review the settings for the new virtual network, and then click <strong>Create</strong></p>
      </li>
    </ul>
  </li>
</ol>

<h1 id="exercise-2-deploy-an-azure-sql-database">Exercise 2: Deploy an Azure SQL Database</h1>

<h2 id="task-1-deploy-an-azure-sql-database">Task 1: Deploy an Azure SQL Database</h2>

<ol>
  <li>
    <p>From the Azure Portal, click on <strong>+ Create a Resource</strong> at the top of the left side navigation bar</p>

    <p><a href="../images/dp-3300-module-22-lab-09.png" target="_blank"><img src="../images/dp-3300-module-22-lab-09.png" alt="Picture 14"></a></p>
  </li>
  <li>
    <p>Search for “SQL databases” in the search box at the top, then click <strong>SQL Databases</strong> from the list of options</p>

    <p><a href="../images/dp-3300-module-22-lab-10.png" target="_blank"><img src="../images/dp-3300-module-22-lab-10.png" alt="Picture 15"></a></p>
  </li>
  <li>
    <p>Click the <strong>Create</strong> button</p>
  </li>
  <li>
    <p>Complete the Create SQL Database Basics screen with the following inputs and then click <strong>Next: Networking</strong></p>

    <ul>
      <li>
        <p>Subscription: Select the lab subscription</p>
      </li>
      <li>
        <p>Resource Group: <strong>DP-300-Lab02</strong> (the RG created in Exercise 1)</p>
      </li>
      <li>
        <p>Database Name: <strong>AdventureWorksLT</strong></p>
      </li>
      <li>
        <p>Server: click <strong>Create new.</strong> In the New Server sidebar, complete the form as follows:</p>

        <ul>
          <li>
            <p>Server name: <strong>dp300-lab-&lt;your initials (lower case)&gt;</strong> (server name must be globally unique)</p>
          </li>
          <li>
            <p>Location: Select the Region nearest to you (same as in Exercise 1)</p>
          </li>
          <li>
            <p>Server admin login: <strong>dp300admin</strong></p>
          </li>
          <li>
            <p>Password: <strong>dp300P@ssword!</strong></p>
          </li>
          <li>
            <p>Confirm password: <strong>dp300P@ssword!</strong></p>
          </li>
          <li>
            <p>Your New server sidebar should look similar to the one below. Click <strong>OK</strong></p>
          </li>
        </ul>

        <p><a href="../images/dp-3300-module-22-lab-11.png" target="_blank"><img src="../images/dp-3300-module-22-lab-11.png" alt="A screenshot of a cell phone Description automatically generated"></a></p>
      </li>
      <li>
        <p>On the Create SQL Database page, make sure <strong>Want to use Elastic Pool</strong> is set to <strong>No</strong></p>
      </li>
      <li>
        <p>Compute + Storage: Click <strong>Configure database</strong></p>

        <ul>
          <li>On the Configure screen, for Service tier dropdown, select <strong>Basic</strong></li>
        </ul>

        <p><a href="../images/dp-3300-module-22-lab-12.png" target="_blank"><img src="../images/dp-3300-module-22-lab-12.png" alt="Picture 16"></a></p>

        <ul>
          <li>
            <p>Click <strong>Basic</strong></p>
          </li>
          <li>
            <p>Click the <strong>Apply</strong> button</p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<p><strong>Note: Make note of this server name, and your login information. You will use it in subsequent labs.</strong></p>

<ol>
  <li>
    <p>If you see the option <strong>Backup storage redundancy</strong>, keep the default value: <strong>Geo-redundant backup storage</strong>.</p>
  </li>
  <li>
    <p>Review settings and then click <strong>Next: Networking</strong></p>

    <p><a href="../images/dp-3300-module-22-lab-13.png" target="_blank"><img src="../images/dp-3300-module-22-lab-13.png" alt="A screenshot of a cell phone Description automatically generated"></a></p>
  </li>
  <li>
    <p>On the Networking screen, for Connectivity method, click the <strong>Private endpoint</strong> radio button</p>

    <p><a href="../images/dp-3300-module-22-lab-14.png" target="_blank"><img src="../images/dp-3300-module-22-lab-14.png" alt="Picture 19"></a></p>
  </li>
  <li>
    <p>Then click the <strong>Add private endpoint</strong> link under Private Endpoints</p>

    <p><a href="../images/dp-3300-module-22-lab-15.png" target="_blank"><img src="../images/dp-3300-module-22-lab-15.png" alt="Picture 20"></a></p>
  </li>
  <li>
    <p>Complete the Create private endpoint flyout as follows:</p>

    <ul>
      <li>
        <p>Subscription: Ensure the lab subscription is selected</p>
      </li>
      <li>
        <p>Resource group: <strong>DP-300-Lab02</strong></p>
      </li>
      <li>
        <p>Location: The same Region that was selected for previous parts of this lab</p>
      </li>
      <li>
        <p>Name: <strong>DP-300-SQL-Endpoint</strong></p>
      </li>
      <li>
        <p>Target sub-resource: <strong>SqlServer</strong></p>
      </li>
      <li>
        <p>Virtual network: <strong>Lab02-vnet</strong></p>
      </li>
      <li>
        <p>Subnet: <strong>default (10.x.0.0/24)</strong></p>
      </li>
      <li>
        <p>The Private DNS integration options can remain at the default</p>
      </li>
      <li>
        <p>Review settings before clicking <strong>OK</strong></p>
      </li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-16.png" target="_blank"><img src="../images/dp-3300-module-22-lab-16.png" alt="Picture 21"></a></p>
  </li>
  <li>
    <p>Confirm the endpoint appears on the Networking page.</p>

    <p><a href="../images/dp-3300-module-22-lab-17.png" target="_blank"><img src="../images/dp-3300-module-22-lab-17.png" alt="Picture 22"></a></p>
  </li>
  <li>
    <p>Click the <strong>Next: Security</strong> button, and then <strong>Next: Additional settings</strong> button.</p>
  </li>
  <li>
    <p>On the Additional Settings page, select the following options:</p>

    <ul>
      <li>Set Use existing data to <strong>Sample</strong></li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-18.png" target="_blank"><img src="../images/dp-3300-module-22-lab-18.png" alt="Picture 23"></a></p>
  </li>
  <li>
    <p>Click <strong>Review + Create</strong></p>
  </li>
  <li>
    <p>Review the settings before clicking <strong>Create</strong></p>
  </li>
  <li>
    <p>Once the deployment is complete, click the <strong>Go to resource</strong> button</p>
  </li>
</ol>

<h2 id="task-2-enable-all-azure-services-access-to-new-sql-server">Task 2: Enable All Azure Services access to new SQL Server</h2>

<ol>
  <li>
    <p>From the SQL Database blade, click on the link for the Server name in the top section</p>

    <p><a href="../images/dp-3300-module-22-lab-19.png" target="_blank"><img src="../images/dp-3300-module-22-lab-19.png" alt="Picture 3"></a></p>
  </li>
  <li>
    <p>On the SQL Server object’s navigation blade, click <strong>Firewalls and virtual networks</strong> under <strong>Security</strong></p>

    <p><a href="../images/dp-3300-module-22-lab-20.png" target="_blank"><img src="../images/dp-3300-module-22-lab-20.png" alt="Picture 27"></a></p>
  </li>
  <li>
    <p>Set <strong>Allow Azure services and resources to access this server</strong> to <strong>Yes</strong></p>

    <p><a href="../images/dp-3300-module-22-lab-21.png" target="_blank"><img src="../images/dp-3300-module-22-lab-21.png" alt="Picture 6"></a></p>
  </li>
  <li>
    <p>Click <strong>Save</strong>, and then click <strong>OK</strong> on the Success message pane.</p>
  </li>
</ol>

<h1 id="exercise-3-connect-to-azure-sql-database">Exercise 3: Connect to Azure SQL Database</h1>

<h2 id="task-1-register-azure-sql-database-instance-in-azure-data-studio">Task 1: Register Azure SQL Database Instance in Azure Data Studio</h2>

<ol>
  <li>
    <p>Launch Azure Data Studio (ADS) from the lab VM</p>

    <ul>
      <li>You may see this pop-up at initial launch of Azure Data Studio. If you receive it, click <strong>Yes</strong><br>
<a href="../images/dp-3300-module-22-lab-22.png" target="_blank"><img src="../images/dp-3300-module-22-lab-22.png" alt="Picture 24"></a></li>
    </ul>
  </li>
  <li>
    <p>When Azure Data Studio opens, click the <strong>Connections</strong> button in Azure Data Studio’s left sidebar, then the <strong>Add Connection</strong> button</p>

    <p><a href="../images/dp-3300-module-22-lab-25.png" target="_blank"><img src="../images/dp-3300-module-22-lab-25.png" alt="Picture 30"></a></p>
  </li>
  <li>
    <p>In the <strong>Connections</strong> sidebar, fill out the Connection Details section with connection information to connect to the SQL database created in the previous Exercise</p>

    <ul>
      <li>
        <p>Connection Type: <strong>Microsoft SQL Server</strong></p>
      </li>
      <li>
        <p>Server: Enter the name of the SQL Server created in Exercise 2, Task 1. For example: <strong>dp300-lab-xx.database.windows.net</strong><br>
 [Note that you were asked to create a server name with your initials, instead of ‘xx’]</p>
      </li>
      <li>
        <p>Authentication Type: <strong>SQL Login</strong></p>
      </li>
      <li>
        <p>User name: <strong>dp300admin</strong></p>
      </li>
      <li>
        <p>Password: <strong>dp300P@ssword!</strong></p>
      </li>
      <li>
        <p>Expand the Database drop-down to select <strong>AdventureWorksLT.</strong></p>
        <ul>
          <li><strong>NOTE:</strong> You may be asked to add a firewall rule that allows your client IP access to this server. If you are asked to add a firewall rule, click on <strong>Add account</strong> and login to your Azure account. On Create new firewall screen rule screen, click <strong>OK</strong>.</li>
        </ul>

        <p><a href="../images/dp-3300-module-22-lab-26.png" target="_blank"><img src="../images/dp-3300-module-22-lab-26.png" alt="Picture 10"></a></p>
      </li>
    </ul>

    <p>Back on the Connection sidebar, continue filling out the connection details:</p>

    <ul>
      <li>
        <p>Server group will remain on <strong>&lt;default&gt;</strong></p>
      </li>
      <li>
        <p>Name (optional) can be populated with a friendly name of the database, if desired</p>
      </li>
      <li>
        <p>Review settings and click <strong>Connect</strong></p>
      </li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-27.png" target="_blank"><img src="../images/dp-3300-module-22-lab-27.png" alt="A screenshot of a cell phone Description automatically generated"></a></p>
  </li>
  <li>
    <p>Azure Data Studio will connect to the database and show some basic information about the database, plus a partial list of objects</p>

    <p><a href="../images/dp-3300-module-22-lab-28.png" target="_blank"><img src="../images/dp-3300-module-22-lab-28.png" alt="A screenshot of a cell phone Description automatically generated"></a></p>
  </li>
</ol>

<h2 id="task-2-query-azure-sql-database-with-a-sql-notebook">Task 2: Query Azure SQL Database with a SQL Notebook</h2>

<ol>
  <li>
    <p>In Azure Data Studio, connected to this lab’s AdventureWorksLT database, click the <strong>New Notebook</strong> button</p>

    <p><a href="../images/dp-3300-module-22-lab-29.png" target="_blank"><img src="../images/dp-3300-module-22-lab-29.png" alt="Picture 13"></a></p>
  </li>
  <li>
    <p>Click the <strong>+Text</strong> button to add a new text box in the notebook</p>

    <p><a href="../images/dp-3300-module-22-lab-30.png" target="_blank"><img src="../images/dp-3300-module-22-lab-30.png" alt="Picture 14"></a></p>
  </li>
</ol>

<p><strong>Note:</strong> Within the notebook you can embed plain text to explain queries or result sets.</p>

<ol>
  <li>
    <p>Enter the text <strong>Top Ten Customers by Order SubTotal</strong>, making it Bold if desired</p>

    <p><a href="../images/dp-3300-module-22-lab-31.png" target="_blank"><img src="../images/dp-3300-module-22-lab-31.png" alt="A screenshot of a cell phone Description automatically generated"></a></p>
  </li>
  <li>
    <p>Click the <strong>+ Code</strong> button to add a new cell at the end of the notebook to put a query in</p>

    <p><a href="../images/dp-3300-module-22-lab-32.png" target="_blank"><img src="../images/dp-3300-module-22-lab-32.png" alt="Picture 16"></a></p>
  </li>
  <li>
    <p>Paste the following SQL statement into the new cell</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">sql</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock0" class="mt-0"><code class="language-sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> top <span class="hljs-number"><span class="hljs-number">10</span></span> cust.[CustomerID], cust.[CompanyName], <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(sohead.[SubTotal]) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> OverallOrderSubTotal

  <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> [SalesLT].[Customer] cust

    <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> [SalesLT].[SalesOrderHeader] sohead

        <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> sohead.[CustomerID] = cust.[CustomerID]

   <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> cust.[CustomerID], cust.[CompanyName]

   <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> [OverallOrderSubTotal] <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span>
</code></pre>

<ol>
  <li>
    <p>Click on the blue circle with the arrow to execute the query. Note how the results are included within the cell with the query.</p>
  </li>
  <li>
    <p>Click the <strong>+ Text</strong> button to add a new text cell.</p>
  </li>
  <li>
    <p>Enter the text <strong>Top Ten Ordered Product Categories</strong>, making it Bold if desired</p>
  </li>
  <li>
    <p>Click the <strong>+ Code</strong> button again to add a new cell, and paste the following SQL statement into the cell</p>
  </li>
</ol>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">sql</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock1" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock1" class="mt-0"><code class="language-sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> top <span class="hljs-number"><span class="hljs-number">10</span></span> cat.[<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ProductCategory, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(detail.[OrderQty]) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> OrderedQuantity

	<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> salesLT.[ProductCategory] cat

	   <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> saleslt.[Product] prod
      
	      <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> prod.[ProductCategoryID] = cat.[ProductCategoryID]

	   <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> salesLT.[SalesOrderDetail] detail

	      <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> detail.[ProductID] = prod.[ProductID]

	<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> cat.[<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>]

	<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> [OrderedQuantity] <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span>
</code></pre>
<ol>
  <li>
    <p>Click on the blue circle with the arrow to execute the query</p>
  </li>
  <li>
    <p>To run all cells in the notebook and present results, click the <strong>Run Cells</strong> button in the toolbar</p>

    <p><a href="../images/dp-3300-module-22-lab-33.png" target="_blank"><img src="../images/dp-3300-module-22-lab-33.png" alt="Picture 17"></a></p>
  </li>
  <li>
    <p>Within Azure Data Studio save the notebook from File menu (either Save or Save As) to the D:\Labfiles\Deploy Azure SQL Database (this folder already exists on the VM) directory. Close the tab for the Notebook from inside of Azure Data Studio. From the File Menu, select Open File, and open the notebook you just saved. Observe that query results were saved along with the queries in the notebook.</p>
  </li>
</ol>

<h1 id="exercise-4-deploy-an-azure-database-for-postgresql-database">Exercise 4: Deploy an Azure Database for PostgreSQL Database</h1>

<h2 id="task-1-deploy-a-postgresql-database">Task 1: Deploy a PostgreSQL Database</h2>

<ol>
  <li>
    <p>From the Azure Portal, click on <strong>+ Create a Resource</strong> at the top of the left side navigation bar</p>

    <p><a href="../images/dp-3300-module-22-lab-34.png" target="_blank"><img src="../images/dp-3300-module-22-lab-34.png" alt="Picture 14"></a></p>
  </li>
  <li>
    <p>Search for “Azure Database for PostgreSQL” in the search box at the top, then click <strong>Azure Database for PostgreSQL</strong> in the results</p>

    <p><a href="../images/dp-3300-module-22-lab-35.png" target="_blank"><img src="../images/dp-3300-module-22-lab-35.png" alt="Picture 43"></a></p>
  </li>
  <li>
    <p>Click the <strong>Create</strong> button</p>
  </li>
  <li>
    <p>Click <strong>Create</strong> for the Single Server option</p>

    <p><a href="../images/dp-3300-module-22-lab-36.png" target="_blank"><img src="../images/dp-3300-module-22-lab-36.png" alt="Picture 45"></a></p>
  </li>
  <li>
    <p>Complete the Single Server Basics screen with the following inputs:</p>

    <ul>
      <li>
        <p>Subscription: Select the lab subscription</p>
      </li>
      <li>
        <p>Resource Group: <strong>DP-300-Lab02</strong> (the RG created in Exercise 1)</p>
      </li>
      <li>
        <p>Server Name: <strong>dp300-lab02-</strong><strong>&lt;your initials&gt;</strong> (server name must be unique)</p>
      </li>
      <li>
        <p>Data source: <strong>None</strong></p>
      </li>
      <li>
        <p>Location: Select the Region closest to you, which has been used throughout this lab</p>
      </li>
      <li>
        <p>Version: <strong>10</strong> or <strong>11</strong></p>
      </li>
      <li>
        <p>Click the <strong>Configure Server</strong> link under Compute + Storage</p>

        <ul>
          <li>
            <p>Click the <strong>Basic</strong> tab</p>
          </li>
          <li>
            <p>Slide the vCore slider all the way to the left to select <strong>1 vCore</strong></p>
          </li>
        </ul>
      </li>
    </ul>

    <p><a href="../images/dp-3300-module-22-lab-37.png" target="_blank"><img src="../images/dp-3300-module-22-lab-37.png" alt="Picture 46"></a></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock2" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock2" class="mt-0"><code class="hljs markdown"> - Click <span class="hljs-strong"><span class="hljs-strong">**OK**</span></span>
</code></pre>

    <ul>
      <li>
        <p>Admin username: <strong>dp300admin</strong></p>
      </li>
      <li>
        <p>Password: <strong>dp300P@ssword!</strong></p>
      </li>
      <li>
        <p>Confirm password: <strong>dp300P@ssword!</strong><br>
 <a href="../images/dp-3300-module-22-lab-38.png" target="_blank"><img src="../images/dp-3300-module-22-lab-38.png" alt="Picture 1"></a></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Click <strong>Review + Create</strong></p>
  </li>
  <li>
    <p>Review the settings and click <strong>Create</strong></p>
  </li>
  <li>
    <p>When the deployment is complete, click <strong>Go to resource</strong></p>
  </li>
</ol>

<h2 id="task-2-enable-all-azure-services-access-to-postgresql-database">Task 2: Enable All Azure Services Access to PostgreSQL Database</h2>

<ol>
  <li>
    <p>Click on the <strong>Connection security</strong> button under Settings in the database’s sidebar</p>

    <p><a href="../images/dp-3300-module-22-lab-39.png" target="_blank"><img src="../images/dp-3300-module-22-lab-39.png" alt="Picture 49"></a></p>
  </li>
  <li>
    <p>Slide the Allow access to Azure services setting to <strong>Yes</strong>.  Click <strong>+ Add client IP</strong>, then <strong>Save</strong>.</p>

    <p><a href="../images/dp-3300-module-22-lab-40.png" target="_blank"><img src="../images/dp-3300-module-22-lab-40.png" alt="Picture 50"></a></p>
  </li>
  <li>
    <p>After saving, click on the <strong>Add client IP</strong> button again at the top right to add your client IP to the firewall.</p>

    <p><a href="../images/dp-3300-module-22-lab-44.png" target="_blank"><img src="../images/dp-3300-module-22-lab-44.png" alt="Picture 44"></a></p>
  </li>
  <li>
    <p>Click <strong>Save</strong> at the top left.</p>
  </li>
</ol>

<h2 id="task-3-connect-to-the-postgresql-database-with-azure-data-studio">Task 3: Connect to the PostgreSQL Database with Azure Data Studio</h2>

<p><strong>Note:</strong> With the PostgreSQL extension installed to Azure Data Studio, PostgreSQL can be queried. This extension is pre-installed on the lab VM.</p>

<ol>
  <li>
    <p>In Azure Data Studio on the lab VM, ensure the Connections sidebar is expanded—Click the <strong>Connections</strong> button in the left nav bar, if not.</p>
  </li>
  <li>
    <p>Click the <strong>New Connection</strong> button</p>

    <p><a href="../images/dp-3300-module-22-lab-41.png" target="_blank"><img src="../images/dp-3300-module-22-lab-41.png" alt="Picture 47"></a></p>
  </li>
  <li>
    <p>In the Connection Details sidebar, enter the following information to connect to the previous Task’s PostgreSQL database:</p>

    <ul>
      <li>
        <p>Connection Type: <strong>PostgreSQL</strong></p>
      </li>
      <li>
        <p>Server: Enter the name of the PostgreSQL Server you created in Task 1. For example: <strong>dp300-lab02-xx.postgres.database.azure.com</strong> (You can find the full name of the server in the Overview pane in the portal. You’ll probably need to replace xx with the specific letters you added. )</p>
      </li>
      <li>
        <p>Authentication Type: <strong>Password</strong></p>
      </li>
      <li>
        <p>User name: <strong>dp300admin@dp300-lab02-xx</strong> (note that the user name must include the first part of the hostname that you specified above; use your suffix instead of ‘xx’. The admin username can also be found on the Overview pane in the portal.)</p>
      </li>
      <li>
        <p>Password: <strong>dp300P@ssword!</strong></p>
      </li>
      <li>
        <p>Database Name will remain on <strong>&lt;default&gt;</strong></p>
      </li>
      <li>
        <p>Server group will remain on <strong>&lt;default&gt;</strong></p>
      </li>
      <li>
        <p>Name (optional) can be populated with a friendly name of the database, if desired</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Review settings</p>

    <p><a href="../images/dp-3300-module-22-lab-42.png" target="_blank"><img src="../images/dp-3300-module-22-lab-42.png" alt="Picture 48"></a></p>
  </li>
  <li>
    <p>Click <strong>Connect</strong></p>
  </li>
  <li>
    <p>Note Azure Data Studio’s connection to the PostgreSQL database</p>

    <p><a href="../images/dp-3300-module-22-lab-43.png" target="_blank"><img src="../images/dp-3300-module-22-lab-43.png" alt="Picture 52"></a></p>
  </li>
</ol>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/DP-300T00-Administering-Relational-Databases-on-Azure" target="_blank" class="ml-2">
                    MicrosoftLearning/DP-300T00-Administering-Relational-Databases-on-Azure
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D525e69932921e8ce30e81ee0f98ad4a87cda64ea.js"></script>



</body></html>