<!DOCTYPE html><html lang="en"><head>
        <title>
            AI-102-AIEngineer
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../assets/css/style_v%3D.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../">
                AI-102-AIEngineer
            </a>
            <a href="https://github.com/MicrosoftLearning/AI-102-AIEngineer" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#update-the-bot-framework-emulator">Update the Bot Framework Emulator</a></li><li class="nav-item"><a class="nav-link" href="#clone-the-repository-for-this-course">Clone the repository for this course</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="create-a-bot-with-the-bot-framework-sdk">Create a Bot with the Bot Framework SDK</h1>

<p><em>Bots</em> are software agents that can participate in conversational dialogs with human users. The Microsoft Bot Framework provides a comprehensive platform for building bots that can be delivered as cloud services through the Azure Bot Service.</p>

<p>In this exercise, you’ll use the Microsoft Bot Framework SDK to create and deploy a bot.</p>

<h2 id="before-you-start">Before you start</h2>

<p>Let’s start by preparing the environment for bot development.</p>

<h3 id="update-the-bot-framework-emulator">Update the Bot Framework Emulator</h3>

<p>You’re going to use the Bot Framework SDK to create your bot, and the Bot Framework Emulator to test it. The Bot Framework Emulator is updated regularly, so let’s make sure you have the latest version installed.</p>

<blockquote>
  <p><strong>Note</strong>: Updates may include changes to the user interface that affect the instructions in this exercise.</p>
</blockquote>

<ol>
  <li>Start the <strong>Bot Framework Emulator</strong>, and if you are prompted to install an update, do so for the currently logged in user. If you are not prompted automatically, use the <strong>Check for update</strong> option on the <strong>Help</strong> menu to check for updates.</li>
  <li>After installing any available update, close the Bot Framework Emulator until you need it again later.</li>
</ol>

<h3 id="clone-the-repository-for-this-course">Clone the repository for this course</h3>

<p>If you have not already cloned <strong>AI-102-AIEngineer</strong> code repository to the environment where you’re working on this lab, follow these steps to do so. Otherwise, open the cloned folder in Visual Studio Code.</p>

<ol>
  <li>Start Visual Studio Code.</li>
  <li>Open the palette (SHIFT+CTRL+P) and run a <strong>Git: Clone</strong> command to clone the <code>https://github.com/MicrosoftLearning/AI-102-AIEngineer</code> repository to a local folder (it doesn’t matter which folder).</li>
  <li>When the repository has been cloned, open the folder in Visual Studio Code.</li>
  <li>
    <p>Wait while additional files are installed to support the C# code projects in the repo.</p>

    <blockquote>
      <p><strong>Note</strong>: If you are prompted to add required assets to build and debug, select <strong>Not Now</strong>.</p>
    </blockquote>
  </li>
</ol>

<h2 id="create-a-bot">Create a bot</h2>

<p>You can use the Bot Framework SDK to create a bot based on a template, and then customize the code to meet your specific requirements.</p>

<blockquote>
  <p><strong>Note</strong>: In this exercise, you can choose to use either <strong>C#</strong> or <strong>Python</strong>. In the steps below, perform the actions appropriate for your preferred language.</p>
</blockquote>

<ol>
  <li>In Visual Studio Code, in the <strong>Explorer</strong> pane, browse to the <strong>13-bot-framework</strong> folder and expand the <strong>C-Sharp</strong> or <strong>Python</strong> folder depending on your language preference.</li>
  <li>Right-click the folder for your chosen language and open an integrated terminal.</li>
  <li>In the terminal, run the following commands to install the bot templates and packages you need:</li>
</ol>

<p><strong>C#</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock0" class="mt-0"><code class="language-C# hljs">dotnet <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> -i Microsoft.Bot.Framework.CSharp.EchoBot
dotnet <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> -i Microsoft.Bot.Framework.CSharp.CoreBot
dotnet <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> -i Microsoft.Bot.Framework.CSharp.EmptyBot
</code></pre>

<p><strong>Python</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock1" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock1" class="mt-0"><code class="language-Python hljs">pip install botbuilder-core
pip install asyncio
pip install aiohttp
pip install cookiecutter==<span class="hljs-number"><span class="hljs-number">1.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>
</code></pre>

<ol>
  <li>After the templates and packages have been installed, run the following command to create a bot based on the <em>EchoBot</em> template:</li>
</ol>

<p><strong>C#</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock2" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock2" class="mt-0"><code class="language-C# hljs">dotnet <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> echobot -n TimeBot
</code></pre>

<p><strong>Python</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock3" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock3" class="mt-0"><code class="language-Python hljs">cookiecutter https://github.com/microsoft/botbuilder-python/releases/download/Templates/echo.zip
</code></pre>

<p>If you’re using Python, when prompted by cookiecutter, enter the following details:</p>
<ul>
  <li><strong>bot_name</strong>: TimeBot</li>
  <li><strong>bot_description</strong>: A bot for our times</li>
</ul>

<ol>
  <li>
    <p>In the terminal pane, enter the following commands to change the current directory to the <strong>TimeBot</strong> folder list the code files that have been generated for your bot:</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock4" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock4" class="mt-0"><code class="language-Code"> cd TimeBot
 dir
</code></pre>
  </li>
</ol>

<h2 id="test-the-bot-in-the-bot-framework-emulator">Test the bot in the Bot Framework Emulator</h2>

<p>You’ve created a bot based on the <em>EchoBot</em> template. Now you can run it locally and test it by using the Bot Framework Emulator (which should be installed on your system).</p>

<ol>
  <li>In the terminal pane, ensure that the current directory is the <strong>TimeBot</strong> folder containing your bot code files, and then enter the following command to start your bot running locally.</li>
</ol>

<p><strong>C#</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock5" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock5" class="mt-0"><code class="language-C# hljs">dotnet run
</code></pre>

<p><strong>Python</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock6" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock6" class="mt-0"><code class="language-Python hljs">python app.py
</code></pre>

<p>When the bot starts, note the endpoint at which it is running is shown. This should be similar to <strong>http://localhost:3978</strong>.</p>

<ol>
  <li>
    <p>Start the Bot Framework Emulator, and open your bot by specifying the endpoint with the <strong>/api/messages</strong> path appended, like this:</p>

    <p><code>http://localhost:3978/api/messages</code></p>
  </li>
  <li>After the conversation is opened in a <strong>Live chat</strong> pane, wait for the message <em>Hello and welcome!</em>.</li>
  <li>Enter a message such as <em>Hello</em> and view the response from the bot, which should echo back the message you entered.</li>
  <li>Close the Bot Framework Emulator and return to Visual Studio Code, then in the terminal window, enter <strong>CTRL+C</strong> to stop the bot.</li>
</ol>

<h2 id="modify-the-bot-code">Modify the bot code</h2>

<p>You’ve created a bot that echoes the user’s input back to them. It’s not particularly useful, but serves to illustrate the basic flow of a conversational dialog. A conversation with a bot consists of a sequence of <em>activities</em>, in which text, graphics, or user interface <em>cards</em> are used to exchange information. The bot begins the conversation with a greeting, which is the result of a <em>conversation update</em> activity that is triggered when a user initializes a chat session with the bot. Then the conversation consists of a sequence of further activities in which the user and bot take it in turns to send <em>messages</em>.</p>

<ol>
  <li>In Visual Studio Code, open the following code file for your bot:
    <ul>
      <li><strong>C#</strong>: TimeBot/Bots/EchoBot.cs</li>
      <li><strong>Python</strong>: TimeBot/bot.py</li>
    </ul>

    <p>Note that the code in this file consists of <em>activity handler</em> functions; one for the <em>Member Added</em> conversation update activity (when someone joins the chat session) and another for the <em>Message</em> activity (when a message is received). The conversation is based on the concept of <em>turns</em>, in which each turn represents an interaction in which the bot receives, processes, and responds to an activity. The <em>turn context</em> is used to track information about the activity being processed in the current turn.</p>
  </li>
  <li>At the top of the code file, add the following namespace import statement:</li>
</ol>

<p><strong>C#</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock7" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock7" class="mt-0"><code class="language-C# hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System;
</code></pre>

<p><strong>Python</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock8" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock8" class="mt-0"><code class="language-Python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime
</code></pre>

<ol>
  <li>Modify the activity handler function for the <em>Message</em> activity to match the following code:</li>
</ol>

<p><strong>C#</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock9" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock9" class="mt-0"><code class="language-C# hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> override async Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMessageActivityAsync</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ITurnContext&lt;IMessageActivity&gt; turnContext, CancellationToken cancellationToken)</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> inputMessage = turnContext.Activity.Text;
    <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> responseMessage = <span class="hljs-string"><span class="hljs-string">"Ask me what the time is."</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputMessage.ToLower().StartsWith(<span class="hljs-string"><span class="hljs-string">"what"</span></span>) &amp;&amp; inputMessage.ToLower().Contains(<span class="hljs-string"><span class="hljs-string">"time"</span></span>))
    {
        var now = DateTime.Now;
        responseMessage = <span class="hljs-string"><span class="hljs-string">"The time is "</span></span> + now.Hour.ToString() + <span class="hljs-string"><span class="hljs-string">":"</span></span> + now.Minute.ToString(<span class="hljs-string"><span class="hljs-string">"D2"</span></span>);
    }
    await turnContext.SendActivityAsync(MessageFactory.Text(responseMessage, responseMessage), cancellationToken);
}
</code></pre>

<p><strong>Python</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock10" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock10" class="mt-0"><code class="language-Python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_message_activity</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, turn_context: TurnContext)</span></span></span><span class="hljs-function">:</span></span>
    input_message = turn_context.activity.text
    response_message = <span class="hljs-string"><span class="hljs-string">'Ask me what the time is.'</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input_message.lower().startswith(<span class="hljs-string"><span class="hljs-string">'what'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'time'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> input_message.lower()):
        now = datetime.now()
        response_message = <span class="hljs-string"><span class="hljs-string">'The time is {}:{:02d}.'</span></span>.format(now.hour,now.minute)
    <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> turn_context.send_activity(response_message)
</code></pre>

<ol>
  <li>Save your changes, and then in the terminal pane, ensure that the current directory is the <strong>TimeBot</strong> folder containing your bot code files, and then enter the following command to start your bot running locally.</li>
</ol>

<p><strong>C#</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock11" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock11" class="mt-0"><code class="language-C# hljs">dotnet run
</code></pre>

<p><strong>Python</strong></p>

<div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock12" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock12" class="mt-0"><code class="language-Python hljs">python app.py
</code></pre>

<p>As before, when the bot starts, note the endpoint at which it is running is shown.</p>

<ol>
  <li>
    <p>Start the Bot Framework Emulator, and open your bot by specifying the endpoint with the <strong>/api/messages</strong> path appended, like this:</p>

    <p><code>http://localhost:3978/api/messages</code></p>
  </li>
  <li>After the conversation is opened in a <strong>Live chat</strong> pane, wait for the message <em>Hello and welcome!</em>.</li>
  <li>Enter a message such as <em>Hello</em> and view the response from the bot, which should be <em>Ask me what the time is</em>.</li>
  <li>
    <p>Enter <em>What is the time?</em> and view the response.</p>

    <p>The bot now responds to the query “What is the time?” by displaying the local time where the bot is running. For any other query, it prompts the user to ask it what the time is. This is a very limited bot, which could be improved through integration with the Language Understanding service and additional custom code, but it serves as a working example of how you can build a solution with the Bot Framework SDK by extending a bot created from a template.</p>
  </li>
  <li>Close the Bot Framework Emulator and return to Visual Studio Code, then in the terminal window, enter <strong>CTRL+C</strong> to stop the bot.</li>
</ol>

<h2 id="more-information">More information</h2>

<p>To learn more about the Bot Framework, view the <a href="https://docs.microsoft.com/azure/bot-service/index-bf-sdk">Bot Framework documentation</a>.</p>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/AI-102-AIEngineer" target="_blank" class="ml-2">
                    MicrosoftLearning/AI-102-AIEngineer
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../assets/js/script_v%3D.js"></script>



</body></html>