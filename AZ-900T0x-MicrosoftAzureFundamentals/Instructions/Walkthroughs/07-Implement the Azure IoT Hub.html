<!DOCTYPE html><html lang="en"><head>
        <title>
            AZ-900T0x-MicrosoftAzureFundamentals
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                AZ-900T0x-MicrosoftAzureFundamentals
            </a>
            <a href="https://github.com/MicrosoftLearning/AZ-900T0x-MicrosoftAzureFundamentals" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    </ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="07---implement-an-azure-iot-hub-10-min">07 - Implement an Azure IoT Hub (10 min)</h1>

<p>In this walkthrough, we will configure a new Azure IoT Hub in Azure Portal, and then authenticate a connection to an IoT device using the online Raspberry Pi device simulator. Sensor data and messages are passed from the Raspberry Pi simulator to your Azure IoT Hub, and you view metrics for the messaging activity in Azure Portal.</p>

<h1 id="task-1-create-an-iot-hub">Task 1: Create an IoT hub</h1>

<p>In this task, we will create an IoT hub.</p>

<ol>
  <li>
    <p>Sign in to the <a href="https://portal.azure.com">Azure portal</a>.</p>
  </li>
  <li>
    <p>From the <strong>All services</strong> blade, search for and select <strong>IoT Hub</strong> and then click <strong>+ Add, + Create, + New</strong>.</p>
  </li>
  <li>
    <p>On the <strong>Basics</strong> tab of the <strong>IoT hub</strong> blade, fill in the fields with the following details (replace <strong>xxxx</strong> in the name of the storage account with letters and digits such that the name is globally unique):</p>

    <table>
      <thead>
        <tr>
          <th>Settings</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Subscription</td>
          <td><strong>Keep default supplied</strong></td>
        </tr>
        <tr>
          <td>Resource Group</td>
          <td><strong>Create new resource group</strong></td>
        </tr>
        <tr>
          <td>IoT Hub Name</td>
          <td><strong>my-hub-groupxxxxx</strong></td>
        </tr>
        <tr>
          <td>Region</td>
          <td><strong>East US</strong></td>
        </tr>
      </tbody>
    </table>

    <p><strong>Note</strong> - Remember to change the <strong>xxxxx</strong> so that it makes a unique <strong>IoT Hub Name</strong>.</p>
  </li>
  <li>
    <p>Go to the <strong>Management</strong> tab, and use the dropdown to set the <strong>Pricing and scale tier</strong> to <strong>S1: Standard tier</strong>.</p>
  </li>
  <li>
    <p>Click the <strong>Review + create</strong> button.</p>
  </li>
  <li>
    <p>Click the <strong>Create</strong> button to begin creating your new Azure IoT Hub instance.</p>
  </li>
  <li>
    <p>Wait until the Azure IoT Hub instance is deployed.</p>
  </li>
</ol>

<h1 id="task-2-add-an-iot-device">Task 2: Add an IoT device</h1>

<p>In this task, we will add an IoT device to the IoT hub.</p>

<ol>
  <li>
    <p>When the deployment has completed, click <strong>Go to resource</strong> from the deployment blade. Alternatively, from the <strong>All services</strong> blade, search for and select <strong>IoT Hub</strong> and locate your new IoT Hub instance</p>

    <p><a href="../images/0601.png" target="_blank"><img src="../images/0601.png" alt="Screenshot of the deployment in progress and deployment succeeded notifications in Azure portal."></a></p>
  </li>
  <li>
    <p>To add a new IoT device, scroll down to the <strong>Device management</strong> section and click <strong>Devices</strong>. Then, click <strong>+ Add Device</strong>.</p>

    <p><a href="../images/0602.png" target="_blank"><img src="../images/0602.png" alt="Screenshot of the IoT devices pane, highlighted within the IoT hub navigation blade, in Azure portal. The New button is highlighted to illustrate how to add a new IoT device identity to IoT hub."></a></p>
  </li>
  <li>
    <p>Provide a name for your new IoT device, <strong>myRaspberryPi</strong>, and click the <strong>Save</strong> button. This will create a new IoT device identity in your Azure IoT Hub.</p>
  </li>
  <li>
    <p>If you do not see your new device, <strong>Refresh</strong> the IoT Devices page.</p>
  </li>
  <li>
    <p>Select <strong>myRaspberryPi</strong> and copy the <strong>Primary Connection String</strong> value. You will use this key in the next task to authenticate a connection to the Raspberry Pi simulator.</p>

    <p><a href="../images/0603.png" target="_blank"><img src="../images/0603.png" alt="Screenshot of the Primary Connection String page with the copy icon highlighted."></a></p>
  </li>
</ol>

<h1 id="task-3-test-the-device-using-a-raspberry-pi-simulator">Task 3: Test the device using a Raspberry Pi Simulator</h1>

<p>In this task, we will test our device using the Raspberry Pi Simulator.</p>

<ol>
  <li>
    <p>Open a new tab in the web browser and type this shortcut link https://aka.ms/RaspPi. It will take you to a Raspberry Pi Simulator site. If you have time, read about the Raspberry Pi simulator. When done select “<strong>X</strong>” to close the pop-up window.</p>
  </li>
  <li>
    <p>In the code area on the right side, locate the line with ‘const connectionString =’. Replace it with the connection string you copied from the Azure portal. Note that the connection sting includes the DeviceId (<strong>myRaspberryPi</strong>) and SharedAccessKey entries.</p>

    <p><a href="../images/0604.png" target="_blank"><img src="../images/0604.png" alt="Screenshot of the coding area within the Raspberry Pi simulator."></a></p>
  </li>
  <li>
    <p>Click <strong>Run</strong> (below the code area) to run the application. The console output should show the sensor data and messages that are sent from the Raspberry Pi simulator to your Azure IoT Hub. Data and messages are sent each time the Raspberry Pi simulator LED flashes.</p>

    <p><a href="../images/0605.png" target="_blank"><img src="../images/0605.png" alt="Screenshot of the Raspberry Pi simulator console.  The console output shows sensor data and messages sent from the Raspberry Pi simulator to Azure IoT Hub."></a></p>
  </li>
  <li>
    <p>Click <strong>Stop</strong> to stop sending data.</p>
  </li>
  <li>
    <p>Return to the Azure portal.</p>
  </li>
  <li>
    <p>Switch the IoT Hub <strong>Overview</strong> blade and scroll down to the <strong>IoT Hub Usage</strong> information to view usage. Change your timeframe in the <strong>show data for last</strong> to see data in the last hour.</p>

    <p><a href="../images/0606.png" target="_blank"><img src="../images/0606.png" alt="Screenshot of metrics within the IoT hub usage area of Azure portal."></a></p>
  </li>
</ol>

<p>Congratulations! You have set up Azure IoT Hub to collect sensor data from an IoT device.</p>

<p><strong>Note</strong>: To avoid additional costs, you can optionally remove this resource group. Search for resource groups, click your resource group, and then click <strong>Delete resource group</strong>. Verify the name of the resource group and then click <strong>Delete</strong>. Monitor the <strong>Notifications</strong> to see how the delete is proceeding.</p>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/AZ-900T0x-MicrosoftAzureFundamentals" target="_blank" class="ml-2">
                    MicrosoftLearning/AZ-900T0x-MicrosoftAzureFundamentals
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D.js"></script>



</body></html>