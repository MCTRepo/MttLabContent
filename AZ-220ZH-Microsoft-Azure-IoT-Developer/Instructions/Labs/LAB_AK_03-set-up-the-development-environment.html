<!DOCTYPE html><html lang="en"><head>
        <title>
            AZ-220ZH-Microsoft-Azure-IoT-Developer
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="../../assets/css/style_v%3D653337691cd169b6aa5719d4ea66f4e6a878a19c.css">
    </head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="../../">
                AZ-220ZH-Microsoft-Azure-IoT-Developer
            </a>
            <a href="https://github.com/MicrosoftLearning/AZ-220ZH-Microsoft-Azure-IoT-Developer" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="#练习-1安装开发工具和产品">练习 1：安装开发工具和产品</a></li><li class="nav-item"><a class="nav-link" href="#练习-2安装开发工具扩展">练习 2：安装开发工具扩展</a></li><li class="nav-item"><a class="nav-link" href="#练习-3设置课程实验室文件和替代工具">练习 3：设置课程实验室文件和替代工具</a></li><li class="nav-item"><a class="nav-link" href="#练习-3---注册资源提供程序">练习 3 - 注册资源提供程序</a></li></ul>
                </nav>         
            </aside>
            <hr class>
            <article class="col-sm-10 mb-5">
                <h1 id="设置开发环境">设置开发环境</h1>

<h2 id="实验室场景">实验室场景</h2>

<p>作为 Contoso 的开发人员之一，你知道在开始构建 Azure IoT 解决方案之前设置开发环境是重要的一步。你还知道 Microsoft 和其他公司提供了许多工具可用于开发和支持你的 IoT 解决方案，而且应做出一些决策来决定你的团队将使用哪些工具。</p>

<p>你决定准备一个开发环境，团队可以使用它来处理你的 IoT 解决方案。该环境将需要支持你在 Azure 和本地电脑上的工作。经过一番讨论，你的团队对开发环境做出了以下高层决策：</p>

<ul>
  <li>操作系统：Windows 10 将用作操作系统。大多数团队成员都使用 Windows，因此这是一个合理的选择。你向团队说明 Azure 服务支持其他操作系统（如 Mac OS 和 Linux），并且 Microsoft 为选择这些备选方案之一的团队成员提供支持文档。</li>
  <li>一般编码工具：Visual Studio Code 和 Azure CLI 将作为主要的编码工具。这两种工具均支持利用 Azure IoT SDK 的 IoT 扩展。</li>
  <li>IoT Edge 工具：Docker Desktop Community 和 Python 将用于支持自定义 IoT Edge 模块开发（连同 Visual Studio Code 一起）。</li>
</ul>

<p>为了支持这些决定，你将设置以下环境：</p>

<ul>
  <li>Windows 10 64 位：专业版、企业版或教育版（版本15063 或更新版本）。包括
    <ul>
      <li>4GB – 8GB 系统 RAM（对于Docker，RAM 越高越好）</li>
      <li>必须启用 Windows 的 Hyper-V 和容器功能。</li>
      <li>必须在 BIOS 设置中启用 BIOS 级硬件虚拟化支持。</li>
    </ul>

    <blockquote>
      <p><strong>备注</strong>： 在虚拟机上设置开发环境时，VM 环境必须支持嵌套虚拟化 - <a href="https://docs.microsoft.com/zh-cn/virtualization/hyper-v-on-windows/user-guide/nested-virtualization">嵌套虚拟化</a></p>
    </blockquote>
  </li>
  <li>Azure CLI（当前/最新）</li>
  <li>.NET Core 3.1.200（或更高版本）SDK</li>
  <li>VS 代码（最新）</li>
  <li>Python 3.9</li>
  <li>Docker Desktop Community 2.1.0.5（或更高版本）设置为 Linux 容器</li>
  <li>VS Code 和 Azure CLI 的 IoT 扩展</li>
  <li>node.js（最新）</li>
</ul>

<blockquote>
  <p><strong>备注</strong>： 为此课程创建了一个虚拟机，该虚拟机提供了上面指定的大多数工具。以下说明支持使用准备好的 VM 或使用 PC 在本地设置开发环境。</p>
</blockquote>

<h2 id="本实验室概览">本实验室概览</h2>

<p>在本实验室中，你将为开发环境设置基础开发工具，安装适用于 Visual Studio Code 和 Azure CLI 的 Azure IoT 扩展，然后从 GitHub 下载一些你将在实验室中使用的文件。本实验室包括以下练习：</p>

<ul>
  <li>安装开发工具和产品</li>
  <li>安装开发工具扩展</li>
  <li>设置课程实验室文件和替代工具</li>
</ul>

<h2 id="实验室说明">实验室说明</h2>

<h3 id="练习-1安装开发工具和产品">练习 1：安装开发工具和产品</h3>

<blockquote>
  <p><strong>重要说明</strong>： 与本练习相关的工具和产品已预先安装在为此课程创建的虚拟机上。在继续之前，请咨询你的课程讲师，了解你是否要使用托管实验室 VM 环境完成实验，或者在电脑上本地设置开发环境。</p>
</blockquote>

<h4 id="任务-1安装-net-core">任务 1：安装 .NET Core</h4>

<p>.NET Core 是 .NET 的跨平台版本，用于生成网站、服务和控制台应用。</p>

<ol>
  <li>
    <p>要打开 .NET Core 下载页面，请使用以下链接：<a href="https://dotnet.microsoft.com/download">.NET 下载</a></p>
  </li>
  <li>
    <p>在 .NET 下载页面上的 .NET Core 下，单击 <strong>“下载 .NET Core SDK”</strong>。</p>

    <p>.NET Core SDK 用于生成 .NET Core 应用。在本课程的实验室中，你将使用它来生成/编辑代码文件。</p>
  </li>
  <li>
    <p>在弹出菜单上，单击 <strong>“运行”</strong>，然后按照屏幕上的说明完成安装。</p>

    <p>安装时间应该不超过一分钟。将安装以下组件：</p>

    <ul>
      <li>.NET Core SDK 3.1.100 或更高版本</li>
      <li>.NET Core 运行时 3.1.100 或更高版本</li>
      <li>ASP.NET Core 运行时 3.1.100 或更高版本</li>
      <li>.NET Core Windows 桌面运行时 3.1.0 或更高版本</li>
    </ul>

    <p>以下资源可用于获取更多信息：</p>

    <ul>
      <li><a href="https://aka.ms/dotnet-docs-chs">.NET Core 文档</a></li>
      <li><a href="https://docs.microsoft.com/zh-cn/dotnet/core/install/dependencies?tabs=netcore31&amp;pivots=os-windows">.NET Core 依赖性和要求</a></li>
      <li><a href="https://aka.ms/dotnet-sdk-docs-chs">SDK 文档</a></li>
      <li><a href="https://aka.ms/netcore3releasenotes">发行说明</a></li>
      <li><a href="https://aka.ms/dotnet-tutorials-chs">教程</a></li>
    </ul>
  </li>
</ol>

<h4 id="任务-2安装-visual-studio-code">任务 2：安装 Visual Studio Code</h4>

<p>Visual Studio Code 是一种在桌面上运行的轻型但功能强大的源代码编辑器，适用于 Windows、macOS 和 Linux。它内置了对 JavaScript、TypeScript 和 Node.js 的支持，并且具有丰富的扩展生态系统，可用于其他语言（如 C++、C#、Java、Python、PHP、Go）和运行时间（如 .NET 和 Unity）。</p>

<ol>
  <li>
    <p>要打开 Visual Studio Code 下载页面，请单击以下链接：<a href="https://code.visualstudio.com/Download">下载 Visual Studio Code</a></p>

    <p>可在<a href="https://code.visualstudio.com/docs/setup/setup-overview">此处</a>的 Visual Studio Code 设置指南中找到在 Mac OS X 和 Linux 上安装 Visual Studio Code 的说明。此页面还包括 Windows 安装的更多详细说明和技巧。</p>
  </li>
  <li>
    <p>在“下载 Visual Studio Code”页面上，单击 <strong>“Windows”</strong>。</p>

    <p>开始下载时，将发生两件事：打开一个弹出对话框，并显示一些入门指南。</p>
  </li>
  <li>
    <p>在弹出对话框中，要开始设置过程，请单击 <strong>“运行”</strong>，然后按照屏幕上的说明进行操作。</p>

    <p>如果选择将安装程序保存到 Downloads 文件夹中，可打开该文件夹，然后双击 VSCodeSetup 可执行文件来完成安装。</p>

    <p>Visual Studio Code 默认安装在“C:\Program Files (x86)\Microsoft VS Code”文件夹位置（对于 64 位计算机而言）。设置过程应该只需要一分钟。</p>

    <blockquote>
      <p><strong>备注</strong>： 在 Windows 上安装时，Visual Studio Code 需要 .NET Framework 4.5。如果你使用 Windows 7，请确保已安装 <a href="https://www.microsoft.com/zh-cn/download/details.aspx?id=30653">.NET Framework 4.5</a>。</p>
    </blockquote>

    <p>有关安装 Visual Studio Code 的详细说明，请参见以下网站上的《Microsoft Visual Studio Code 安装说明》指南：<a href="https://code.visualstudio.com/Docs/editor/setup">https://code.visualstudio.com/Docs/editor/setup</a></p>
  </li>
</ol>

<h4 id="任务-3安装-azure-cli">任务 3：安装 Azure CLI</h4>

<p>Azure CLI 是一种命令行工具，旨在简化 Azure 相关任务的脚本编写。它还使你能够灵活地查询数据，并支持长时间运行的操作作为非阻塞过程。</p>

<ol>
  <li>
    <p>打开浏览器，然后导航到 Azure CLI 工具下载页面：<a href="https://docs.microsoft.com/zh-cn/cli/azure/install-azure-cli?view=azure-cli-latest" title="Azure CLI Install">安装 Azure CLI</a></p>

    <p>你应该安装最新版本的 Azure CLI 工具（当前版本 2.4）。如果 2.4 版本不是此“azure-cli-latest”下载页面上列出的最新版本，请安装最新版本。</p>
  </li>
  <li>
    <p>在 <strong>“安装 Azure CLI”</strong> 页面上，为 OS 选择安装选项（例如“在 Windows 上安装”），然后按照屏幕上的说明安装 Azure CLI 工具。</p>

    <p>我们将在本课程的实验室中提供有关使用 Azure CLI 工具的详细说明，但是如果你现在想要更多信息，请参阅 <a href="https://docs.microsoft.com/zh-cn/cli/azure/get-started-with-azure-cli?view=azure-cli-latest">Azure CLI 入门</a></p>
  </li>
</ol>

<h4 id="任务-4安装-python-39">任务 4：安装 Python 3.9</h4>

<p>你将使用 Python 3.9 以便支持 IoT Edge 和 Docker。</p>

<ol>
  <li>
    <p>在 Web 浏览器中，导航至 <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></p>
  </li>
  <li>
    <p>在 Python 下载页面，选择适合你的操作系统的安装程序文件。</p>
  </li>
  <li>
    <p>出现提示时，选择该选项以运行安装程序</p>
  </li>
  <li>
    <p>在“安装 Python”对话框中，单击 <strong>“将 Python 3.9 添加到 PATH”</strong>。</p>
  </li>
  <li>
    <p>单击 <strong>“立即安装”</strong>。</p>
  </li>
  <li>
    <p>出现“安装成功”页面时，单击 <strong>“禁用路径长度限制”</strong>。</p>
  </li>
  <li>
    <p>要完成安装过程，请单击 <strong>“关闭”</strong>。</p>
  </li>
</ol>

<h4 id="任务-5安装-docker-桌面">任务 5：安装 Docker 桌面</h4>

<p>你将在涵盖自定义 IoT Edge 模块的创建和部署操作的实验室中使用 Docker Desktop Community（最新稳定版本）。</p>

<ol>
  <li>
    <p>在 Web 浏览器中，导航至 <a href="https://docs.docker.com/docker-for-windows/install/">https://docs.docker.com/docker-for-windows/install/</a></p>

    <p>左侧导航菜单提供对其他操作系统的安装的访问。</p>
  </li>
  <li>
    <p>确认你的 PC 符合系统要求。</p>

    <p>你可以使用 Windows 设置打开“Windows 功能”对话框，并使用它来验证是否启用了 Hyper-V 和容器。</p>
  </li>
  <li>
    <p>单击 <strong>“从 Docker Hub 下载”</strong></p>
  </li>
  <li>
    <p>在适用于 Windows 的 Docker 桌面下，单击 <strong>“获取适用于 Windows 的 Docker 桌面（稳定）”</strong>。</p>
  </li>
  <li>
    <p>要开始安装，请单击 <strong>“运行”</strong>。</p>

    <p>可能需要一段时间才能显示 Docker Desktop 的安装对话框。</p>
  </li>
  <li>
    <p>出现“安装成功”消息时，单击 <strong>“关闭”</strong>。</p>

    <p>Docker Desktop 在安装后不会自动启动。要启动 Docker Desktop，请搜索 Docker，然后在搜索结果中选择 Docker Desktop。当状态栏中的鲸鱼图标保持稳定时，Docker Desktop 将启动并运行，并且可以从任何终端窗口访问。</p>
  </li>
</ol>

<h4 id="任务-6---安装-nodejs">任务 6 - 安装 node.js</h4>

<p>一些示例 Web 应用程序使用 node.js 在本地运行。以下步骤确保 node.js 已安装并运行最新版本：</p>

<ol>
  <li>
    <p>使用浏览器，打开 <a href="https://nodejs.org/en/#home-downloadhead">node.js 下载页面</a></p>
  </li>
  <li>
    <p>写入时下载最新的 LTS（长期支持）版本 - 14.16.0。</p>
  </li>
  <li>
    <p>出现提示时，选择该选项以运行安装程序。</p>
  </li>
  <li>
    <p>逐步执行安装程序：</p>

    <ul>
      <li><strong>最终用户许可协议</strong> - 接受条款，然后单击 <strong>“下一步”</strong>。</li>
      <li><strong>目标文件夹</strong> - 接受默认设置（或根据需要进行更改），然后单击 <strong>“下一步”</strong>。</li>
      <li><strong>自定义设置</strong> - 接受默认设置，然后单击 <strong>“下一步”</strong>。</li>
      <li><strong>本机模块的工具</strong> - 勾选 <strong>“自动安装”</strong>，然后单击 <strong>“下一步”</strong>。</li>
      <li><strong>准备安装 Node.js</strong> - 单击 <strong>“安装”</strong>
        <ul>
          <li>在 UAC 对话框中，单击 <strong>“是”</strong>。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>等待安装完成，然后单击 <strong>“完成”</strong>。</p>
  </li>
  <li>
    <p>在 <strong>“安装 Node.js 的其他工具”</strong> 命令窗口中，出现提示时按 <strong>Enter</strong> 继续。</p>
  </li>
  <li>
    <p>在 UAC 对话框中，单击 <strong>“是”</strong>。</p>

    <p>将下载并安装多个包。此操作需要一些时间。</p>
  </li>
  <li>
    <p>安装完成后，打开<strong>新的</strong>命令行界面并输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock0" class="mt-0"><code class="language-powershell"> node --version
</code></pre>

    <p>如果 Node 安装成功，则会显示安装的版本。</p>
  </li>
</ol>

<h3 id="练习-2安装开发工具扩展">练习 2：安装开发工具扩展</h3>

<p>Visual Studio Code 和 Azure CLI 工具均支持 Azure IoT 扩展，可帮助开发人员更有效地创建其解决方案。这些扩展利用 Azure IoT SDK，通常会在确保安全预配的同时减少开发时间。你还将添加适用于 Visual Studio Code 的 C# 扩展。</p>

<h4 id="任务-1安装-visual-studio-code-扩展">任务 1：安装 Visual Studio Code 扩展</h4>

<ol>
  <li>
    <p>打开 Visual Studio Code。</p>
  </li>
  <li>
    <p>在“Visual Studio Code”窗口的左侧，单击 <strong>“扩展”</strong>。</p>

    <p>你可以将鼠标指针悬停在按钮上以显示按钮名称。“扩展”按钮是从上往下数的第六个按钮。</p>
  </li>
  <li>
    <p>在 Visual Studio Code 扩展管理器中，搜索并安装以下扩展：</p>

    <ul>
      <li><a href="https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.azure-iot-tools">Azure IoT Tools</a> (<code>vsciot-vscode.azure-iot-tools</code>)（提供者：Microsoft）</li>
      <li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp">用于 Visual Studio Code 的 C#</a> (<code>ms-vscode.csharp</code>)（提供者：Microsoft）</li>
      <li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-node-azure-pack">用于 Visual Studio Code 的 Azure 工具</a> (ms-vscode.vscode-node-azure-pack)（提供者：Microsoft）</li>
      <li><a href="https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.vscode-dtdl">用于 Visual Studio Code 的 DTDL 编辑器</a> (vsciot-vscode.vscode-dtdl)（提供者：Microsoft）</li>
    </ul>
  </li>
  <li>
    <p>关闭 Visual Studio Code。</p>
  </li>
</ol>

<h4 id="任务-2安装-azure-cli-扩展---本地环境">任务 2：安装 Azure CLI 扩展 - 本地环境</h4>

<ol>
  <li>
    <p>打开一个新的命令行/终端窗口，在本地安装 Azure IoT CLI 扩展。</p>

    <p>例如，可以使用 Windows 命令提示符<strong>命令行应用程序</strong>。</p>
  </li>
  <li>
    <p>在命令提示符下，要安装用于 IoT 的 Azure CLI 扩展，请输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock1" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock1" class="mt-0"><code class="language-bash hljs"> az extension add --name azure-iot
</code></pre>
  </li>
  <li>
    <p>在命令提示符下，要安装用于时序见解的 Azure CLI 扩展，请输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock2" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock2" class="mt-0"><code class="language-bash hljs"> az extension add --name timeseriesinsights
</code></pre>
  </li>
</ol>

<h4 id="任务-3安装-azure-cli-扩展---云环境">任务 3：安装 Azure CLI 扩展 - 云环境</h4>

<p>许多实验室将需要通过 Azure Cloud Shell 使用 Azure CLI IoT 扩展。以下步骤确保安装扩展并运行最新版本。</p>

<ol>
  <li>
    <p>使用浏览器，打开 <a href="https://shell.azure.com/">Azure Cloud Shell</a>，并使用本课程使用的 Azure 订阅登录。</p>
  </li>
  <li>
    <p>如果系统提示设置 Cloud Shell 的存储，请接受默认设置。</p>
  </li>
  <li>
    <p>验证 Cloud Shell 是否在使用 <strong>Bash</strong>。</p>

    <p>Azure Cloud Shell 页面左上角的下拉菜单用于选择环境。验证所选的下拉值是否为 <strong>Bash</strong>。</p>
  </li>
  <li>
    <p>在命令提示符下，要安装用于 IoT 的 Azure CLI 扩展，请输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock3" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock3" class="mt-0"><code class="language-bash hljs"> az extension add --name azure-iot
</code></pre>

    <p><strong>备注</strong>： 如果已安装扩展，则可以通过输入以下命令来确保运行的是最新版本：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock4" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock4" class="mt-0"><code class="language-bash hljs"> az extension update --name azure-iot
</code></pre>
  </li>
  <li>
    <p>在命令提示符下，要安装用于时序见解的 Azure CLI 扩展，请输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock5" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock5" class="mt-0"><code class="language-bash hljs"> az extension add --name timeseriesinsights
</code></pre>
  </li>
</ol>

<h4 id="任务-4验证开发环境设置">任务 4：验证开发环境设置</h4>

<p>你应该验证开发环境是否已设置成功。完成后，你便可开始构建 IoT 解决方案。</p>

<ol>
  <li>
    <p>打开一个新的命令行/终端窗口。</p>
  </li>
  <li>
    <p>通过运行以下命令验证 <strong>Azure CLI</strong> 安装，该命令将输出当前安装的 Azure CLI 版本的版本信息。</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock6" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock6" class="mt-0"><code class="language-cmd/sh"> az --version
</code></pre>

    <p><code>az --version</code> 命令将输出已安装的 Azure CLI 的版本信息（<code>azure-cli</code>版本号）。此命令还会输出所有已安装的 Azure CLI 模块的版本号，包括 IoT 扩展。应会看到如下所示的输出：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock7" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock7" class="mt-0"><code class="language-cmd/sh"> azure-cli                           2.20.0

 core                                2.20.0
 telemetry                           1.0.6

 Extensions:
 azure-iot                           0.10.9
</code></pre>
  </li>
  <li>
    <p>通过运行以下命令验证 <strong>.NET Core 3.x SDK</strong> 安装，该命令将输出当前安装的 .NET Core SDK 版本的版本号。</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock8" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock8" class="mt-0"><code class="language-cmd/sh"> dotnet --version
</code></pre>

    <p><code>dotnet --version</code> 命令将输出当前安装的 .NET Core SDK 的版本。</p>
  </li>
  <li>
    <p>验证是否已安装 .NET Core 3.1 或更高版本。</p>
  </li>
</ol>

<p>现在该设置你的开发环境了！</p>

<h3 id="练习-3设置课程实验室文件和替代工具">练习 3：设置课程实验室文件和替代工具</h3>

<p>本课程中的许多实验室都依赖于预先构建的资源，例如可以用作实验室活动起点的代码项目。这些实验室资源在 GitHub 项目中提供，你应将其下载到开发环境中。</p>

<p>除了直接支持课程实验室的资源（GitHub 项目中包含的资源），还可以选择安装一些可选工具，因为它们支持本课程之外的学习机会。一个示例是 PowerShell，你可能会在 Microsoft 教程和其他资源中看到对它的引用。</p>

<p>下面的说明将引导你完成这两种资源类型的配置。</p>

<h4 id="任务-1下载课程实验室文件">任务 1：下载课程实验室文件</h4>

<p>Microsoft 已经创建了一个 GitHub 存储库来提供对实验室资源文件的访问权限。在某些情况下，需要将这些文件放在本地开发环境，而在许多其他情况下，这样很方便。在此任务中，你将在开发环境中下载并提取存储库的内容。</p>

<ol>
  <li>
    <p>在你的 Web 浏览器中，导航到以下位置：<a href="https://github.com/MicrosoftLearning/AZ-220ZH-Microsoft-Azure-IoT-Developer">https://github.com/MicrosoftLearning/AZ-220ZH-Microsoft-Azure-IoT-Developer</a></p>
  </li>
  <li>
    <p>在页面右侧，单击 <strong>“克隆或下载”</strong>，然后单击 <strong>“下载 ZIP”</strong>。</p>
  </li>
  <li>
    <p>要将 ZIP 文件保存到你的开发环境中，请单击 <strong>“保存”</strong>。</p>
  </li>
  <li>
    <p>保存文件后，单击 <strong>“打开文件夹”</strong>。</p>
  </li>
  <li>
    <p>右键单击保存的 ZIP 文件，然后单击 <strong>“提取所有”</strong></p>
  </li>
  <li>
    <p>请单击 <strong>“浏览”</strong>，然后导航到方便访问的文件夹位置。</p>

    <blockquote>
      <p><strong>重要说明</strong>： 默认情况下，Windows 的<a href="https://docs.microsoft.com/zh-cn/windows/win32/fileio/naming-a-file#maximum-path-length-limitation">最大文件路径长度为 260</a>。由于 ZIP 中的文件路径已经很长，请避免在具有大文件路径的嵌套文件夹中提取存档。例如，提示提取 zip 的默认路径可能类似于 <strong>c:\users\[username]\downloads\AZ-220-Microsoft-Azure-IoT-Developer-master</strong> - 建议尽量缩短此路径，例如 <strong>c:\az220</strong></p>
    </blockquote>
  </li>
  <li>
    <p>要提取文件，请单击 <strong>“提取”</strong>。</p>

    <p>确保记下文件的位置。</p>
  </li>
</ol>

<h4 id="任务-2安装-azure-powershell-模块">任务 2：安装 Azure PowerShell 模块</h4>

<blockquote>
  <p><strong>备注</strong>： 本课程中的实验活动不包括使用 PowerShell，但可在使用 PowerShell 的参考文档中看到示例代码。如果要运行 PowerShell 代码，可以按照以下说明完成安装步骤。</p>
</blockquote>

<p>Azure PowerShell 是一组 cmdlet，用于直接从 PowerShell 命令行管理 Azure 资源。Azure PowerShell 旨在使学习和入门变得轻松，但提供了强大的功能以实现自动化。以 .NET Standard 编写，Azure PowerShell 在 Windows 上可与 PowerShell 5.1 配合使用，在所有平台上可与 PowerShell 6.x 和更高版本配合使用。</p>

<blockquote>
  <p><strong>警告</strong>：  不能同时为 PowerShell 5.1 for Windows 安装 AzureRM 和 Az 模块。如果需要确保 AzureRM 在系统上可用，请为 PowerShell Core 6.x 或更高版本安装 Az 模块。为此，请安装 PowerShell Core 6.x 或更高版本，然后在 PowerShell Core 终端中按照以下说明进行操作。</p>
</blockquote>

<ol>
  <li>
    <p>确定是只为当前用户（建议的方法）还是为所有用户安装 Azure PowerShell 模块。</p>
  </li>
  <li>
    <p>启动你选择的 PowerShell 终端 - 如果要为所有用户安装，则必须通过以下任一方式启动提升的 PowerShell 会话：在 macOS 或 Linux 上选择 <strong>“以管理员身份运行”</strong> 或者运行 <strong>sudo</strong> 命令。</p>
  </li>
  <li>
    <p>若要仅为当前用户安装，请输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock9" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock9" class="mt-0"><code class="language-powershell"> Install-Module -Name Az -AllowClobber -Scope CurrentUser
</code></pre>

    <p>或者，若要为系统上的所有用户安装，请输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock10" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock10" class="mt-0"><code class="language-powershell"> Install-Module -Name Az -AllowClobber -Scope AllUsers
</code></pre>
  </li>
  <li>
    <p>默认情况下，PowerShell 库未配置为 PowerShellGet 的受信任存储库。首次使用 PSGallery 时会看到以下提示：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock11" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock11" class="mt-0"><code class="language-output"> Untrusted repository

 You are installing the modules from an untrusted repository. If you trust this repository, change
 its InstallationPolicy value by running the Set-PSRepository cmdlet.

 Are you sure you want to install the modules from 'PSGallery'?
 [Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is "N"):
</code></pre>
  </li>
  <li>
    <p>回答 <strong>“是”</strong> 或 <strong>“全部是”</strong> 继续安装。</p>

    <p>Az 模块是 Azure PowerShell cmdlet 的汇总模块。安装它时，系统会下载所有可用的 Azure 资源管理器模块并使其 cmdlet 可供使用。</p>
  </li>
</ol>

<blockquote>
  <p><strong>备注</strong>： 如果已安装 <strong>Az</strong> 模块，则可运行以下命令将其更新到最新版本：</p>

  <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock12" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock12" class="mt-0"><code class="language-powershell">Update-Module -Name Az
</code></pre>
</blockquote>

<h3 id="练习-3---注册资源提供程序">练习 3 - 注册资源提供程序</h3>

<p>在此课程中，将创建许多不同类型的资源，其中一些资源可能尚未注册，无法在当前订阅中使用。有些资源在首次使用时会自动注册，有些资源必须先注册才能使用，否则会报错。</p>

<h4 id="任务-1---使用-azure-cli-注册资源提供程序">任务 1 - 使用 Azure CLI 注册资源提供程序</h4>

<p>Azure CLI 提供了许多命令来帮助管理资源提供程序。在此任务中，你将确保已注册本课程所需的资源提供程序。</p>

<ol>
  <li>
    <p>使用浏览器，打开 <a href="https://shell.azure.com/">Azure Cloud Shell</a>，并使用本课程使用的 Azure 订阅登录。</p>
  </li>
  <li>
    <p>若要查看资源提供程序的当前状态列表，请输入以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock13" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock13" class="mt-0"><code class="language-powershell"> az provider list -o table
</code></pre>

    <p>这将显示一个很<em>长</em>的资源列表，类似于：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock14" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock14" class="mt-0"><code class="language-powershell"> Namespace                                RegistrationPolicy    RegistrationState
 ---------------------------------------  --------------------  -------------------
 Microsoft.OperationalInsights            RegistrationRequired  Registered
 microsoft.insights                       RegistrationRequired  NotRegistered
 Microsoft.DataLakeStore                  RegistrationRequired  Registered
 Microsoft.DataLakeAnalytics              RegistrationRequired  Registered
 Microsoft.Web                            RegistrationRequired  Registered
 Microsoft.ContainerRegistry              RegistrationRequired  Registered
 Microsoft.ResourceHealth                 RegistrationRequired  Registered
 Microsoft.BotService                     RegistrationRequired  Registered
 Microsoft.Search                         RegistrationRequired  Registered
 Microsoft.EventGrid                      RegistrationRequired  Registered
 Microsoft.SignalRService                 RegistrationRequired  Registered
 Microsoft.VSOnline                       RegistrationRequired  Registered
 Microsoft.Sql                            RegistrationRequired  Registered
 Microsoft.ContainerService               RegistrationRequired  Registered
 Microsoft.ManagedIdentity                RegistrationRequired  Registered
 ...
</code></pre>
  </li>
  <li>
    <p>若要查看返回包含字符串 <strong>Event</strong> 的命名空间列表，请运行以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock15" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock15" class="mt-0"><code class="language-powershell"> az provider list -o table --query "[?contains(namespace, 'Event')]"
</code></pre>

    <p>结果会类似于：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock16" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock16" class="mt-0"><code class="language-powershell"> Namespace            RegistrationState    RegistrationPolicy
 -------------------  -------------------  --------------------
 Microsoft.EventGrid  NotRegistered        RegistrationRequired
 Microsoft.EventHub   Registered           RegistrationRequired
</code></pre>
  </li>
  <li>
    <p>若要注册本课程所需的资源，请执行以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock17" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock17" class="mt-0"><code class="language-powershell"> az provider register --namespace "Microsoft.EventGrid" --accept-terms
 az provider register --namespace "Microsoft.EventHub" --accept-terms
 az provider register --namespace "Microsoft.Insights" --accept-terms
 az provider register --namespace "Microsoft.TimeSeriesInsights" --accept-terms
</code></pre>

    <blockquote>
      <p><strong>备注</strong>： 你可能会看到 <strong>-accept-terms</strong> 处于预览状态的警告 - 可以忽略它。</p>
    </blockquote>

    <blockquote>
      <p><strong>备注</strong>： <strong>microsoft.insights</strong> 以小写形式列出 - 但是注册/取消注册命令不区分大小写。</p>
    </blockquote>
  </li>
  <li>
    <p>若要查看资源的更新状态，请执行以下命令：</p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light">code</span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock18" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i>Copy</button></div><pre id="codeBlock18" class="mt-0"><code class="language-powershell"> az provider list -o table --query "[?(contains(namespace, 'insight') || contains(namespace, 'Event') || contains(namespace, 'TimeSeriesInsights'))]"
</code></pre>

    <blockquote>
      <p><strong>备注</strong>： 尽管注册/取消注册命令不区分大小写，但查询语言需要区分，所以 <strong>insight</strong> 必须小写。</p>
    </blockquote>

    <p>现应注册资源。</p>
  </li>
</ol>

<h4 id="任务-2---使用-azure-门户注册资源提供程序">任务 2 - 使用 Azure 门户注册资源提供程序</h4>

<p>可以通过门户查看注册状态，并注册资源提供程序命名空间。在此任务中，你将熟悉 UI。</p>

<ol>
  <li>
    <p>如有必要，使用 Azure 帐户凭据登录到 <a href="https://portal.azure.com">portal.azure.com</a>。</p>
  </li>
  <li>
    <p>在门户中，选择 <strong>“所有服务”</strong>。</p>

    <p><a href="media/LAB_AK_03-select-all-services.png" target="_blank"><img src="media/LAB_AK_03-select-all-services.png" alt="选择所有服务"></a></p>
  </li>
  <li>
    <p>选择“订阅”。</p>

    <p><a href="media/LAB_AK_03-select-subscriptions.png" target="_blank"><img src="media/LAB_AK_03-select-subscriptions.png" alt="选择订阅"></a></p>
  </li>
  <li>
    <p>从订阅列表中，选择要用于注册资源提供程序的订阅。</p>

    <p><a href="media/LAB_AK_03-select-subscription-to-register.png" target="_blank"><img src="media/LAB_AK_03-select-subscription-to-register.png" alt="选择订阅以注册资源提供程序"></a></p>
  </li>
  <li>
    <p>对于订阅，选择 <strong>“资源提供程序”</strong>。</p>

    <p><a href="media/LAB_AK_03-select-resource-provider.png" target="_blank"><img src="media/LAB_AK_03-select-resource-provider.png" alt="选择资源提供程序"></a></p>
  </li>
  <li>
    <p>查看资源提供程序列表，可以单击相应的操作来注册或取消注册资源。</p>

    <p><a href="media/LAB_AK_03-list-resource-providers.png" target="_blank"><img src="media/LAB_AK_03-list-resource-providers.png" alt="列出资源提供程序"></a></p>
  </li>
  <li>
    <p>若要筛选列出的资源，请在搜索文本框中输入 <strong>“insights”</strong>。</p>

    <p>请注意，在输入搜索条件时，会对列表进行筛选。搜索也不区分大小写。</p>
  </li>
</ol>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/AZ-220ZH-Microsoft-Azure-IoT-Developer" target="_blank" class="ml-2">
                    MicrosoftLearning/AZ-220ZH-Microsoft-Azure-IoT-Developer
                </a>
            </span>
        </nav>
    </footer>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="../../assets/js/script_v%3D653337691cd169b6aa5719d4ea66f4e6a878a19c.js"></script>



</body></html>